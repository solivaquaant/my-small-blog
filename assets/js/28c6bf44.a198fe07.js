"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[3634],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>a});var r=s(96540);const t={},i=r.createContext(t);function o(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:n},e.children)}},51087:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"hack-the-box/starting-point/tier-0/dancing","title":"Dancing","description":"- Difficulty: Very easy","source":"@site/docs/hack-the-box/starting-point/tier-0/3-dancing.mdx","sourceDirName":"hack-the-box/starting-point/tier-0","slug":"/hack-the-box/starting-point/tier-0/dancing","permalink":"/my-small-blog/docs/hack-the-box/starting-point/tier-0/dancing","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Windows","permalink":"/my-small-blog/docs/tags/windows","description":"Includes write-ups on the topic of Windows"},{"inline":false,"label":"Network","permalink":"/my-small-blog/docs/tags/network","description":"Includes write-ups on the topic of Network"}],"version":"current","sidebarPosition":3,"frontMatter":{"tags":["windows","network"],"sidebar_position":3},"sidebar":"writeupsSidebar","previous":{"title":"Fawn","permalink":"/my-small-blog/docs/hack-the-box/starting-point/tier-0/fawn"},"next":{"title":"Redeemer","permalink":"/my-small-blog/docs/hack-the-box/starting-point/tier-0/redeemer"}}');var t=s(74848),i=s(28453);const o={tags:["windows","network"],sidebar_position:3},a="Dancing",c={},l=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\u270f\ufe0f Task answers",id:"\ufe0f-task-answers",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"dancing",children:"Dancing"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Difficulty:"})," Very easy"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,t.jsx)(n.p,{children:"With the target IP in hand I ran an Nmap service/version scan to enumerate running services and their versions:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"> nmap -sV 10.129.202.193\r\n\r\nPORT    STATE SERVICE       VERSION\r\n135/tcp open  msrpc         Microsoft Windows RPC\r\n139/tcp open  netbios-ssn   Microsoft Windows netbios-ssn\r\n445/tcp open  microsoft-ds?\r\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n"})}),"\n",(0,t.jsx)(n.p,{children:"The scan returned 3 open ports and their associated services:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"135/tcp - Microsoft Windows RPC"}),"\n",(0,t.jsx)(n.li,{children:"139/tcp - Microsoft Windows netbios-ssn"}),"\n",(0,t.jsx)(n.li,{children:"445/tcp - microsoft-ds? (this is the canonical service name for SMB over TCP)"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["For this lab I focused on port 445 (SMB).\r\n",(0,t.jsx)(n.strong,{children:"SMB (Server Message Block)"})," is the protocol used for Windows file and printer sharing; historically it has been the vector for large ransomware outbreaks such as WannaCry, which propagated via an SMB vulnerability - a reminder that exposed SMB services on the internet are high-risk and worth auditing in CTF/lab scenarios."]}),"\n",(0,t.jsxs)(n.p,{children:["On Linux, ",(0,t.jsx)(n.code,{children:"smbclient"})," is a handy tool for interacting with SMB shares.\r\nFirst I listed the shares on the host:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"> smbclient -L //10.129.202.193\r\nPassword for [WORKGROUP\\kali]:\r\n\r\n        Sharename       Type      Comment\r\n        ---------       ----      -------\r\n        ADMIN$          Disk      Remote Admin\r\n        C$              Disk      Default share\r\n        IPC$            IPC       Remote IPC\r\n        WorkShares      Disk      \r\nReconnecting with SMB1 for workgroup listing.\n"})}),"\n",(0,t.jsxs)(n.p,{children:["At the ",(0,t.jsx)(n.code,{children:"WORKGROUP\\kali"})," prompt I tried a common password (",(0,t.jsx)(n.code,{children:"kali"}),") and was able to authenticate.\r\nThe shares returned can be interpreted as follows:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ADMIN$"}),", ",(0,t.jsx)(n.code,{children:"C$"})," - administrative shares (typically only accessible to administrators)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"IPC$"})," - used for inter-process communication / named pipes (remote administration)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"WorkShares"})," - a user-created disk share likely containing user data."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["I connected to the ",(0,t.jsx)(n.code,{children:"WorkShares"})," share using ",(0,t.jsx)(n.code,{children:"smbclient \\\\<IP>\\<sharename>"})," and browsed its contents.\r\nListing the top-level directory showed 2 user folders:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"smb: \\> ls\r\n  .                                   D        0  Mon Mar 29 04:22:01 2021\r\n  ..                                  D        0  Mon Mar 29 04:22:01 2021\r\n  Amy.J                               D        0  Mon Mar 29 05:08:24 2021\r\n  James.P                             D        0  Thu Jun  3 04:38:03 2021\r\n\r\n                5114111 blocks of size 4096. 1754177 blocks available\n"})}),"\n",(0,t.jsxs)(n.p,{children:["I changed into ",(0,t.jsx)(n.code,{children:"Amy.J"})," and found a small note file, which I downloaded with ",(0,t.jsx)(n.code,{children:"get"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"smb: \\> cd Amy.J\r\nsmb: \\Amy.J\\> ls\r\n  .                                   D        0  Mon Mar 29 05:08:24 2021\r\n  ..                                  D        0  Mon Mar 29 05:08:24 2021\r\n  worknotes.txt                       A       94  Fri Mar 26 07:00:37 2021\r\n\r\n                5114111 blocks of size 4096. 1754174 blocks available\r\nsmb: \\Amy.J\\> get worknotes.txt\r\ngetting file \\Amy.J\\worknotes.txt of size 94 as worknotes.txt (0.1 KiloBytes/sec) (average 0.1 KiloBytes/sec)\n"})}),"\n",(0,t.jsx)(n.p,{children:"The file contents were just operational notes (no flag):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"> cat worknotes.txt \r\n- start apache server on the linux machine\r\n- secure the ftp server\r\n- setup winrm on dancing \n"})}),"\n",(0,t.jsxs)(n.p,{children:["I repeated the process for the ",(0,t.jsx)(n.code,{children:"James.P"})," folder and found ",(0,t.jsx)(n.code,{children:"flag.txt"}),", which I downloaded:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"smb: \\> cd James.P\r\nsmb: \\James.P\\> ls\r\n  .                                   D        0  Thu Jun  3 04:38:03 2021\r\n  ..                                  D        0  Thu Jun  3 04:38:03 2021\r\n  flag.txt                            A       32  Mon Mar 29 05:26:57 2021\r\n\r\n                5114111 blocks of size 4096. 1754174 blocks available\r\nsmb: \\James.P\\> get flag.txt \r\ngetting file \\James.P\\flag.txt of size 32 as flag.txt (0.0 KiloBytes/sec) (average 0.0 KiloBytes/sec)\n"})}),"\n",(0,t.jsx)(n.p,{children:"Reading the file revealed the flag:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"> cat flag.txt     \r\n5f61c10dffbc77a704d76016a22f1664 \n"})}),"\n",(0,t.jsxs)(n.p,{children:["That completed the SMB-based retrieval flow: service enumeration with ",(0,t.jsx)(n.code,{children:"nmap -sV"}),", discover SMB on port 445, list shares with ",(0,t.jsx)(n.code,{children:"smbclient -L"}),", authenticate, browse shares, and download the target file containing the flag."]}),"\n",(0,t.jsx)(n.h2,{id:"\ufe0f-task-answers",children:"\u270f\ufe0f Task answers"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Task 1: What does the 3-letter acronym SMB stand for?"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Server Message Block"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Task 2: What port does SMB use to operate at?"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"445"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Task 3: What is the service name for port 445 that came up in our Nmap scan?"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"microsoft-ds"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Task 4: What is the 'flag' or 'switch' that we can use with the smbclient utility to 'list' the available shares on Dancing?"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"-L"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Task 5: How many shares are there on Dancing?"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"4"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Task 6: What is the name of the share we are able to access in the end with a blank password?"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"WorkShares"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Task 7: What is the command we can use within the SMB shell to download the files we find?"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"get"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"5f61c10dffbc77a704d76016a22f1664"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);