"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[2518],{38071(e,i,n){n.r(i),n.d(i,{assets:()=>o,contentTitle:()=>d,default:()=>a,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"pico-ctf/web-exploitation/client-side-again","title":"Client-side-again","description":"- Description: Can you break into this super secure portal?","source":"@site/docs/pico-ctf/web-exploitation/client-side-again.mdx","sourceDirName":"pico-ctf/web-exploitation","slug":"/pico-ctf/web-exploitation/client-side-again","permalink":"/docs/pico-ctf/web-exploitation/client-side-again","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Web","permalink":"/docs/tags/web","description":"Includes write-ups on the topic of Web"}],"version":"current","frontMatter":{"tags":["web"]},"sidebar":"writeupsSidebar","previous":{"title":"Bookmarklet","permalink":"/docs/pico-ctf/web-exploitation/bookmarklet"},"next":{"title":"Cookie Monster Secret Recipe","permalink":"/docs/pico-ctf/web-exploitation/cookie-monster-secret-recipe/"}}');var c=n(74848),t=n(28453);const r={tags:["web"]},d="Client-side-again",o={},l=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function x(e){const i={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(i.header,{children:(0,c.jsx)(i.h1,{id:"client-side-again",children:"Client-side-again"})}),"\n",(0,c.jsxs)(i.ul,{children:["\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.strong,{children:"Description:"})," Can you break into this super secure portal?"]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,c.jsx)(i.hr,{}),"\n",(0,c.jsx)(i.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,c.jsx)(i.p,{children:"By viewing the page source, we can identify the following embedded script:"}),"\n",(0,c.jsx)(i.pre,{children:(0,c.jsx)(i.code,{children:"<script type=\"text/javascript\">\r\n  var _0x5a46=['daf93}','_again_4','this','Password\\x20Verified','Incorrect\\x20password','getElementById','value','substring','picoCTF{','not_this'];(function(_0x4bd822,_0x2bd6f7){var _0xb4bdb3=function(_0x1d68f6){while(--_0x1d68f6){_0x4bd822['push'](_0x4bd822['shift']());}};_0xb4bdb3(++_0x2bd6f7);}(_0x5a46,0x1b3));var _0x4b5b=function(_0x2d8f05,_0x4b81bb){_0x2d8f05=_0x2d8f05-0x0;var _0x4d74cb=_0x5a46[_0x2d8f05];return _0x4d74cb;};function verify(){checkpass=document[_0x4b5b('0x0')]('pass')[_0x4b5b('0x1')];split=0x4;if(checkpass[_0x4b5b('0x2')](0x0,split*0x2)==_0x4b5b('0x3')){if(checkpass[_0x4b5b('0x2')](0x7,0x9)=='{n'){if(checkpass[_0x4b5b('0x2')](split*0x2,split*0x2*0x2)==_0x4b5b('0x4')){if(checkpass[_0x4b5b('0x2')](0x3,0x6)=='oCT'){if(checkpass[_0x4b5b('0x2')](split*0x3*0x2,split*0x4*0x2)==_0x4b5b('0x5')){if(checkpass['substring'](0x6,0xb)=='F{not'){if(checkpass[_0x4b5b('0x2')](split*0x2*0x2,split*0x3*0x2)==_0x4b5b('0x6')){if(checkpass[_0x4b5b('0x2')](0xc,0x10)==_0x4b5b('0x7')){alert(_0x4b5b('0x8'));}}}}}}}}else{alert(_0x4b5b('0x9'));}}\r\n<\/script>\n"})}),"\n",(0,c.jsxs)(i.p,{children:["The script starts with an array ",(0,c.jsx)(i.code,{children:"_0x5a46"})," and an immediately invoked function expression (IIFE) that rotates/shuffles this array. After this transformation, the decoder function ",(0,c.jsx)(i.code,{children:"_0x4b5b"})," maps hexadecimal indices to meaningful string values:"]}),"\n",(0,c.jsxs)(i.ul,{children:["\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"_0x4b5b('0x0')"})," \u2192 ",(0,c.jsx)(i.code,{children:"getElementById"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"_0x4b5b('0x1')"})," \u2192 ",(0,c.jsx)(i.code,{children:"value"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"_0x4b5b('0x2')"})," \u2192 ",(0,c.jsx)(i.code,{children:"substring"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"_0x4b5b('0x3')"})," \u2192 ",(0,c.jsx)(i.code,{children:"picoCTF{"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"_0x4b5b('0x4')"})," \u2192 ",(0,c.jsx)(i.code,{children:"not_this"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"_0x4b5b('0x5')"})," \u2192 ",(0,c.jsx)(i.code,{children:"daf93}"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"_0x4b5b('0x6')"})," \u2192 ",(0,c.jsx)(i.code,{children:"_again_4"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"_0x4b5b('0x7')"})," \u2192 ",(0,c.jsx)(i.code,{children:"this"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"_0x4b5b('0x8')"})," \u2192 ",(0,c.jsx)(i.code,{children:"Password Verified"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"_0x4b5b('0x9')"})," \u2192 ",(0,c.jsx)(i.code,{children:"Incorrect password"})]}),"\n"]}),"\n",(0,c.jsxs)(i.p,{children:["The ",(0,c.jsx)(i.code,{children:"verify()"})," function retrieves the value from the input field (",(0,c.jsx)(i.code,{children:"pass"}),") and validates different portions of the string using ",(0,c.jsx)(i.code,{children:"split = 4"})," as the base unit.\r\nWe can reconstruct the password by analyzing each substring check in logical order:"]}),"\n",(0,c.jsxs)(i.ul,{children:["\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"checkpass.substring(0, 8)"})," == ",(0,c.jsx)(i.code,{children:"'picoCTF{'"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"checkpass.substring(7, 9)"})," == ",(0,c.jsx)(i.code,{children:"'{n'"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"checkpass.substring(8, 16)"})," == ",(0,c.jsx)(i.code,{children:"'not_this'"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"checkpass.substring(3, 6)"})," == ",(0,c.jsx)(i.code,{children:"'oCT'"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"checkpass.substring(24, 32)"})," == ",(0,c.jsx)(i.code,{children:"'daf93}'"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"checkpass.substring(6, 11)"})," == ",(0,c.jsx)(i.code,{children:"'F{not'"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"checkpass.substring(16, 24)"})," == ",(0,c.jsx)(i.code,{children:"'again_4'"})]}),"\n",(0,c.jsxs)(i.li,{children:[(0,c.jsx)(i.code,{children:"checkpass.substring(12, 16)"})," == ",(0,c.jsx)(i.code,{children:"'this'"})]}),"\n"]}),"\n",(0,c.jsx)(i.p,{children:"From the index ranges, the string can be divided into the following segments:"}),"\n",(0,c.jsxs)(i.ul,{children:["\n",(0,c.jsxs)(i.li,{children:["Position 0  - 8  : ",(0,c.jsx)(i.code,{children:"picoCTF{"})]}),"\n",(0,c.jsxs)(i.li,{children:["Position 8  - 16 : ",(0,c.jsx)(i.code,{children:"not_this"})]}),"\n",(0,c.jsxs)(i.li,{children:["Position 16 - 24 : ",(0,c.jsx)(i.code,{children:"_again_4"})]}),"\n",(0,c.jsxs)(i.li,{children:["Position 24 - 32 : ",(0,c.jsx)(i.code,{children:"daf93}"})]}),"\n"]}),"\n",(0,c.jsx)(i.p,{children:"By concatenating these segments according to their correct positions in the string, we obtain the complete flag."}),"\n",(0,c.jsx)(i.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,c.jsxs)(i.blockquote,{children:["\n",(0,c.jsx)(i.p,{children:(0,c.jsx)(i.code,{children:"picoCTF{not_this_again_4daf93}"})}),"\n"]})]})}function a(e={}){const{wrapper:i}={...(0,t.R)(),...e.components};return i?(0,c.jsx)(i,{...e,children:(0,c.jsx)(x,{...e})}):x(e)}},28453(e,i,n){n.d(i,{R:()=>r,x:()=>d});var s=n(96540);const c={},t=s.createContext(c);function r(e){const i=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function d(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:r(e.components),s.createElement(t.Provider,{value:i},e.children)}}}]);