"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[4218],{1363:(e,t,r)=>{r.d(t,{A:()=>n});const n=r.p+"assets/images/flag-26d83f404b6fafde57b8198f4d14f9e4.png"},6447:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"root-me/web-server/http-open-redirect/http-open-redirect","title":"HTTP - Open redirect","description":"- Description: Find a way to make a redirection to a domain other than those showed on the web page.","source":"@site/docs/root-me/web-server/http-open-redirect/http-open-redirect.mdx","sourceDirName":"root-me/web-server/http-open-redirect","slug":"/root-me/web-server/http-open-redirect/","permalink":"/my-small-blog/docs/root-me/web-server/http-open-redirect/","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Web","permalink":"/my-small-blog/docs/tags/web","description":"Web tag description"}],"version":"current","frontMatter":{"tags":["web"]},"sidebar":"tutorialSidebar","previous":{"title":"HTTP - IP restriction bypass","permalink":"/my-small-blog/docs/root-me/web-server/http-ip-restriction-bypass/"},"next":{"title":"HTTP - User-agent","permalink":"/my-small-blog/docs/root-me/web-server/http-user-agent/"}}');var s=r(4848),o=r(8453);const i={tags:["web"]},a="HTTP - Open redirect",c={},d=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function l(e){const t={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"http---open-redirect",children:"HTTP - Open redirect"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Description:"})," Find a way to make a redirection to a domain other than those showed on the web page."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Difficulty:"})," Very easy"]}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,s.jsxs)(t.p,{children:["The challenge website provides 3 buttons that redirect users to different external websites. ",(0,s.jsx)(t.br,{}),"\n","Upon inspecting the source code, the following snippet is revealed:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-html",children:"<a href='?url=https://facebook.com&h=a023cfbf5f1c39bdf8407f28b60cd134'>facebook</a>\r\n<a href='?url=https://twitter.com&h=be8b09f7f1f66235a9c91986952483f0'>twitter</a>\r\n<a href='?url=https://slack.com&h=e52dc719664ead63be3d5066c135b6da'>slack</a>\n"})}),"\n",(0,s.jsx)(t.p,{children:"Each link consists of 2 query parameters:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"url"})," - the destination to redirect to"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"h"})," - a hash value used for verification"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["By analyzing the pattern, it becomes clear that the value of ",(0,s.jsx)(t.code,{children:"h"})," is simply the ",(0,s.jsx)(t.strong,{children:"MD5 hash"})," of the URL.\r\nThis can be easily verified using an online tool such as ",(0,s.jsx)(t.a,{href:"https://md5.gromweb.com/",children:"this"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"We can reasonably assume that on the server side, the redirection logic works something like this:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"expected_hash = md5(url).hexdigest()\r\nif h == expected_hash:\r\n    redirect(url)\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Based on this behavior, we can attempt to redirect to an arbitrary domain by generating a valid MD5 hash for our custom URL.\r\nIn this case, I chose ",(0,s.jsx)(t.a,{href:"https://www.google.com/",children:"https://www.google.com/"}),".\r\nThe MD5 hash of this URL is ",(0,s.jsx)(t.code,{children:"d75277cdffef995a46ae59bdaef1db86"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Using ",(0,s.jsx)(t.strong,{children:"Burp Suite"}),", I intercepted the request and modified the URL as"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"?url=https://www.google.com/&h=d75277cdffef995a46ae59bdaef1db86\n"})}),"\n",(0,s.jsx)(t.p,{children:"As expected, the server accepted the hash and successfully redirected to Google.\r\nThis confirmed the vulnerability, and I was able to obtain the flag."}),"\n",(0,s.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,s.jsx)("img",{src:r(1363).A,style:{width:"100%",height:"auto"}})}),"\n",(0,s.jsx)(t.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"e6f8a530811d5a479812d7b82fc1a5c5"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,t,r)=>{r.d(t,{R:()=>i,x:()=>a});var n=r(6540);const s={},o=n.createContext(s);function i(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);