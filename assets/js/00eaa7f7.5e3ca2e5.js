"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[4336],{56498(e,n,l){l.r(n),l.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>f,frontMatter:()=>c,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"pico-ctf/forensics/file-types","title":"File types","description":"- Description: This file was found among some files marked confidential but my pdf reader cannot read it, maybe yours can.","source":"@site/docs/pico-ctf/forensics/file-types.mdx","sourceDirName":"pico-ctf/forensics","slug":"/pico-ctf/forensics/file-types","permalink":"/docs/pico-ctf/forensics/file-types","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Forensics","permalink":"/docs/tags/forensics","description":"Includes write-ups on the topic of Forensics"},{"inline":false,"label":"Linux","permalink":"/docs/tags/linux","description":"Includes write-ups on the topic of Linux"}],"version":"current","frontMatter":{"tags":["forensics","linux"]},"sidebar":"writeupsSidebar","previous":{"title":"extensions","permalink":"/docs/pico-ctf/forensics/extensions/"},"next":{"title":"FindAndOpen","permalink":"/docs/pico-ctf/forensics/findandopen/"}}');var r=l(74848),s=l(28453);const c={tags:["forensics","linux"]},a="File types",o={},t=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"file-types",children:"File types"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description:"})," This file was found among some files marked confidential but my pdf reader cannot read it, maybe yours can."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,r.jsxs)(n.p,{children:["The challenge provides a seemingly broken PDF file that can't be opened normally.\r\nSuspecting something unusual, I ran the ",(0,r.jsx)(n.code,{children:"file"})," command, which revealed that it was actually a ",(0,r.jsx)(n.strong,{children:"shell archive text"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"> file Flag.pdf  \r\nFlag.pdf: shell archive text\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Renaming the file with a ",(0,r.jsx)(n.code,{children:".shar"})," extension and executing it extracted its contents."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"> mv Flag.pdf Flag.shar\r\n\r\n> sh Flag.shar         \r\nx - created lock directory _sh00046.\r\nx - extracting flag (text)\r\nx - removed lock directory _sh00046.\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The extracted output was an ",(0,r.jsx)(n.strong,{children:"ar archive"})," - a classic Unix archive format that also underpins ",(0,r.jsx)(n.code,{children:".deb"})," packages."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"> file flag\r\nflag: current ar archive\r\n                                                                                                              \r\n> ar x flag  \n"})}),"\n",(0,r.jsxs)(n.p,{children:["I extracted it, which revealed a ",(0,r.jsx)(n.strong,{children:"cpio archive"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'> file flag\r\nflag: cpio archive; device 234, inode 37426, mode 100644, uid 0, gid 0, modified Thu Mar 16 01:40:17 2023, 510 bytes "flag"\r\n                                                                                                              \r\n> mv flag Flag         \r\n                                                                                                              \r\n> cpio -i < Flag\r\n2 blocks\n'})}),"\n",(0,r.jsx)(n.p,{children:"Following the trail, I continued unpacking each successive format:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["From ",(0,r.jsx)(n.strong,{children:"cpio"}),", I got a ",(0,r.jsx)(n.strong,{children:"bzip2"})," file"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"> file flag\r\nflag: bzip2 compressed data, block size = 900k\r\n                                                                                                              \r\n> bunzip2 flag            \r\nbunzip2: Can't guess original name for flag -- using flag.out\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Extracting the bzip2 file gave me a ",(0,r.jsx)(n.strong,{children:"gzip"})," file"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'> file flag.out \r\nflag.out: gzip compressed data, was "flag", last modified: Thu Mar 16 01:40:17 2023, from Unix, original size modulo 2^32 327\r\n                                                                                                              \r\n> mv flag.out flag.gz\r\n                                                                                                              \r\n> gunzip flag.gz  \n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Unpacking the gzip yielded a ",(0,r.jsx)(n.strong,{children:"lzip"})," archive"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"> file flag    \r\nflag: lzip compressed data, version: 1\r\n                                                                                                              \r\n> mv flag flag.lz    \r\n                                                                                                                                                                                                                      \r\n> lzip -d flag.lz\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["This led to an ",(0,r.jsx)(n.strong,{children:"LZ4"})," file"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"> file flag\r\nflag: LZ4 compressed data (v1.4+)\r\n                                                                                                              \r\n> mv flag flag.lz4\r\n                                                                                                              \r\n> lz4 -dv flag.lz4 \r\n*** lz4 v1.10.0 64-bit multithread, by Yann Collet ***\r\nDecoding file flag \r\nflag.lz4                       : decoded 265 bytes\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Which unpacked into an ",(0,r.jsx)(n.strong,{children:"lzma"})," file"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"> file flag      \r\nflag: LZMA compressed data, non-streamed, size 254\r\n                                                                                                              \r\n> mv flag flag.lzma\r\n                                                                                                              \r\n> lzma -d flag.lzma\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Then came an ",(0,r.jsx)(n.strong,{children:"lzop"})," file"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"> file flag\r\nflag: lzop compressed data - version 1.040, LZO1X-1, os: Unix\r\n                                                                                                              \r\n> mv flag flag.lzo \r\n                                                                                                              \r\n> lzop -d flag.lzo\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Followed by yet another ",(0,r.jsx)(n.strong,{children:"lzip"})," file"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"> file flag\r\nflag: lzip compressed data, version: 1\r\n                                                                                                              \r\n> mv flag flag.lzip\r\n                                                                                                              \r\n> lzip -d flag.lzip\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Then an ",(0,r.jsx)(n.strong,{children:"xz"})," archive"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"> file flag.lzip.out \r\nflag.lzip.out: XZ compressed data, checksum CRC64\r\n                                                                                                              \r\n> mv flag.lzip.out flag.xz\r\n                                                                                                              \r\n> xz -d flag.xz \n"})}),"\n",(0,r.jsx)(n.p,{children:"After unpacking layer upon layer of compression formats, I finally retrieved a file containing the flag-written in hexadecimal."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"> file flag         \r\nflag: ASCII text\r\n                                                                                                              \r\n> cat flag                         \r\n7069636f4354467b66316c656e406d335f6d406e3170756c407431306e5f\r\n6630725f3062326375723137795f37396230316332367d0a\n"})}),"\n",(0,r.jsx)(n.p,{children:"Decoding it revealed the final flag."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"> cat flag | xxd -r -p\r\npicoCTF{f1len@m3_m@n1pul@t10n_f0r_0b2cur17y_79b01c26}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["A true test of patience and decompression skills (",(0,r.jsx)(n.em,{children:"and I hate it lol"}),")."]}),"\n",(0,r.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"picoCTF{f1len@m3_m@n1pul@t10n_f0r_0b2cur17y_79b01c26}"})}),"\n"]})]})}function f(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453(e,n,l){l.d(n,{R:()=>c,x:()=>a});var i=l(96540);const r={},s=i.createContext(r);function c(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);