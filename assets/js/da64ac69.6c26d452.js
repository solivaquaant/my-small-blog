"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[303],{37412(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"root-me/cracking/elf-x86-0-protection","title":"ELF x86 - 0 protection","description":"- Description: First challenge of cracking, writen in C with vi and compiled with GCC32","source":"@site/docs/root-me/cracking/elf-x86-0-protection.mdx","sourceDirName":"root-me/cracking","slug":"/root-me/cracking/elf-x86-0-protection","permalink":"/docs/root-me/cracking/elf-x86-0-protection","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Reverse engineering","permalink":"/docs/tags/reverse-engineering","description":"Includes write-ups on the topic of Reverse engineering"},{"inline":false,"label":"Linux","permalink":"/docs/tags/linux","description":"Includes write-ups on the topic of Linux"}],"version":"current","frontMatter":{"tags":["reverse-engineering","linux"]},"sidebar":"writeupsSidebar","previous":{"title":"Crackings","permalink":"/docs/category/crackings"},"next":{"title":"Cryptanalysis","permalink":"/docs/category/cryptanalysis"}}');var c=r(74848),t=r(28453);const s={tags:["reverse-engineering","linux"]},o="ELF x86 - 0 protection",a={},l=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"elf-x86---0-protection",children:"ELF x86 - 0 protection"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Description:"})," First challenge of cracking, writen in C with vi and compiled with GCC32"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Difficulty:"})," Very easy"]}),"\n"]}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,c.jsx)(n.p,{children:"For this challenge, we are provided with a Linux executable file."}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"> file ch1.bin                                                                                             \r\nch1.bin: ELF 32-bit LSB executable, Intel i386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.9, not stripped\n"})}),"\n",(0,c.jsxs)(n.p,{children:["After granting execute permission to the file (",(0,c.jsx)(n.code,{children:"chmod +x ch1.bin"}),") and running it, the program prompts for a password.\r\nEntering an arbitrary value results in an incorrect password message and the program exits."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"> ./ch1.bin       \r\n############################################################\r\n##        Bienvennue dans ce challenge de cracking        ##\r\n############################################################\r\n\r\nVeuillez entrer le mot de passe : password\r\nDommage, essaye encore une fois.\n"})}),"\n",(0,c.jsxs)(n.p,{children:["At this point, we can make a simple assumption: the program is comparing our input against a hardcoded password inside the binary.\r\nTo confirm this behavior, we can use ",(0,c.jsx)(n.code,{children:"ltrace"})," for analysis.\r\n",(0,c.jsx)(n.code,{children:"ltrace"})," is a Linux debugging tool that traces library calls made by a program during execution."]}),"\n",(0,c.jsxs)(n.p,{children:["From the ",(0,c.jsx)(n.code,{children:"ltrace"})," output below, after entering an arbitrary password, we can clearly see that the program compares our input string with the string ",(0,c.jsx)(n.code,{children:"123456789"}),".\r\nThis strongly suggests that ",(0,c.jsx)(n.code,{children:"123456789"})," is the correct password."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:'> ltrace ./ch1.bin \r\n__libc_start_main(["./ch1.bin"] <unfinished ...>\r\nputs("################################"...############################################################\r\n)                            = 61\r\nputs("##        Bienvennue dans ce cha"...##        Bienvennue dans ce challenge de cracking        ##\r\n)                            = 61\r\nputs("################################"...############################################################\r\n\r\n)                            = 62\r\nprintf("Veuillez entrer le mot de passe "...)                          = 34\r\nmalloc(2)                                                              = 0x92b55f0\r\n//highlight-next-line\r\ngetchar(2, 0xf7f02c60, 0xffcec328, 0xf7cc52f5Veuillez entrer le mot de passe : password\r\n)                         = 112\r\nrealloc(0x92b55f0, 2)                                                  = 0x92b55f0\r\ngetchar(0x92b55f0, 2, 0xffcec328, 0xf7cc52f5)                          = 97\r\nrealloc(0x92b55f0, 3)                                                  = 0x92b55f0\r\ngetchar(0x92b55f0, 3, 0xffcec328, 0xf7cc52f5)                          = 115\r\nrealloc(0x92b55f0, 4)                                                  = 0x92b55f0\r\ngetchar(0x92b55f0, 4, 0xffcec328, 0xf7cc52f5)                          = 115\r\nrealloc(0x92b55f0, 5)                                                  = 0x92b55f0\r\ngetchar(0x92b55f0, 5, 0xffcec328, 0xf7cc52f5)                          = 119\r\nrealloc(0x92b55f0, 6)                                                  = 0x92b55f0\r\ngetchar(0x92b55f0, 6, 0xffcec328, 0xf7cc52f5)                          = 111\r\nrealloc(0x92b55f0, 7)                                                  = 0x92b55f0\r\ngetchar(0x92b55f0, 7, 0xffcec328, 0xf7cc52f5)                          = 114\r\nrealloc(0x92b55f0, 8)                                                  = 0x92b55f0\r\ngetchar(0x92b55f0, 8, 0xffcec328, 0xf7cc52f5)                          = 100\r\nrealloc(0x92b55f0, 9)                                                  = 0x92b55f0\r\ngetchar(0x92b55f0, 9, 0xffcec328, 0xf7cc52f5)                          = 10\r\n//highlight-next-line\r\nstrcmp("password", "123456789")                                        = 1\r\nputs("Dommage, essaye encore une fois."...Dommage, essaye encore une fois.\r\n)                            = 33\r\n+++ exited (status 0) +++\n'})}),"\n",(0,c.jsx)(n.p,{children:"Running the program again and entering the identified string confirms that it is indeed the correct password."}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"> ./ch1.bin       \r\n############################################################\r\n##        Bienvennue dans ce challenge de cracking        ##\r\n############################################################\r\n\r\nVeuillez entrer le mot de passe : 123456789\r\nBien joue, vous pouvez valider l'epreuve avec le pass : 123456789!\n"})}),"\n",(0,c.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.code,{children:"123456789"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},28453(e,n,r){r.d(n,{R:()=>s,x:()=>o});var i=r(96540);const c={},t=i.createContext(c);function s(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:s(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);