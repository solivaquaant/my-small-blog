"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[9511],{7552:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>a,frontMatter:()=>i,metadata:()=>c,toc:()=>d});const c=JSON.parse('{"id":"pico-ctf/cryptography/even-rsa-can-be-broken","title":"EVEN RSA CAN BE BROKEN???","description":"- Description: This service provides you an encrypted flag. Can you decrypt it with just N & e?","source":"@site/docs/pico-ctf/cryptography/even-rsa-can-be-broken.mdx","sourceDirName":"pico-ctf/cryptography","slug":"/pico-ctf/cryptography/even-rsa-can-be-broken","permalink":"/my-small-blog/docs/pico-ctf/cryptography/even-rsa-can-be-broken","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"cryptography","permalink":"/my-small-blog/docs/tags/cryptography"}],"version":"current","frontMatter":{"tags":["cryptography"]},"sidebar":"tutorialSidebar","previous":{"title":"13","permalink":"/my-small-blog/docs/pico-ctf/cryptography/13/"},"next":{"title":"hashcrack","permalink":"/my-small-blog/docs/pico-ctf/cryptography/hashcrack"}}');var t=r(4848),o=r(8453);const i={tags:["cryptography"]},s="EVEN RSA CAN BE BROKEN???",l={},d=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"even-rsa-can-be-broken",children:"EVEN RSA CAN BE BROKEN???"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Description:"})," This service provides you an encrypted flag. Can you decrypt it with just N & e?"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Difficulty:"})," Easy"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,t.jsxs)(n.p,{children:["This challenge centers around the ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"https://www.geeksforgeeks.org/rsa-algorithm-cryptography/",children:"RSA algorithm"})}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["We begin by recalling the fundamentals of RSA, including its key formulas and structure.\r\nRSA encryption uses a public key ",(0,t.jsx)(n.code,{children:"(N, e)"})," and encrypts a message ",(0,t.jsx)(n.code,{children:"M"})," into a ciphertext ",(0,t.jsx)(n.code,{children:"C"})," using the equation:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"C = M^e mod N\n"})}),"\n",(0,t.jsxs)(n.p,{children:["To decrypt and recover the original plaintext ",(0,t.jsx)(n.code,{children:"M"}),", we need the private key exponent ",(0,t.jsx)(n.code,{children:"d"}),", which satisfies:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"M = C^d mod N\n"})}),"\n",(0,t.jsxs)(n.p,{children:["However, computing ",(0,t.jsx)(n.code,{children:"d"})," requires knowing Euler's totient function ",(0,t.jsx)(n.code,{children:"\u03c6(N)"}),", which in turn depends on the prime factors ",(0,t.jsx)(n.code,{children:"p"})," and ",(0,t.jsx)(n.code,{children:"q"})," of ",(0,t.jsx)(n.code,{children:"N"}),", since:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"N = p * q\r\n\u03c6(N) = (p - 1)(q - 1)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Upon connecting to the server, we are provided with ",(0,t.jsx)(n.code,{children:"N"}),", ",(0,t.jsx)(n.code,{children:"e"}),", and the ciphertext ",(0,t.jsx)(n.code,{children:"C"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"N: 21037151367180372765283953053086158000036636729721345923644288910205211401496718658564665653657364950489341853920464418028274161652165537591176971735966138\r\ne: 65537\r\ncyphertext: 6941187568627937171315289359497121515277569008096997024216911574186045398719488165082024925203613804200214707279648799387512395476391994412507744098543075\n"})}),"\n",(0,t.jsxs)(n.p,{children:["A key insight in this challenge is that ",(0,t.jsx)(n.code,{children:"N"})," is an ",(0,t.jsx)(n.strong,{children:"even"})," number.\r\nSince the product of 2 odd primes is always odd, the only way for ",(0,t.jsx)(n.code,{children:"N"})," to be even is if one of the primes is 2. Thus, we deduce:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"p = 2\r\nq = N / 2\n"})}),"\n",(0,t.jsxs)(n.p,{children:["With both ",(0,t.jsx)(n.code,{children:"p"})," and ",(0,t.jsx)(n.code,{children:"q"})," known, we can compute ",(0,t.jsx)(n.code,{children:"\u03c6(N)"}),", derive the private exponent ",(0,t.jsx)(n.code,{children:"d"}),", and ultimately decrypt the ciphertext to recover the original plaintext ",(0,t.jsx)(n.code,{children:"M"}),".\r\nHere I write a little script to solve the challenge:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from Crypto.Util.number import long_to_bytes\r\n\r\nN = 21037151367180372765283953053086158000036636729721345923644288910205211401496718658564665653657364950489341853920464418028274161652165537591176971735966138\r\ne = 65537\r\n\r\nq = N // 2\r\nphi_N = q - 1\r\nd = pow(e, -1, phi_N)\r\n\r\nc = 6941187568627937171315289359497121515277569008096997024216911574186045398719488165082024925203613804200214707279648799387512395476391994412507744098543075\r\nm = pow(c, d, N)\r\nflag = long_to_bytes(m)\r\nprint(flag)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"picoCTF{tw0_1$_pr!m33486c703}"})}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>s});var c=r(6540);const t={},o=c.createContext(t);function i(e){const n=c.useContext(o);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),c.createElement(o.Provider,{value:n},e.children)}}}]);