"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[3508],{28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>r});var s=i(96540);const o={},t=s.createContext(o);function a(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),s.createElement(t.Provider,{value:n},e.children)}},80414:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"pico-ctf/forensics/advanced-potion-making/advanced-potion-making","title":"advanced-potion-making","description":"- Description: Ron just found his own copy of advanced potion making, but its been corrupted by some kind of spell.","source":"@site/docs/pico-ctf/forensics/advanced-potion-making/advanced-potion-making.mdx","sourceDirName":"pico-ctf/forensics/advanced-potion-making","slug":"/pico-ctf/forensics/advanced-potion-making/","permalink":"/my-small-blog/docs/pico-ctf/forensics/advanced-potion-making/","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Forensics","permalink":"/my-small-blog/docs/tags/forensics","description":"Includes write-ups on the topic of Forensics"},{"inline":false,"label":"Steganography","permalink":"/my-small-blog/docs/tags/steganography","description":"Includes write-ups on the topic of Steganography"}],"version":"current","frontMatter":{"tags":["forensics","steganography"]},"sidebar":"writeupsSidebar","previous":{"title":"Forensics","permalink":"/my-small-blog/docs/category/forensics"},"next":{"title":"Bitlocker-1","permalink":"/my-small-blog/docs/pico-ctf/forensics/bitlocker-1"}}');var o=i(74848),t=i(28453);const a={tags:["forensics","steganography"]},r="advanced-potion-making",c={},d=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"advanced-potion-making",children:"advanced-potion-making"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Description:"})," Ron just found his own copy of advanced potion making, but its been corrupted by some kind of spell.\r\nHelp him recover it!"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,o.jsx)(n.p,{children:"This challenge provides us with a file whose type is initially unknown."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"> file advanced-potion-making \r\nadvanced-potion-making: data\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Inspecting the file's hexadecimal data reveals the string ",(0,o.jsx)(n.code,{children:"IHDR"}),".\r\n",(0,o.jsx)(n.code,{children:"IHDR"})," is the first chunk in the PNG format and always appears immediately after the 8-byte PNG signature."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"> xxd advanced-potion-making\r\n00000000: 8950 4211 0d0a 1a0a 0012 1314 4948 4452  .PB.........IHDR\r\n00000010: 0000 0990 0000 04d8 0802 0000 0004 2de7  ..............-.\r\n00000020: 7800 0000 0173 5247 4200 aece 1ce9 0000  x....sRGB.......\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Opening the file in ",(0,o.jsx)(n.strong,{children:"HxD"})," (or any hex editor) shows that its header does not match the correct PNG header format.\r\nTo fix this, we modify the first 16 bytes to ",(0,o.jsx)(n.code,{children:"89 50 42 11 0D 0A 1A 0A 00 12 13 14 49 48 44 52"}),"."]}),"\n",(0,o.jsx)("div",{style:{width:"80%",margin:"0 auto"},children:(0,o.jsx)("img",{src:i(93757).A,style:{width:"100%",height:"auto"}})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsxs)(n.em,{children:["You can refer to ",(0,o.jsx)(n.a,{href:"https://asecuritysite.com/forensics/png?file=%2Flog%2Fbasn0g01.png",children:"PNG header specifications"})," for details."]})}),"\n",(0,o.jsxs)(n.p,{children:["After this correction, the file displays as a solid red image.\r\nUsing ",(0,o.jsx)(n.a,{href:"https://github.com/eugenekolo/sec-tools/tree/master/stego/stegsolve/stegsolve",children:(0,o.jsx)(n.strong,{children:"Stegsolve"})})," to view the image under different planes,\r\nwe find that in the ",(0,o.jsx)(n.em,{children:"Red plane 0"})," mode, the hidden flag is revealed."]}),"\n",(0,o.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,o.jsx)("img",{src:i(81303).A,style:{width:"100%",height:"auto"}})}),"\n",(0,o.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"picoCTF{w1z4rdry}"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},81303:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/flag-8bb586cba679dfad3fef1f1ec096effc.png"},93757:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/hxd-9dad208df8d7e9ce312c894d8562c9b7.png"}}]);