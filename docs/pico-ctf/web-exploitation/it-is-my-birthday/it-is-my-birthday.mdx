---
tags: [web]
---
# It is my Birthday

- **Description:** I sent out 2 invitations to all of my friends for my birthday! 
I'll know if they get stolen because the 2 invites look similar, and they even have the same md5 hash, but they are slightly different! 
You wouldn't believe how long it took me to find a collision. 
Anyway, see if you're invited by submitting 2 PDFs to my website.
- **Difficulty:** Medium

---

## ðŸ”Ž Solution
From the challenge description, it is clear that this task revolves around an **MD5 hash collision** - a scenario where 2 different inputs produce the same MD5 hash value. A similar idea also appears in picoCTF with the challenge [**Apriti sesamo**](https://blog.solivaquaant.site/docs/pico-ctf/web-exploitation/apriti-sesamo/), which exploits a SHA-1 hash collision instead.

In this case, I generated 2 different files that share the same MD5 hash using the [fastcoll tool](https://github.com/upbit/clone-fastcoll). 
The tool can be downloaded and built with the following commands:
```
git clone https://github.com/upbit/clone-fastcoll fastcoll
cd fastcoll
make
```

After that, I generated 2 colliding files using:
```
./fastcoll/fastcoll md5_data
```

The output consists of 2 files, `md5_data1` and `md5_data2`. 
When checking their MD5 hashes, both files produce exactly the same hash value:
```
> md5sum md5_data*
6ce6291e2a8497d0b25b3c553f1f4444  md5_data1
6ce6291e2a8497d0b25b3c553f1f4444  md5_data2
```

However, comparing their contents shows that the 2 files are clearly different. 
This confirms that they satisfy the condition of an MD5 hash collision:
```
> diff md5_data1 md5_data2
1,2c1,2
< ï¿½Yï¿½9ï¿½1ï¿½ï¿½ï¿½ï¿½iBZ,ï¿½CIï¿½/Oï¿½ï¿½ï¿½#)ï¿½ï¿½ï¿½ï¿½IÅ£ï¿½ï¿½     u9ï¿½Ãªï¿½ï¿½ï¿½XBGCï¿½hï¿½kï¿½ï¿½ï¿½wï¿½
ï¿½ï¿½Lï¿½MÏ½?â–’ï¿½M^ï¿½*<É™ï¿½hï¿½ï¿½|ï¿½nï¿½ï¿½%ï¿½Ú§^d
\ No newline at end of file
---
> ï¿½Yï¿½9ï¿½1ï¿½ï¿½ï¿½ï¿½iBZ,;CIï¿½/Oï¿½ï¿½ï¿½#)ï¿½ï¿½ï¿½ï¿½IÅ£ï¿½ï¿½     u9ï¿½Cï¿½ï¿½ï¿½ï¿½XBGCï¿½hï¿½ï¿½ï¿½ï¿½ï¿½wï¿½
ï¿½ï¿½Lï¿½MÏ½?â–’ï¿½M^ï¿½*<É™ï¿½ï¿½ï¿½ï¿½|ï¿½nï¿½ï¿½%ï¿½Zï¿½^d
\ No newline at end of file
```

Since the web application only accepts PDF uploads, I simply appended the `.pdf` extension to both files and uploaded them to the site. 
This successfully triggered the vulnerability and returned the flag.
<div style={{ width: '100%', margin: '0 auto' }}>
	<img src={require("./flag.png").default} style={{ width: '100%', height: 'auto' }} />
</div>


## ðŸš©Flag
> `picoCTF{c0ngr4ts_u_r_1nv1t3d_c63bbaf}`