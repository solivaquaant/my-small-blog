"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[4189],{1946:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"root-me/forensic/command-and-control-level-6/command-and-control-level-6","title":"Command & Control - level 6","description":"- Description: Berthier, before blocking any of the malware\'s traffic on our firewalls, we need to make sure we found all its C&C.","source":"@site/docs/root-me/forensic/command-and-control-level-6/command-and-control-level-6.mdx","sourceDirName":"root-me/forensic/command-and-control-level-6","slug":"/root-me/forensic/command-and-control-level-6/","permalink":"/my-small-blog/docs/root-me/forensic/command-and-control-level-6/","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"tags":[]},"sidebar":"tutorialSidebar","previous":{"title":"Command & Control - level 5","permalink":"/my-small-blog/docs/root-me/forensic/command-and-control-level-5"},"next":{"title":"Deleted file","permalink":"/my-small-blog/docs/root-me/forensic/deleted-file/"}}');var r=o(4848),l=o(8453);const a={tags:[]},i="Command & Control - level 6",s={},c=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"command--control---level-6",children:"Command & Control - level 6"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description:"})," Berthier, before blocking any of the malware's traffic on our firewalls, we need to make sure we found all its C&C.\r\nThis will let us know if there are other infected hosts on our network and be certain we've locked the attackers out.\r\nThat's it Berthier, we're almost there, reverse this malware!\r\nThe validation password is a fully qualified domain name : hote.domaine.tld"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,r.jsxs)(n.p,{children:["From the ",(0,r.jsx)(n.strong,{children:"Command & Control - Level 3"})," challenge, we identified the ",(0,r.jsx)(n.strong,{children:"iexplore.exe"})," process as a strong candidate for containing malicious code.\r\nTo analyze it further, we used ",(0,r.jsx)(n.code,{children:"procdump"})," plugin to extract the process into an executable file sample.\r\nThis gave us a standalone .exe file for deeper inspection."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop]\r\n\u2514\u2500$ ./vol2/volatility2 -f ch2.dmp --profile=Win7SP0x86 procdump -p 2772 --dump-dir=./root-me           \r\nVolatility Foundation Volatility Framework 2.6\r\nProcess(V) ImageBase  Name                 Result\r\n---------- ---------- -------------------- ------\r\n0x87b6b030 0x00400000 iexplore.exe         OK: executable.2772.exe\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Next, we uploaded this file to ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.a,{href:"https://www.virustotal.com/gui/home/upload",children:"VirusTotal"})}),", a trusted platform for malware scanning and threat intelligence.\r\nThe results were conclusive: 58 out of 72 antivirus engines flagged the file as malicious. You can view details ",(0,r.jsx)(n.a,{href:"https://www.virustotal.com/gui/file/13170ec31cf0920ad871b0d0603b6f575f847e523ac977e5177adaf62d569853",children:"here"}),(0,r.jsx)(n.br,{}),"\n","In the ",(0,r.jsx)(n.strong,{children:"Behaviors"})," tab, VirusTotal provided valuable behavioral data, including DNS resolution activity.\r\nThese domain names are likely associated with Command and Control (C2) servers, suggesting that the malware attempts to establish outbound connections to communicate with an external attacker-controlled infrastructure."]}),"\n",(0,r.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,r.jsx)("img",{src:o(8130).A,style:{width:"100%",height:"auto"}})}),"\n",(0,r.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"th1sis.l1k3aK3y.org"})}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8130:(e,n,o)=>{o.d(n,{A:()=>t});const t=o.p+"assets/images/dns-dd0c9760b5e66577cd45ab00022593bd.png"},8453:(e,n,o)=>{o.d(n,{R:()=>a,x:()=>i});var t=o(6540);const r={},l=t.createContext(r);function a(e){const n=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);