"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[7444],{28453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>c});var t=n(96540);const r={},i=t.createContext(r);function o(e){const s=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:s},e.children)}},59999:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"pico-ctf/forensics/bitlocker-1","title":"Bitlocker-1","description":"- Description: Jacky is not very knowledgable about the best security passwords and used a simple password to encrypt their BitLocker drive. See if you can break through the encryption!","source":"@site/docs/pico-ctf/forensics/bitlocker-1.mdx","sourceDirName":"pico-ctf/forensics","slug":"/pico-ctf/forensics/bitlocker-1","permalink":"/my-small-blog/docs/pico-ctf/forensics/bitlocker-1","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Forensics","permalink":"/my-small-blog/docs/tags/forensics","description":"Includes write-ups on the topic of Forensics"},{"inline":false,"label":"Windows","permalink":"/my-small-blog/docs/tags/windows","description":"Includes write-ups on the topic of Windows"}],"version":"current","frontMatter":{"tags":["forensics","windows"]},"sidebar":"writeupsSidebar","previous":{"title":"advanced-potion-making","permalink":"/my-small-blog/docs/pico-ctf/forensics/advanced-potion-making/"},"next":{"title":"Bitlocker-2","permalink":"/my-small-blog/docs/pico-ctf/forensics/bitlocker-2"}}');var r=n(74848),i=n(28453);const o={tags:["forensics","windows"]},c="Bitlocker-1",l={},d=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function a(e){const s={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"bitlocker-1",children:"Bitlocker-1"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Description:"})," Jacky is not very knowledgable about the best security passwords and used a simple password to encrypt their BitLocker drive. See if you can break through the encryption!"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,r.jsxs)(s.p,{children:["Upon analyzing the provided ",(0,r.jsx)(s.code,{children:"bitlocker-1.dd"})," disk image, we identified the presence of the string ",(0,r.jsx)(s.strong,{children:"FVE-FS"}),", which signifies a BitLocker-encrypted volume (Full Volume Encryption File System).\r\nThis confirms that the partition has been secured using BitLocker."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'> file bitlocker-1.dd \r\nbitlocker-1.dd: DOS/MBR boot sector, code offset 0x58+2, OEM-ID "-FVE-FS-", sectors/cluster 8, reserved sectors 0, Media descriptor 0xf8, sectors/track 63, heads 255, hidden sectors 124499968, FAT (32 bit), sectors/FAT 8160, serial number 0, unlabeled; NTFS, sectors/track 63, physical drive 0x1fe0, $MFT start cluster 393217, serial number 02020454d414e204f, checksum 0x41462020\n'})}),"\n",(0,r.jsxs)(s.p,{children:["To proceed, we used the ",(0,r.jsx)(s.code,{children:"bitlocker2john"})," tool to extract a hash from the encrypted volume."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"bitlocker2john -i bitlocker-1.dd > bitlocker_hash.txt \n"})}),"\n",(0,r.jsx)(s.p,{children:"From the tool's output, we isolated only the relevant portion of the hash:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"$bitlocker$0$16$cb4809fe9628471a411f8380e0f668db$1048576$12$d04d9c58eed6da010a000000$60$68156e51e53f0a01c076a32ba2b2999afffce8530fbe5d84b4c19ac71f6c79375b87d40c2d871ed2b7b5559d71ba31b6779c6f41412fd6869442d66d\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Next, we launched a brute-force attack using John the Ripper along with the well-known ",(0,r.jsx)(s.code,{children:"rockyou.txt"})," wordlist.\r\nThe correct password was successfully recovered as ",(0,r.jsx)(s.strong,{children:"jacqueline"}),"."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"> john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt\r\nNote: This format may emit false positives, so it will keep trying even after finding a possible candidate.\r\nUsing default input encoding: UTF-8\r\nLoaded 1 password hash (BitLocker, BitLocker [SHA-256 AES 32/64])\r\nCost 1 (iteration count) is 1048576 for all loaded hashes\r\nWill run 4 OpenMP threads\r\nPress 'q' or Ctrl-C to abort, almost any other key for status\r\njacqueline       (?)     \r\n1g 0:00:04:33 0.02% (ETA: 2025-06-13 14:38) 0.003662g/s 11.99p/s 11.99c/s 11.99C/s sylvia..lololo\r\n1g 0:00:06:32 0.03% (ETA: 2025-06-14 14:00) 0.002546g/s 11.58p/s 11.58c/s 11.58C/s 1q2w3e4r5t..metalica\r\nSession aborted\n"})}),"\n",(0,r.jsx)(s.p,{children:"We then set up 2 directories to assist with the decryption and mounting process:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"/media/bit"}),": to store the decrypted BitLocker data."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"/media/win"}),": to serve as the mount point for accessing the file system."]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["Using the password retrieved earlier, we decrypted the volume with ",(0,r.jsx)(s.code,{children:"dislocker"}),":"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"sudo mkdir -p /media/bit\r\nsudo chmod 777 /media/bit\r\nsudo dislocker -V bitlocker-1.dd -ujacqueline -- /media/bit\n"})}),"\n",(0,r.jsxs)(s.p,{children:["After successful decryption, a virtual file named ",(0,r.jsx)(s.code,{children:"dislocker-file"})," was created in ",(0,r.jsx)(s.code,{children:"/media/bit"}),". This file represents the unlocked volume."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"> sudo ls /media/bit                 \r\ndislocker-file\n"})}),"\n",(0,r.jsx)(s.p,{children:"Next, we mounted the decrypted volume:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"> sudo mkdir -p /media/win                                  \r\n                                                                                                                                                                                                                                                                     \r\n> sudo mount -o loop /media/bit/dislocker-file /media/win\r\nThe disk contains an unclean file system (0, 0).\r\nMetadata kept in Windows cache, refused to mount.\r\nFalling back to read-only mount because the NTFS partition is in an\r\nunsafe state. Please resume and shutdown Windows fully (no hibernation\r\nor fast restarting.)\r\nCould not mount read-write, trying read-only\n"})}),"\n",(0,r.jsxs)(s.p,{children:["During mounting, the system detected an unclean file system state (likely due to hibernation or improper shutdown in Windows).\r\nAs a result, the volume was mounted in ",(0,r.jsx)(s.strong,{children:"read-only"})," mode for safety.",(0,r.jsx)(s.br,{}),"\n","Finally, we navigated to the mounted directory and retrieved the flag."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"> cat flag.txt \r\npicoCTF{us3_b3tt3r_p4ssw0rd5_pl5!_3242adb1} \n"})}),"\n",(0,r.jsx)(s.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"picoCTF{us3_b3tt3r_p4ssw0rd5_pl5!_3242adb1}"})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);