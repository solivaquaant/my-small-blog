"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[1290],{31376(e,s,n){n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"root-me/web-server/api-broken-access/api-broken-access","title":"API - Broken Access","description":"- Description: Your friend has set up a platform where you can register and post a private note.","source":"@site/docs/root-me/web-server/api-broken-access/api-broken-access.mdx","sourceDirName":"root-me/web-server/api-broken-access","slug":"/root-me/web-server/api-broken-access/","permalink":"/docs/root-me/web-server/api-broken-access/","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Web","permalink":"/docs/tags/web","description":"Includes write-ups on the topic of Web"}],"version":"current","frontMatter":{"tags":["web"]},"sidebar":"writeupsSidebar","previous":{"title":"Web - Server","permalink":"/docs/category/web---server"},"next":{"title":"Backup file","permalink":"/docs/root-me/web-server/backup-file"}}');var t=n(74848),i=n(28453);const o={tags:["web"]},c="API - Broken Access",a={},d=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function l(e){const s={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"api---broken-access",children:"API - Broken Access"})}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Description:"})," Your friend has set up a platform where you can register and post a private note.\r\nEverything is based on an API.\r\nBefore setting up the Front-End, he asked you to check that everything was secure."]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.strong,{children:"Difficulty:"})," Easy"]}),"\n"]}),"\n",(0,t.jsx)(s.hr,{}),"\n",(0,t.jsx)(s.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,t.jsx)(s.p,{children:"The challenge provides a website that exposes 4 API endpoints:"}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:["POST ",(0,t.jsx)(s.code,{children:"/api/signup"}),": allows creating a new user"]}),"\n",(0,t.jsxs)(s.li,{children:["POST ",(0,t.jsx)(s.code,{children:"/api/login"}),": handles user authentication"]}),"\n",(0,t.jsxs)(s.li,{children:["GET ",(0,t.jsx)(s.code,{children:"/api/user"}),": retrieves user information"]}),"\n",(0,t.jsxs)(s.li,{children:["PUT ",(0,t.jsx)(s.code,{children:"/api/note"}),": updates the user's note"]}),"\n"]}),"\n",(0,t.jsx)(s.p,{children:"I created a user and logged in using the first two endpoints, and everything worked as expected with no obvious issues."}),"\n",(0,t.jsxs)(s.p,{children:["While observing the GET ",(0,t.jsx)(s.code,{children:"/api/user"})," API, it is clear that user information is fetched based on ",(0,t.jsx)(s.code,{children:"user_id"}),", which is defined as an integer.\r\nHowever, when supplying any arbitrary numeric value as ",(0,t.jsx)(s.code,{children:"user_id"}),", the response always returns my own account information, with ",(0,t.jsx)(s.code,{children:"user_id"})," fixed to 3."]}),"\n",(0,t.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,t.jsx)("img",{src:n(82413).A,style:{width:"100%",height:"auto"}})}),"\n",(0,t.jsxs)(s.p,{children:["At this point, I sent the request to Burp Suite Intruder to perform brute forcing on the ",(0,t.jsx)(s.code,{children:"user_id"})," parameter."]}),"\n",(0,t.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,t.jsx)("img",{src:n(19391).A,style:{width:"100%",height:"auto"}})}),"\n",(0,t.jsxs)(s.p,{children:["As a result, when querying ",(0,t.jsx)(s.code,{children:"/api/user/1"}),", the response contains the flag."]}),"\n",(0,t.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,t.jsx)("img",{src:n(52576).A,style:{width:"100%",height:"auto"}})}),"\n",(0,t.jsxs)(s.p,{children:["The vulnerability in this application is an ",(0,t.jsx)(s.strong,{children:"IDOR (Insecure Direct Object Reference)"}),".\r\nThis is an access control flaw that occurs when an application directly references internal objects (such as IDs, files, or records) without properly verifying whether the user is authorized to access them."]}),"\n",(0,t.jsx)(s.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,t.jsxs)(s.blockquote,{children:["\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.code,{children:"RM{E4sy_1d0r_0n_API}"})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},52576(e,s,n){n.d(s,{A:()=>r});const r=n.p+"assets/images/flag-d9fc4a5c1072469c94031769dbe03554.png"},82413(e,s,n){n.d(s,{A:()=>r});const r=n.p+"assets/images/id-b945be503968dc9769ded7f0e29615d6.png"},19391(e,s,n){n.d(s,{A:()=>r});const r=n.p+"assets/images/intruder-e5f95d7fc4d495ce427ea197bc6e8685.png"},28453(e,s,n){n.d(s,{R:()=>o,x:()=>c});var r=n(96540);const t={},i=r.createContext(t);function o(e){const s=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);