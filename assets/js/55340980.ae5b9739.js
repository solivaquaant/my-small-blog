"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[4449],{951:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/capture2-63fb95432ddd28b64202b578dc185050.png"},3537:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/flag-ab2c93574315f9bf27c1bab79e52bad8.png"},7020:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/capture1-25758575005b8444509f976761adfe0e.png"},8453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>a});var t=n(6540);const o={},i=t.createContext(o);function r(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(i.Provider,{value:s},e.children)}},8733:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"root-me/forensic/capture-this/capture-this","title":"Capture this","description":"- Description: An employee has lost his Keepass password.","source":"@site/docs/root-me/forensic/capture-this/capture-this.mdx","sourceDirName":"root-me/forensic/capture-this","slug":"/root-me/forensic/capture-this/","permalink":"/my-small-blog/docs/root-me/forensic/capture-this/","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"forensic","permalink":"/my-small-blog/docs/tags/forensic"}],"version":"current","frontMatter":{"tags":["forensic"]},"sidebar":"tutorialSidebar","previous":{"title":"Forensic","permalink":"/my-small-blog/docs/category/forensic"},"next":{"title":"Command & Control - level 2","permalink":"/my-small-blog/docs/root-me/forensic/command-and-control-level-2"}}');var o=n(4848),i=n(8453);const r={tags:["forensic"]},a="Capture this",l={},c=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function h(e){const s={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.header,{children:(0,o.jsx)(s.h1,{id:"capture-this",children:"Capture this"})}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Description:"})," An employee has lost his Keepass password.\r\nHe couldn't remember it, and couldn't find his password file.\r\nAfter hours of searching, it turns out that he has sent a screen of his passwords to one of his colleagues, but it's still nowhere to be found.\r\nHe's asking for your help to find him.\r\nIt's up to you"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Difficulty:"})," Easy"]}),"\n"]}),"\n",(0,o.jsx)(s.hr,{}),"\n",(0,o.jsx)(s.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,o.jsxs)(s.p,{children:["The challenge provides 2 files: a screenshot of an Excel spreadsheet containing passwords and a ",(0,o.jsx)(s.code,{children:".kdbx"})," file."]}),"\n",(0,o.jsxs)(s.p,{children:["The ",(0,o.jsx)(s.code,{children:".kdbx"})," file is a KeePass database file, which is commonly used to securely store and manage passwords.\r\nThese files are encrypted and can only be opened with the correct master password."]}),"\n",(0,o.jsx)(s.p,{children:"Upon inspecting the screenshot, we see an image of an Excel file containing several passwords.\r\nHowever, there's no visible password for the KeePass database.\r\nA closer look at the screenshot reveals two critical observations:"}),"\n",(0,o.jsxs)(s.ol,{children:["\n",(0,o.jsx)(s.li,{children:"There appears to be partial information related to KeePass on the right side of the image, but it has been cropped."}),"\n",(0,o.jsx)(s.li,{children:"The user captured the screenshot using two applications: Excel and the Windows Snipping Tool."}),"\n"]}),"\n",(0,o.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,o.jsx)("img",{src:n(7020).A,style:{width:"100%",height:"auto"}})}),"\n",(0,o.jsxs)(s.p,{children:["These clues, combined with the fact that the challenge was created in 2023, point us to a known vulnerability disclosed that year: ",(0,o.jsxs)(s.strong,{children:[(0,o.jsx)(s.a,{href:"https://nvd.nist.gov/vuln/detail/CVE-2023-28303",children:"CVE-2023-28303"})," - Windows Snipping Tool Information Disclosure Vulnerability"]}),".\r\nThis vulnerability affects the Snipping Tool on Windows 11 and 10.\r\nWhen a user takes a screenshot and then crops it, the cropped data may still remain in the file.\r\nThis means sensitive information, thought to be removed, could potentially be recovered."]}),"\n",(0,o.jsxs)(s.p,{children:["To exploit this vulnerability, we use this ",(0,o.jsx)(s.a,{href:"https://github.com/frankthetank-music/Acropalypse-Multi-Tool.git",children:"tool"}),".\r\nAfter cloning and installing the tool, we run it in ",(0,o.jsx)(s.strong,{children:"\u201cRestoring Tool\u201d"})," mode, select the screenshot, and choose the ",(0,o.jsx)(s.strong,{children:"\u201cWindows 11 Snipping Tool\u201d"})," format.\r\nThe tool then reconstructs the original, untrimmed image."]}),"\n",(0,o.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,o.jsx)("img",{src:n(951).A,style:{width:"100%",height:"auto"}})}),"\n",(0,o.jsxs)(s.p,{children:["Opening the recovered image reveals the KeePass password: ",(0,o.jsx)(s.code,{children:"-=b9w9h^+j%\\x-rMPUqv9Vv`@X%*=a"})]}),"\n",(0,o.jsxs)(s.p,{children:["We install ",(0,o.jsx)(s.strong,{children:"KeePassXC"}),", open the ",(0,o.jsx)(s.code,{children:".kdbx"})," file, and input the recovered password.\r\nThe database unlocks successfully.\r\nFinally, by navigating to the ",(0,o.jsx)(s.strong,{children:"Internet"})," tab within the KeePass database, we obtain the flag."]}),"\n",(0,o.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,o.jsx)("img",{src:n(3537).A,style:{width:"100%",height:"auto"}})}),"\n",(0,o.jsx)(s.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,o.jsxs)(s.blockquote,{children:["\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.code,{children:"@cropalypse_vuln_is_impressive"})}),"\n"]})]})}function d(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}}}]);