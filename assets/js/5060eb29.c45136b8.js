"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[1152],{20828:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>h,contentTitle:()=>c,default:()=>d,frontMatter:()=>l,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"hack-my-vm/challenges/crypto/094","title":"094","description":"- Description: Dr. Helena Morrison Vance, a renowned cryptographer, has left behind an encrypted message before her mysterious disappearance.","source":"@site/docs/hack-my-vm/challenges/crypto/094.mdx","sourceDirName":"hack-my-vm/challenges/crypto","slug":"/hack-my-vm/challenges/crypto/094","permalink":"/docs/hack-my-vm/challenges/crypto/094","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Cryptography","permalink":"/docs/tags/cryptography","description":"Includes write-ups on the topic of Cryptography"},{"inline":false,"label":"Scripting","permalink":"/docs/tags/scripting","description":"Includes write-ups on the topic of Scripting"}],"version":"current","frontMatter":{"tags":["cryptography","scripting"]},"sidebar":"writeupsSidebar","previous":{"title":"068","permalink":"/docs/hack-my-vm/challenges/crypto/068"},"next":{"title":"Misc","permalink":"/docs/category/misc"}}');var i=r(74848),s=r(28453);const l={tags:["cryptography","scripting"]},c="094",h={},o=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function a(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"094",children:"094"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),' Dr. Helena Morrison Vance, a renowned cryptographer, has left behind an encrypted message before her mysterious disappearance.\r\nShe was last seen working late in her laboratory, muttering something about "rotating shields" and "the key to everything lies in who I am."']}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,i.jsx)(n.p,{children:"The challenge provides an assembly file with the following code:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"> cat challenge.asm     \r\nglobal _start\r\n\r\nsection .data\r\n  ; Cipher\r\n  msg db '0 0 0 153 82 76 202 3 123 126 241 17 0 12 206 189 108 86', 10\r\n  msg_len equ $ - msg\r\n\r\nsection .text\r\n_start:\r\n  mov rax, 1  ; sys_write\r\n  mov rdi, 1  ; stdout\r\n  mov rsi, msg\r\n  mov rdx, msg_len\r\n  syscall\r\n\r\n  mov rax, 60   ; sys_exit\r\n  xor rdi, rdi\r\n  syscall\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The string ",(0,i.jsx)(n.code,{children:"0 0 0 153 82 76 202 3 123 126 241 17 0 12 206 189 108 86"})," is the ciphertext, and our task is to decrypt it to find the flag."]}),"\n",(0,i.jsx)(n.p,{children:"Analyzing the challenge description:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Dr. Helena Morrison Vance"})," is a character's name."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"The key to everything lies in who I am"}),": The encryption key is related to this character."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Rotating shields"}),': "Shields" often hints at the XOR operation (due to its symmetric property); "Rotating" hints at a bitwise rotation (ROL/ROR) or a rotating key.']}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Determining the challenge key:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Observe the first three bytes of the ciphertext: ",(0,i.jsx)(n.code,{children:"0 0 0"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["In XOR, if ",(0,i.jsx)(n.code,{children:"A ^ B = 0"}),", then ",(0,i.jsx)(n.code,{children:"A = B"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"This implies the first three characters of the plaintext (the flag) are identical to the first three characters of the key."}),"\n",(0,i.jsx)(n.li,{children:'If the key is "HMV", then the flag would start with "HMV...", which aligns perfectly with the expected flag format.'}),"\n",(0,i.jsxs)(n.li,{children:["Therefore, we conclude: ",(0,i.jsx)(n.strong,{children:'Key = "HMV"'}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Next, we need to determine the encryption algorithm:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Knowing that the first three ",(0,i.jsx)(n.code,{children:"0"})," values correspond to ",(0,i.jsx)(n.strong,{children:"HMV"}),", the next character (index 3) is ",(0,i.jsx)(n.code,{children:"153"}),", which could be ",(0,i.jsx)(n.code,{children:"{"})," (ASCII 123)."]}),"\n",(0,i.jsx)(n.li,{children:"Additional hints: the key rotates. The key character for index 3 is 'H' (ASCII 72)."}),"\n",(0,i.jsxs)(n.li,{children:["Performing ",(0,i.jsx)(n.code,{children:"123 ^ 72 = 51"})," (plaintext ^ key)."]}),"\n",(0,i.jsxs)(n.li,{children:["Relationship between 51 and 153:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["51 (Binary): ",(0,i.jsx)(n.code,{children:"00110011"})]}),"\n",(0,i.jsxs)(n.li,{children:["153 (Binary): ",(0,i.jsx)(n.code,{children:"10011001"})]}),"\n",(0,i.jsxs)(n.li,{children:["If we rotate 51 left (ROL) by 3 bits:","\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"00110011 << 3 = 10011000 (152) | 1 (bit shifted out) = 10011001 (153)\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Therefore, the encryption algorithm could be: ",(0,i.jsx)(n.code,{children:"Cipher = ROL(Plaintext ^ Key, n)"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Analyzing the next character (index 4): ",(0,i.jsx)(n.code,{children:"82"})," (",(0,i.jsx)(n.code,{children:"01010010"}),"), key 'M' (ASCII 77):","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["To find the plaintext: ",(0,i.jsx)(n.code,{children:"Plaintext = ROR(Cipher, n) ^ Key"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["If ",(0,i.jsx)(n.code,{children:"n"})," were fixed at 3, we wouldn't get a meaningful character."]}),"\n",(0,i.jsx)(n.li,{children:"For index 3, we used ROL by 3 bits. For indices 0, 1, 2 (Cipher = 0), ROL by any amount still yields 0."}),"\n",(0,i.jsxs)(n.li,{children:["Hypothesis: ",(0,i.jsx)(n.strong,{children:"The number of bits to rotate equals the character's index"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"With the algorithm deduced, we write a short decryption script:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Iterate through each byte of the ciphertext (call it ",(0,i.jsx)(n.code,{children:"c"}),") at position ",(0,i.jsx)(n.code,{children:"i"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Rotate the value ",(0,i.jsx)(n.code,{children:"c"})," right (ROR) by ",(0,i.jsx)(n.code,{children:"i"})," bits (for an 8-bit byte, we use ",(0,i.jsx)(n.code,{children:"i % 8"}),")."]}),"\n",(0,i.jsx)(n.li,{children:'XOR the result with the corresponding character from the key "HMV".'}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'def ror(val, r_bits, max_bits=8):\r\n  r_bits %= max_bits\r\n  return ((val >> r_bits) | (val << (max_bits - r_bits))) & ((1 << max_bits) - 1)\r\n\r\ncipher = [0, 0, 0, 153, 82, 76, 202, 3, 123, 126, 241, 17, 0, 12, 206, 189, 108, 86]\r\nkey_str = "HMV"\r\nkey = [ord(c) for c in key_str]\r\n\r\nflag = ""\r\n\r\nfor i, c in enumerate(cipher):\r\n  rotated_val = ror(c, i) # Rotate right by i bits\r\n  k = key[i % len(key)]\r\n  p = rotated_val ^ k\r\n  flag += chr(p)\r\n\r\nprint(f"Flag: {flag}")\n'})}),"\n",(0,i.jsx)(n.p,{children:"Running the script reveals the flag:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"> python script.py  \r\nFlag: HMV{h4cK-w1tH-m3!}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"HMV{h4cK-w1tH-m3!}"})}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>c});var t=r(96540);const i={},s=t.createContext(i);function l(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);