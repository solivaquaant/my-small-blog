"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[5459],{46662(e,t,i){i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"pico-ctf/web-exploitation/it-is-my-birthday/it-is-my-birthday","title":"It is my Birthday","description":"- Description: I sent out 2 invitations to all of my friends for my birthday!","source":"@site/docs/pico-ctf/web-exploitation/it-is-my-birthday/it-is-my-birthday.mdx","sourceDirName":"pico-ctf/web-exploitation/it-is-my-birthday","slug":"/pico-ctf/web-exploitation/it-is-my-birthday/","permalink":"/docs/pico-ctf/web-exploitation/it-is-my-birthday/","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Web","permalink":"/docs/tags/web","description":"Includes write-ups on the topic of Web"}],"version":"current","frontMatter":{"tags":["web"]},"sidebar":"writeupsSidebar","previous":{"title":"IntroToBurp","permalink":"/docs/pico-ctf/web-exploitation/introtroburp/"},"next":{"title":"JaWT Scratchpad","permalink":"/docs/pico-ctf/web-exploitation/jawt-scratchpad/"}}');var s=i(74848),o=i(28453);const a={tags:["web"]},r="It is my Birthday",l={},c=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"it-is-my-birthday",children:"It is my Birthday"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Description:"})," I sent out 2 invitations to all of my friends for my birthday!\r\nI'll know if they get stolen because the 2 invites look similar, and they even have the same md5 hash, but they are slightly different!\r\nYou wouldn't believe how long it took me to find a collision.\r\nAnyway, see if you're invited by submitting 2 PDFs to my website."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,s.jsxs)(t.p,{children:["From the challenge description, it is clear that this task revolves around an ",(0,s.jsx)(t.strong,{children:"MD5 hash collision"})," - a scenario where 2 different inputs produce the same MD5 hash value. A similar idea also appears in picoCTF with the challenge ",(0,s.jsx)(t.a,{href:"https://blog.solivaquaant.site/docs/pico-ctf/web-exploitation/apriti-sesamo/",children:(0,s.jsx)(t.strong,{children:"Apriti sesamo"})}),", which exploits a SHA-1 hash collision instead."]}),"\n",(0,s.jsxs)(t.p,{children:["In this case, I generated 2 different files that share the same MD5 hash using the ",(0,s.jsx)(t.a,{href:"https://github.com/upbit/clone-fastcoll",children:"fastcoll tool"}),".\r\nThe tool can be downloaded and built with the following commands:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"git clone https://github.com/upbit/clone-fastcoll fastcoll\r\ncd fastcoll\r\nmake\n"})}),"\n",(0,s.jsx)(t.p,{children:"After that, I generated 2 colliding files using:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"./fastcoll/fastcoll md5_data\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The output consists of 2 files, ",(0,s.jsx)(t.code,{children:"md5_data1"})," and ",(0,s.jsx)(t.code,{children:"md5_data2"}),".\r\nWhen checking their MD5 hashes, both files produce exactly the same hash value:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"> md5sum md5_data*\r\n6ce6291e2a8497d0b25b3c553f1f4444  md5_data1\r\n6ce6291e2a8497d0b25b3c553f1f4444  md5_data2\n"})}),"\n",(0,s.jsx)(t.p,{children:"However, comparing their contents shows that the 2 files are clearly different.\r\nThis confirms that they satisfy the condition of an MD5 hash collision:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"> diff md5_data1 md5_data2\r\n1,2c1,2\r\n< \ufffdY\ufffd9\ufffd1\ufffd\ufffd\ufffd\ufffdiBZ,\ufffdCI\ufffd/O\ufffd\ufffd\ufffd#)\ufffd\ufffd\ufffd\ufffdI\u0163\ufffd\ufffd     u9\ufffd\xea\ufffd\ufffd\ufffdXBGC\ufffdh\ufffdk\ufffd\ufffd\ufffdw\ufffd\r\n\ufffd\ufffdL\ufffdM\u03fd?\u2592\ufffdM^\ufffd*<\u0259\ufffdh\ufffd\ufffd|\ufffdn\ufffd\ufffd%\ufffd\u06a7^d\r\n\\ No newline at end of file\r\n---\r\n> \ufffdY\ufffd9\ufffd1\ufffd\ufffd\ufffd\ufffdiBZ,;CI\ufffd/O\ufffd\ufffd\ufffd#)\ufffd\ufffd\ufffd\ufffdI\u0163\ufffd\ufffd     u9\ufffdC\ufffd\ufffd\ufffd\ufffdXBGC\ufffdh\ufffd\ufffd\ufffd\ufffd\ufffdw\ufffd\r\n\ufffd\ufffdL\ufffdM\u03fd?\u2592\ufffdM^\ufffd*<\u0259\ufffd\ufffd\ufffd\ufffd|\ufffdn\ufffd\ufffd%\ufffdZ\ufffd^d\r\n\\ No newline at end of file\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Since the web application only accepts PDF uploads, I simply appended the ",(0,s.jsx)(t.code,{children:".pdf"})," extension to both files and uploaded them to the site.\r\nThis successfully triggered the vulnerability and returned the flag."]}),"\n",(0,s.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,s.jsx)("img",{src:i(12399).A,style:{width:"100%",height:"auto"}})}),"\n",(0,s.jsx)(t.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"picoCTF{c0ngr4ts_u_r_1nv1t3d_c63bbaf}"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},12399(e,t,i){i.d(t,{A:()=>n});const n=i.p+"assets/images/flag-4a5148218bc2fcc849eb9a198b33feff.png"},28453(e,t,i){i.d(t,{R:()=>a,x:()=>r});var n=i(96540);const s={},o=n.createContext(s);function a(e){const t=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);