"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[5203],{28453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>o});var i=t(96540);const r={},s=i.createContext(r);function l(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(s.Provider,{value:n},e.children)}},31132:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"pico-ctf/general-skills/serpentine","title":"Serpentine","description":"- Description: Find the flag in the Python script!","source":"@site/docs/pico-ctf/general-skills/serpentine.mdx","sourceDirName":"pico-ctf/general-skills","slug":"/pico-ctf/general-skills/serpentine","permalink":"/my-small-blog/docs/pico-ctf/general-skills/serpentine","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"tags":[]},"sidebar":"tutorialSidebar","previous":{"title":"Rust fixme 3","permalink":"/my-small-blog/docs/pico-ctf/general-skills/rust-fixme-3"},"next":{"title":"Static ain\'t always noise","permalink":"/my-small-blog/docs/pico-ctf/general-skills/static-aintalways-noise"}}');var r=t(74848),s=t(28453);const l={tags:[]},o="Serpentine",c={},a=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"serpentine",children:"Serpentine"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description:"})," Find the flag in the Python script!"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,r.jsx)(n.p,{children:"This challenge provides us with a Python source file."}),"\n",(0,r.jsxs)(n.p,{children:["When executed with the ",(0,r.jsx)(n.strong,{children:"b"})," option (intended to print the flag), the program reports that the ",(0,r.jsx)(n.code,{children:"print_flag"})," function has been misplaced."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"a) Print encouragement\r\nb) Print flag\r\nc) Quit\r\nWhat would you like to do? (a/b/c) b\r\n\r\nOops! I must have misplaced the print_flag function! Check my source code!\n"})}),"\n",(0,r.jsx)(n.p,{children:"Inspecting the source code, we find 2 key components defined at the beginning:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"str_xor"}),", a helper function performing an XOR operation."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def str_xor(secret, key):\r\n    #extend key to secret length\r\n    new_key = key\r\n    i = 0\r\n    while len(new_key) < len(secret):\r\n        new_key = new_key + key[i]\r\n        i = (i + 1) % len(key)        \r\n    return "".join([chr(ord(secret_c) ^ ord(new_key_c)) for (secret_c,new_key_c) in zip(secret,new_key)])\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"print_flag"}),", which is supposed to output the flag string."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def print_flag():\r\n  flag = str_xor(flag_enc, 'enkidu')\r\n  print(flag)\n"})}),"\n",(0,r.jsxs)(n.p,{children:["However, within the ",(0,r.jsx)(n.code,{children:"main"})," function, ",(0,r.jsx)(n.code,{children:"print_flag"})," is never actually invoked.\r\nThis means the solution is straightforward: we simply need to modify the code so that the function is called."]}),"\n",(0,r.jsxs)(n.p,{children:["The placement of the call doesn't matter - it could be before the ",(0,r.jsx)(n.code,{children:"while"})," loop or within 1 of the conditional branches.\r\nIn this case, I inserted the call under the ",(0,r.jsx)(n.strong,{children:"b) Print flag option."})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"elif choice == 'b':\r\n      print_flag()\n"})}),"\n",(0,r.jsx)(n.p,{children:"Running the program again after this adjustment successfully reveals the flag."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"What would you like to do? (a/b/c) b\r\npicoCTF{7h3_r04d_l355_7r4v3l3d_8e47d128}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"picoCTF{7h3_r04d_l355_7r4v3l3d_8e47d128}"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);