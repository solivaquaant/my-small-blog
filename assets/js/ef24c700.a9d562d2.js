"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[6362],{2155:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"pico-ctf/reverse-engineering/transformation","title":"Transformation","description":"- Description: I wonder what this really is...","source":"@site/docs/pico-ctf/reverse-engineering/transformation.mdx","sourceDirName":"pico-ctf/reverse-engineering","slug":"/pico-ctf/reverse-engineering/transformation","permalink":"/my-small-blog/docs/pico-ctf/reverse-engineering/transformation","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Reverse Engineer","permalink":"/my-small-blog/docs/tags/reverse-engineer","description":"Reverse engineering tag description"}],"version":"current","frontMatter":{"tags":["reverse-engineer"]},"sidebar":"tutorialSidebar","previous":{"title":"Flag Hunters","permalink":"/my-small-blog/docs/pico-ctf/reverse-engineering/flag-hunters"},"next":{"title":"vault-door-training","permalink":"/my-small-blog/docs/pico-ctf/reverse-engineering/vault-door-training"}}');var t=r(74848),o=r(28453);const s={tags:["reverse-engineer"]},c="Transformation",l={},a=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"transformation",children:"Transformation"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Description:"})," I wonder what this really is..."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Difficulty:"})," Easy"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,t.jsx)(n.p,{children:"The challenge provides an encoded file and a short snippet of Python code:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"''.join([chr((ord(flag[i]) << 8) + ord(flag[i + 1])) for i in range(0, len(flag), 2)])\n"})}),"\n",(0,t.jsx)(n.p,{children:"This code is used to encode the original flag using the following logic:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The input string flag is split into pairs of characters (2 characters at a time)."}),"\n",(0,t.jsxs)(n.li,{children:["For each pair ",(0,t.jsx)(n.code,{children:"flag[i]"})," and ",(0,t.jsx)(n.code,{children:"flag[i+1]"}),", the code:"]}),"\n",(0,t.jsxs)(n.li,{children:["Converts both characters to their ASCII values using ",(0,t.jsx)(n.code,{children:"ord()"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Shifts the first character's ASCII value 8 bits to the left (",(0,t.jsx)(n.code,{children:"ord(flag[i]) << 8"}),"), which is equivalent to multiplying it by 256."]}),"\n",(0,t.jsx)(n.li,{children:"Adds the second character's ASCII value to it."}),"\n",(0,t.jsxs)(n.li,{children:["The sum is passed to ",(0,t.jsx)(n.code,{children:"chr()"}),", converting it into a single Unicode character."]}),"\n",(0,t.jsx)(n.li,{children:"Finally, all Unicode characters are concatenated to form the encoded output."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Once the encoding logic is understood, decoding becomes a straightforward process - we simply reverse each step."}),"\n",(0,t.jsx)(n.p,{children:"Each character in the encoded string represents a pair of original characters. To decode:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Convert the character back to its code point using ord()."}),"\n",(0,t.jsx)(n.li,{children:"Extract the high byte by shifting right 8 bits (>> 8)."}),"\n",(0,t.jsx)(n.li,{children:"Extract the low byte using a bitwise AND with 0xFF."}),"\n",(0,t.jsx)(n.li,{children:"Convert both back to characters and concatenate."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Here's the Python script used for decryption:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"def decrypt(encoded_str):\r\n    decoded = ''\r\n    for c in encoded_str:\r\n        code_point = ord(c)\r\n        high = code_point >> 8\r\n        low = code_point & 0xFF\r\n        decoded += chr(high) + chr(low)\r\n    return decoded\r\n\r\nwith open('enc', 'r', encoding='utf-8') as f:\r\n    encoded_data = f.read().strip()\r\n\r\ndecoded_flag = decrypt(encoded_data)\r\nprint(decoded_flag)\n"})}),"\n",(0,t.jsx)(n.p,{children:"Running the script reveals the original flag."}),"\n",(0,t.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"picoCTF{16_bits_inst34d_of_8_e703b486}"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>c});var i=r(96540);const t={},o=i.createContext(t);function s(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);