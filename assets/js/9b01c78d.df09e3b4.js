"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[1145],{6023:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"root-me/forensic/command-and-control-level-3","title":"Command & Control - level 3","description":"- Description: Berthier, the antivirus software didn\'t find anything.","source":"@site/docs/root-me/forensic/command-and-control-level-3.mdx","sourceDirName":"root-me/forensic","slug":"/root-me/forensic/command-and-control-level-3","permalink":"/my-small-blog/docs/root-me/forensic/command-and-control-level-3","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"tags":[]},"sidebar":"tutorialSidebar","previous":{"title":"Command & Control - level 2","permalink":"/my-small-blog/docs/root-me/forensic/command-and-control-level-2"},"next":{"title":"Command & Control - level 4","permalink":"/my-small-blog/docs/root-me/forensic/command-and-control-level-4"}}');var t=o(4848),l=o(8453);const s={tags:[]},i="Command & Control - level 3",c={},a=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"command--control---level-3",children:"Command & Control - level 3"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Description:"})," Berthier, the antivirus software didn't find anything.\r\nIt's up to you now. Try to find the malware in the memory dump.\r\nThe validation flag is the md5 checksum of the full path of the executable."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,t.jsxs)(n.p,{children:["To identify potentially malicious processes, we first examined the system's process tree using ",(0,t.jsx)(n.code,{children:"pstree"}),".\r\nThis visualization helps reveal abnormal parent-child relationships between processes.\r\nNotably, we observed that the process ",(0,t.jsx)(n.code,{children:"iexplore.exe"})," (PID 2772) had spawned a child process: ",(0,t.jsx)(n.code,{children:"cmd.exe"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-js",children:"> ./vol2/volatility2 -f ch2.dmp --profile=Win7SP0x86 pstree    \r\n...\r\n0x87978b78:System                                      4      0    103   3257 2013-01-12 16:38:09 UTC+0000\r\n. 0x88c3ed40:smss.exe                                 308      4      2     29 2013-01-12 16:38:09 UTC+0000\r\n 0x87ac6030:explorer.exe                             2548   2484     24    766 2013-01-12 16:40:27 UTC+0000\r\n//highlight-start\r\n. 0x87b6b030:iexplore.exe                            2772   2548      2     74 2013-01-12 16:40:34 UTC+0000\r\n.. 0x89898030:cmd.exe                                1616   2772      2    101 2013-01-12 16:55:49 UTC+0000\r\n. 0x95495c18:taskmgr.exe                             1232   2548      6    116 2013-01-12 16:42:29 UTC+0000\r\n. 0x87bf7030:cmd.exe                                 3152   2548      1     23 2013-01-12 16:44:50 UTC+0000\r\n//highlight-end\r\n.. 0x87cbfd40:winpmem-1.3.1.                         3144   3152      1     23 2013-01-12 16:59:17 UTC+0000\r\n. 0x898fe8c0:StikyNot.exe                            2744   2548      8    135 2013-01-12 16:40:32 UTC+0000\r\n. 0x87b784b0:AvastUI.exe                             2720   2548     14    220 2013-01-12 16:40:31 UTC+0000\r\n. 0x87b82438:VMwareTray.exe                          2660   2548      5     80 2013-01-12 16:40:29 UTC+0000\r\n. 0x87c6a2a0:swriter.exe                             3452   2548      1     19 2013-01-12 16:41:01 UTC+0000\r\n.. 0x87ba4030:soffice.exe                            3512   3452      1     28 2013-01-12 16:41:03 UTC+0000\r\n... 0x87b8ca58:soffice.bin                           3564   3512     12    400 2013-01-12 16:41:05 UTC+0000                            3556   3544      0 ------ 2013-01-12 16:41:05 UTC+0000\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This behavior is suspicious - ",(0,t.jsx)(n.code,{children:"iexplore.exe"})," is a legitimate web browser, and it typically should not be launching command-line interfaces.\r\nSuch an anomaly strongly suggests this process may be involved in malicious activity."]}),"\n",(0,t.jsxs)(n.p,{children:["Next, we utilized the ",(0,t.jsx)(n.code,{children:"cmdline"})," plugin, which retrieves the full command-line arguments used to launch each process.\r\nThis allowed us to extract the complete file path associated with the suspicious process."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'> ./vol2/volatility2 -f ch2.dmp --profile=Win7SP0x86 cmdline -p 2772\r\nVolatility Foundation Volatility Framework 2.6\r\n************************************************************************\r\niexplore.exe pid:   2772\r\nCommand line : "C:\\Users\\John Doe\\AppData\\Roaming\\Microsoft\\Internet Explorer\\Quick Launch\\iexplore.exe" \n'})}),"\n",(0,t.jsxs)(n.p,{children:["Finally, we calculated the ",(0,t.jsx)(n.strong,{children:"MD5 hash"})," of the path and complete the challenge."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'> echo -n -E "C:\\Users\\John Doe\\AppData\\Roaming\\Microsoft\\Internet Explorer\\Quick Launch\\iexplore.exe" | md5sum \r\n49979149632639432397b3a1df8cb43d  -\n'})}),"\n",(0,t.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"49979149632639432397b3a1df8cb43d"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>s,x:()=>i});var r=o(6540);const t={},l=r.createContext(t);function s(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);