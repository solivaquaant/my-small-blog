"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[6530],{1137:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"pico-ctf/general-skills/pw-crack-3","title":"PW Crack 3","description":"- Description: Can you crack the password to get the flag?","source":"@site/docs/pico-ctf/general-skills/pw-crack-3.mdx","sourceDirName":"pico-ctf/general-skills","slug":"/pico-ctf/general-skills/pw-crack-3","permalink":"/my-small-blog/docs/pico-ctf/general-skills/pw-crack-3","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"tags":[]},"sidebar":"tutorialSidebar","previous":{"title":"PW Crack 2","permalink":"/my-small-blog/docs/pico-ctf/general-skills/pw-crack-2"},"next":{"title":"PW Crack 4","permalink":"/my-small-blog/docs/pico-ctf/general-skills/pw-crack-4"}}');var s=r(4848),c=r(8453);const o={tags:[]},a="PW Crack 3",i={},l=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"pw-crack-3",children:"PW Crack 3"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Description:"})," Can you crack the password to get the flag?\r\nDownload the password checker here and you'll need the encrypted flag and the hash in the same directory too.\r\nThere are 7 potential passwords with 1 being correct.\r\nYou can find these by examining the password checker script."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,s.jsxs)(n.p,{children:["By inspecting the source code of the password checker, we can see that this is a Python script designed to validate the correct password and decrypt the flag.\r\nThe flag is stored in an encrypted file (",(0,s.jsx)(n.code,{children:"level3.flag.txt.enc"}),") and will only be decrypted if the user enters the correct password, which matches the hash stored in ",(0,s.jsx)(n.code,{children:"level3.hash.bin"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["The script contains a function ",(0,s.jsx)(n.code,{children:"str_xor(secret, key)"})," that performs XOR encryption on a given string using a key.\r\n",(0,s.jsx)(n.strong,{children:"XOR"})," is a symmetric encryption method-meaning that applying the same operation with the same key twice will return the original data.\r\nThis makes it straightforward to decrypt the flag once the correct key (password) is found."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'def str_xor(secret, key):\r\n    #extend key to secret length\r\n    new_key = key\r\n    i = 0\r\n    while len(new_key) < len(secret):\r\n        new_key = new_key + key[i]\r\n        i = (i + 1) % len(key)        \r\n    return "".join([chr(ord(secret_c) ^ ord(new_key_c)) for (secret_c,new_key_c) in zip(secret,new_key)])\n'})}),"\n",(0,s.jsx)(n.p,{children:"The source code also conveniently provides a list of 7 possible passwords."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'pos_pw_list = ["8799", "d3ab", "1ea2", "acaf", "2295", "a9de", "6f3d"]\n'})}),"\n",(0,s.jsx)(n.p,{children:"With such a small set, we could try each password manually to find the correct one.\r\nHowever, to speed things up, we can write a simple brute-force script that tests each candidate against the stored hash to identify the valid password."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'for pw in pos_pw_list:\r\n    if hash_pw(pw) == correct_pw_hash:\r\n        print(f"Correct password: {pw}")\r\n        flag = str_xor(flag_enc.decode(), pw)\r\n        print(f"Flag: {flag}")\r\n        break\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Running the brute-force yields the correct password: ",(0,s.jsx)(n.strong,{children:"2295"}),", which successfully decrypts the file and reveals the flag."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"> python level3.py\r\nPlease enter correct password for flag: 2295\r\nWelcome back... your flag, user:\r\npicoCTF{m45h_fl1ng1ng_6f98a49f}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"picoCTF{m45h_fl1ng1ng_6f98a49f}"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var t=r(6540);const s={},c=t.createContext(s);function o(e){const n=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(c.Provider,{value:n},e.children)}}}]);