"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[8136],{28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>o});var i=n(96540);const s={},r=i.createContext(s);function a(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:t},e.children)}},48812:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>d});var i=n(59156),s=n(74848),r=n(28453);const a={authors:"tndt",tags:[],description:"A blog about Typed Paths registry in Windows.",date:new Date("2025-09-30T00:00:00.000Z")},o="A deep dive into Windows TypedPaths",l={authorsImageUrls:[void 0]},d=[{value:"What are Typed Paths &amp; why do they matter in DFIR?",id:"what-are-typed-paths--why-do-they-matter-in-dfir",level:2},{value:"Where are Typed Paths stored?",id:"where-are-typed-paths-stored",level:2},{value:"What data can you expect to find?",id:"what-data-can-you-expect-to-find",level:2},{value:"The value in DFIR &amp; threat hunting",id:"the-value-in-dfir--threat-hunting",level:2},{value:"How to collect Typed Paths",id:"how-to-collect-typed-paths",level:2},{value:"Live / On-system collection",id:"live--on-system-collection",level:3},{value:"Offline / image analysis",id:"offline--image-analysis",level:3},{value:"Limitations",id:"limitations",level:2},{value:"Conclusion",id:"conclusion",level:2}];function c(e){const t={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"What if the Windows Registry kept a memory of every path you typed into Explorer?\r\nTyped Paths do exactly that-making them a goldmine for investigators tracking attacker movements."}),"\n","\n",(0,s.jsx)(t.h2,{id:"what-are-typed-paths--why-do-they-matter-in-dfir",children:"What are Typed Paths & why do they matter in DFIR?"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Typed Paths"})," are a forensic artifact found deep within the Windows Registry.\r\nEssentially, they record the paths (file, folder, or even commands) that a user has typed or pasted into the ",(0,s.jsx)(t.strong,{children:"File Explorer"})," (or Windows Explorer) address bar.\r\nTheir primary function is to power the convenient auto-complete feature for subsequent inputs."]}),"\n",(0,s.jsx)(t.p,{children:"Examples of what's recorded:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"C:\\Windows\\System32"})}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"\\\\192.168.1.100\\share"})," (a network share)"]}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"cmd"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"powershell"})}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Think of it as the ",(0,s.jsx)(t.strong,{children:"Most Recently Used"})," (MRU) list for the Explorer's path bar."]}),"\n",(0,s.jsx)(t.p,{children:"While simple, this artifact provides a crucial window into user (or attacker) behavior, specifically what commands they executed or what resources they tried to access.\r\nIt can quickly expose the telltale signs of unusual activity:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Running specific malware executables or scripts."}),"\n",(0,s.jsx)(t.li,{children:"Accessing suspicious or external network shares (UNC paths)."}),"\n",(0,s.jsx)(t.li,{children:"Executing command-line tools like cmd, powershell, or mstsc directly from the path bar."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"where-are-typed-paths-stored",children:"Where are Typed Paths stored?"}),"\n",(0,s.jsxs)(t.p,{children:["Typed Paths are a ",(0,s.jsx)(t.strong,{children:"per-user"})," structure, meaning the data is located within that specific user's hive file (",(0,s.jsx)(t.code,{children:"NTUSER.DAT"}),")."]}),"\n",(0,s.jsx)(t.p,{children:"The Registry Key Location:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.code,{children:"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths"})}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["In a mounted offline hive, you'd find it under: ",(0,s.jsx)(t.code,{children:"HKEY_USERS\\<User-SID>\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths"})]}),"\n",(0,s.jsxs)(t.p,{children:["The sub-values are typically named ",(0,s.jsx)(t.code,{children:"url1"}),", ",(0,s.jsx)(t.code,{children:"url2"}),", ",(0,s.jsx)(t.code,{children:"url3"}),", and so on, with a data type of ",(0,s.jsx)(t.code,{children:"REG_SZ"})," (text string).\r\nCrucially, the newest path is almost always found in ",(0,s.jsx)(t.code,{children:"url1"}),'.\r\nWhen a new path is added, the older entries get "rolled down" to the next number.']}),"\n",(0,s.jsx)(t.h2,{id:"what-data-can-you-expect-to-find",children:"What data can you expect to find?"}),"\n",(0,s.jsx)(t.p,{children:"The paths stored in TypedPaths can take various forms, offering rich context:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Folder Paths: ",(0,s.jsx)(t.code,{children:"C:\\Users\\Alice\\Documents"})]}),"\n",(0,s.jsxs)(t.li,{children:["File/Executable Paths: ",(0,s.jsx)(t.code,{children:"C:\\Temp\\installer.exe"})]}),"\n",(0,s.jsxs)(t.li,{children:["UNC Network Paths: ",(0,s.jsx)(t.code,{children:"\\\\10.10.10.5\\share"})," or ",(0,s.jsx)(t.code,{children:"\\\\attacker-server\\payload"})]}),"\n",(0,s.jsxs)(t.li,{children:["Simple Commands: ",(0,s.jsx)(t.code,{children:"cmd"}),", ",(0,s.jsx)(t.code,{children:"powershell"}),", ",(0,s.jsx)(t.code,{children:"mstsc"})]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"URLs or other strings if an application or user inputs them into the address bar."}),"\n",(0,s.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,s.jsx)("img",{src:n(62763).A,style:{width:"100%",height:"auto"}})}),"\n",(0,s.jsx)(t.h2,{id:"the-value-in-dfir--threat-hunting",children:"The value in DFIR & threat hunting"}),"\n",(0,s.jsx)(t.p,{children:"Despite its simplicity, TypedPaths can reveal the exact strings or commands an account attempted to run or access.\r\nThis is incredibly valuable for:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Spotting suspicious behavior: Identifying specific actions like connecting to an unfamiliar IP via UNC path, directly invoking a payload, or running an unusual binary."}),"\n",(0,s.jsxs)(t.li,{children:["Verifying the threat actor's path: Confirming if the attacker used the Run dialog box or Explorer's address bar to launch tools like ",(0,s.jsx)(t.code,{children:"psexec"})," or ",(0,s.jsx)(t.code,{children:"powershell"}),"."]}),"\n",(0,s.jsx)(t.li,{children:"Detecting abnormal network access: Pinpointing attempts to access network resources that fall outside a user's normal scope of work."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Since this is a per-user artifact, it's excellent for isolating and differentiating the actions taken by various accounts on a compromised machine."}),"\n",(0,s.jsx)(t.h2,{id:"how-to-collect-typed-paths",children:"How to collect Typed Paths"}),"\n",(0,s.jsx)(t.p,{children:"You generally have 2 main contexts for collection:"}),"\n",(0,s.jsx)(t.h3,{id:"live--on-system-collection",children:"Live / On-system collection"}),"\n",(0,s.jsx)(t.p,{children:"This is useful for quick triage on a running system, but be mindful not to alter the registry state while analyzing."}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"PowerShell"}),":"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Basic command (read urlN values):"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'Get-ItemProperty -Path "HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths"\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Export to CSV (separating urlN into Key/Value columns) for storage or ingestion into an analysis pipeline:"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"Get-ItemProperty -Path \"HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths\" |\r\n    Select-Object -Property * |\r\n    ForEach-Object {\r\n        $props = $_.psobject.properties | Where-Object { $_.Name -match '^url' }\r\n        foreach ($p in $props) {\r\n            [PSCustomObject]@{ Key = $p.Name; Value = $p.Value }\r\n        }\r\n    } | Export-Csv -Path C:\\test.csv -NoTypeInformation -Encoding UTF8\n"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"reg.exe"}),": Export the key into a ",(0,s.jsx)(t.code,{children:".reg"})," file for backup/copy:"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'reg export "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TypedPaths" typedpaths.reg\n'})}),"\n",(0,s.jsx)(t.h3,{id:"offline--image-analysis",children:"Offline / image analysis"}),"\n",(0,s.jsx)(t.p,{children:"This is the safer, forensically sound method:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Load the Hive: You extract the ",(0,s.jsx)(t.code,{children:"NTUSER.DAT"})," file from the relevant user's profile on the disk image."]}),"\n",(0,s.jsx)(t.li,{children:"Analyze: Load this hive copy into a dedicated forensic tool (like Registry Explorer) for read-only analysis."}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"limitations",children:"Limitations"}),"\n",(0,s.jsx)(t.p,{children:'Typed Paths are a great indicator, but they are not a "smoking gun" on their own:'}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:'Commit Time: Entries are not always immediate. If the Explorer window hasn\'t been closed, the entry might not have been "committed" to the registry yet.'}),"\n",(0,s.jsx)(t.li,{children:"No Per-Entry Timestamp: This is the biggest drawback. TypedPaths does not store an individual timestamp for each urlN value."}),"\n",(0,s.jsxs)(t.li,{children:["The only timestamp available is the ",(0,s.jsx)(t.strong,{children:"LastWriteTime"})," of the parent TypedPaths key (the last time any entry was added or modified)."]}),"\n",(0,s.jsx)(t.li,{children:"Evasion: A user (or threat actor) can manually clear these registry values."}),"\n",(0,s.jsx)(t.li,{children:"Windows Versions: The behavior, size, and even the exact storage path can sometimes vary between Windows versions."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"You must correlate TypedPaths content with other artifacts-such as Prefetch, Shellbags, Event Logs, Amcache, UserAssist, or Sysmon-to accurately establish timelines and confidence levels."}),"\n",(0,s.jsx)(t.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,s.jsx)(t.p,{children:"Typed Paths isn't a silver bullet, but it is an invaluable, intuitive, and fast source of intelligence-especially during initial triage or when other logging sources are incomplete.\r\nWhen collected, validated, and correlated properly, Typed Paths can significantly shorten your investigation time and expose specific, high-value suspicious behaviors left behind by an attacker."})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},59156:e=>{e.exports=JSON.parse('{"permalink":"/blog/typed-paths","source":"@site/blog/typed-paths/index.mdx","title":"A deep dive into Windows TypedPaths","description":"A blog about Typed Paths registry in Windows.","date":"2025-09-30T00:00:00.000Z","tags":[],"readingTime":4.25,"hasTruncateMarker":true,"authors":[{"name":"Thai Trinh","title":"Cybersecurity Student @ UIT","url":"https://github.com/solivaquaant","page":{"permalink":"/blog/authors/tndt"},"imageURL":"/img/avt-trans.png","key":"tndt"}],"frontMatter":{"authors":"tndt","tags":[],"description":"A blog about Typed Paths registry in Windows.","date":"2025-09-30T00:00:00.000Z"},"unlisted":false,"prevItem":{"title":"A few handy tips for downloading videos with yt-dlp","permalink":"/blog/yt-dlp"},"nextItem":{"title":"Exploring DLL Side Loading: A practical walkthrough using Notepad++","permalink":"/blog/dll-side-loading-notepadpp"}}')},62763:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/registry-ex-1fa1df6433e085946353e60e051da2b3.png"}}]);