"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[8271],{19486:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/epoch-6903cf74175526fd4bbb7dc25db5edee.png"},20721:(e,t,i)=>{i.d(t,{A:()=>s});const s=i.p+"assets/images/hxd-a5c4be13255b0e3c89d54b3fc3a1da74.png"},28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>o});var s=i(96540);const n={},a=s.createContext(n);function r(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),s.createElement(a.Provider,{value:t},e.children)}},77725:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"pico-ctf/forensics/blast-from-the-past/blast-from-the-past","title":"Blast from the past","description":"- Description: The judge for these pictures is a real fan of antiques.","source":"@site/docs/pico-ctf/forensics/blast-from-the-past/blast-from-the-past.mdx","sourceDirName":"pico-ctf/forensics/blast-from-the-past","slug":"/pico-ctf/forensics/blast-from-the-past/","permalink":"/my-small-blog/docs/pico-ctf/forensics/blast-from-the-past/","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Forensics","permalink":"/my-small-blog/docs/tags/forensics","description":"Forensics tag description"}],"version":"current","frontMatter":{"tags":["forensics"]},"sidebar":"tutorialSidebar","previous":{"title":"Bitlocker-2","permalink":"/my-small-blog/docs/pico-ctf/forensics/bitlocker-2"},"next":{"title":"CanYouSee","permalink":"/my-small-blog/docs/pico-ctf/forensics/canyousee"}}');var n=i(74848),a=i(28453);const r={tags:["forensics"]},o="Blast from the past",l={},c=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"blast-from-the-past",children:"Blast from the past"})}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Description:"})," The judge for these pictures is a real fan of antiques.\r\nCan you age this photo to the specifications?\r\nSet the timestamps on this picture to 1970:01:01 00:00:00.001+00:00 with as much precision as possible for each timestamp.\r\nIn this example, +00:00 is a timezone adjustment. Any timezone is acceptable as long as the time is equivalent.\r\nAs an example, this timestamp is acceptable as well: 1969:12:31 19:00:00.001-05:00.\r\nFor timestamps without a timezone adjustment, put them in GMT time (+00:00).\r\nThe checker program provides the timestamp needed for each."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,n.jsxs)(t.p,{children:["The challenge provides us with an image file and asks us to modify all of its timestamps to ",(0,n.jsx)(t.code,{children:"1970:01:01 00:00:00.001+00:00"})," with maximum possible precision for each timestamp."]}),"\n",(0,n.jsx)(t.p,{children:"Inspecting the image's metadata reveals 7 different time-related fields that need to be changed."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"> exiftool original.jpg                                       \r\nFile Name                       : original.jpg\r\nModify Date                     : 2023:11:20 15:46:23\r\nDate/Time Original              : 2023:11:20 15:46:23\r\nCreate Date                     : 2023:11:20 15:46:23\r\nTime Stamp                      : 2023:11:20 15:46:21.420-05:00\r\nCreate Date                     : 2023:11:20 15:46:23.703\r\nDate/Time Original              : 2023:11:20 15:46:23.703\r\nModify Date                     : 2023:11:20 15:46:23.703\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Using ",(0,n.jsx)(t.code,{children:"exiftool"})," with the ",(0,n.jsx)(t.code,{children:"-AllDates"})," parameter, we can quickly reset most of these timestamps to the desired value."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:'> exiftool -AllDates="1970:01:01 00:00:00.001" \\\r\n-SubSecCreateDate="1970:01:01 00:00:00.001" \\\r\n-SubSecDateTimeOriginal="1970:01:01 00:00:00.001" \\\r\n-SubSecModifyDate="1970:01:01 00:00:00.001" original.jpg\r\n    1 image files updated\n'})}),"\n",(0,n.jsxs)(t.p,{children:["However, upon reviewing the metadata, the ",(0,n.jsx)(t.strong,{children:"Samsung:TimeStamp"})," field still retains its original value."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"Time Stamp                      : 2023:11:20 15:46:21.420-05:00\n"})}),"\n",(0,n.jsxs)(t.p,{children:["Submitting the file in this state results in an error indicating that ",(0,n.jsx)(t.strong,{children:"Samsung:TimeStamp"})," has not been updated."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"Checking tag 7/7\r\nTimezones do not have to match, as long as it's the equivalent time.\r\nLooking at Samsung: TimeStamp\r\nLooking for '1970:01:01 00:00:00.001+00:00'\r\nFound: 2023:11:20 20:46:21.420+00:00\r\nOops! That tag isn't right. Please try again.\n"})}),"\n",(0,n.jsxs)(t.p,{children:["This particular tag cannot be modified directly via ",(0,n.jsx)(t.code,{children:"exiftool"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["According to ",(0,n.jsx)(t.a,{href:"https://stackoverflow.com/questions/78185037/how-to-edit-the-samsung-trailer-tag-timestamp",children:"documentation"}),", the ",(0,n.jsx)(t.strong,{children:"TimeStamp"})," tag is located 13 bytes after the first 14 bytes of ",(0,n.jsx)(t.code,{children:"[Image_UTC_Data]"}),".\r\nInitially, the file's timestamp value was ",(0,n.jsx)(t.code,{children:"1700513181420"}),", stored in Unix epoch format."]}),"\n",(0,n.jsx)("div",{style:{width:"70%",margin:"0 auto"},children:(0,n.jsx)("img",{src:i(19486).A,style:{width:"100%",height:"auto"}})}),"\n",(0,n.jsxs)(t.p,{children:["By manually changing this value to ",(0,n.jsx)(t.code,{children:"0000000000001"}),", the corresponding metadata field updates to reflect the target time."]}),"\n",(0,n.jsx)("div",{style:{width:"70%",margin:"0 auto"},children:(0,n.jsx)("img",{src:i(20721).A,style:{width:"100%",height:"auto"}})}),"\n",(0,n.jsx)(t.p,{children:"Finally, after resubmitting the modified image and running the verification program, the solution is accepted and the flag is obtained."}),"\n",(0,n.jsx)(t.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"picoCTF{71m3_7r4v311ng_p1c7ur3_83ecb41c}"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}}}]);