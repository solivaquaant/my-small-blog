"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[2709],{4312:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"pico-ctf/web-exploitation/SOAP/soap","title":"SOAP","description":"- Description: The web project was rushed and no security assessment was done. Can you read the /etc/passwd file?","source":"@site/docs/pico-ctf/web-exploitation/SOAP/soap.mdx","sourceDirName":"pico-ctf/web-exploitation/SOAP","slug":"/pico-ctf/web-exploitation/SOAP/","permalink":"/my-small-blog/docs/pico-ctf/web-exploitation/SOAP/","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Web","permalink":"/my-small-blog/docs/tags/web","description":"Web tag description"}],"version":"current","frontMatter":{"tags":["web"]},"sidebar":"tutorialSidebar","previous":{"title":"Web Exploitation","permalink":"/my-small-blog/docs/category/web-exploitation"},"next":{"title":"Apriti sesamo","permalink":"/my-small-blog/docs/pico-ctf/web-exploitation/apriti-sesamo"}}');var i=t(4848),o=t(8453);const r={tags:["web"]},a="SOAP",c={},l=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"soap",children:"SOAP"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," The web project was rushed and no security assessment was done. Can you read the ",(0,i.jsx)(n.code,{children:"/etc/passwd"})," file?"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,i.jsxs)(n.p,{children:["Upon accessing the website, we're presented with several categories.\r\nClicking the ",(0,i.jsx)(n.strong,{children:"Details"})," button for each item triggers a POST request, which can be observed using Burp Suite.\r\nNotably, the request body is formatted in XML."]}),"\n",(0,i.jsx)("div",{style:{width:"50%",margin:"0 auto"},children:(0,i.jsx)("img",{src:t(8188).A,style:{width:"100%",height:"auto"}})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"XML (eXtensible Markup Language)"})," is commonly used for data exchange between a client and server.\r\nHowever, XML parsing can introduce vulnerabilities if not properly handled-one of the most well-known being ",(0,i.jsx)(n.strong,{children:"XML External Entity (XXE)"})," injection."]}),"\n",(0,i.jsx)(n.p,{children:"XXE is a type of attack that takes advantage of improperly configured XML parsers.\r\nIt allows attackers to inject external entities into an XML payload.\r\nIf successful, this can lead to unauthorized file access, denial of service, or even remote code execution in some cases."}),"\n",(0,i.jsx)(n.p,{children:"In this scenario, we modify the original XML payload to the following:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'<?xml version="1.0" encoding="UTF-8"?>\r\n<!DOCTYPE foo [\r\n<!ENTITY xxe SYSTEM "file:///etc/passwd">\r\n]>\r\n<data><ID>&xxe;</ID></data>\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"<!DOCTYPE foo [...]>"})," defines a DTD (Document Type Definition) section, which allows the declaration of custom entities."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'<!ENTITY xxe SYSTEM "file:///etc/passwd">'})," defines an entity named xxe that references the contents of the ",(0,i.jsx)(n.code,{children:"/etc/passwd"})," file."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"&xxe;"})," is used in the XML body to trigger the entity resolution when the server processes the XML."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["By resending the modified request, the server processes the malicious XML and returns the contents of the ",(0,i.jsx)(n.code,{children:"/etc/passwd"})," file.\r\nThis confirms the presence of an XXE vulnerability and also reveals the flag embedded in the file."]}),"\n",(0,i.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,i.jsx)("img",{src:t(6481).A,style:{width:"100%",height:"auto"}})}),"\n",(0,i.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"picoCTF{XML_3xtern@l_3nt1t1ty_0dcf926e}"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},6481:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/flag-d6af29c299ad4474ac2964efdbb48e9d.png"},8188:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/xml-7e2262e426d87c5e7da3544f5ffc873e.png"},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var s=t(6540);const i={},o=s.createContext(i);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);