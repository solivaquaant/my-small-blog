"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[5569],{13985(e,t,s){s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>o,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"root-me/realist/the-hckers-l4b/the-hckers-l4b","title":"The h@ckers l4b","description":"- Description: An intelligence agency got in touch with us.","source":"@site/docs/root-me/realist/the-hckers-l4b/the-hckers-l4b.mdx","sourceDirName":"root-me/realist/the-hckers-l4b","slug":"/root-me/realist/the-hckers-l4b/","permalink":"/docs/root-me/realist/the-hckers-l4b/","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Web","permalink":"/docs/tags/web","description":"Includes write-ups on the topic of Web"}],"version":"current","frontMatter":{"tags":["web"]},"sidebar":"writeupsSidebar","previous":{"title":"It happens, sometimes","permalink":"/docs/root-me/realist/it-happens-sometimes/"},"next":{"title":"Steganography","permalink":"/docs/category/steganography"}}');var i=s(74848),r=s(28453);const o={tags:["web"]},a="The h@ckers l4b",c={},d=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function h(e){const t={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"the-hckers-l4b",children:"The h@ckers l4b"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Description:"})," An intelligence agency got in touch with us.\r\nIt seems like a group of hackers are hosting their most valuable tools and exploits online.\r\nIt also appears that they have have a bunch of very interesting ones, we need to steal them."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,i.jsx)(t.hr,{}),"\n",(0,i.jsx)(t.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,i.jsx)(t.p,{children:"After accessing the website, the interface looks like this:"}),"\n",(0,i.jsx)("div",{style:{width:"70%",margin:"0 auto"},children:(0,i.jsx)("img",{src:s(40418).A,style:{width:"100%",height:"auto"}})}),"\n",(0,i.jsxs)(t.p,{children:["I selected ",(0,i.jsx)(t.strong,{children:'"Pas encore inscrit ?"'})," to create a new account and logged in using my freshly created one. In my case, the username is ",(0,i.jsx)(t.code,{children:"tndt"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["On the right side of the UI, there are several navigation options like ",(0,i.jsx)(t.em,{children:"accueil"}),", ",(0,i.jsx)(t.em,{children:"news"}),", etc.\r\nThe ",(0,i.jsx)(t.code,{children:"membre"})," section shows the active session status of 2 accounts: ",(0,i.jsx)(t.code,{children:"administrateur"})," and ",(0,i.jsx)(t.code,{children:"tndt"}),", both marked as ",(0,i.jsx)(t.strong,{children:"online"}),"."]}),"\n",(0,i.jsx)("div",{style:{width:"70%",margin:"0 auto"},children:(0,i.jsx)("img",{src:s(73710).A,style:{width:"100%",height:"auto"}})}),"\n",(0,i.jsxs)(t.p,{children:["When opening the ",(0,i.jsx)(t.code,{children:"contact"})," section, it displays the message prompt ",(0,i.jsx)(t.strong,{children:'"Envoyer un message \xe0 administrateur"'}),", meaning ",(0,i.jsx)(t.em,{children:'"Send a message to the administrator"'}),".\r\nThis raises an interesting question - could this feature be exploited to access the administrator account?"]}),"\n",(0,i.jsx)("div",{style:{width:"70%",margin:"0 auto"},children:(0,i.jsx)("img",{src:s(10016).A,style:{width:"100%",height:"auto"}})}),"\n",(0,i.jsxs)(t.p,{children:["To investigate further, I ran a directory scan using ",(0,i.jsx)(t.code,{children:"feroxbuster"})," to see if there were hidden or interesting paths available:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:'feroxbuster -q -u "http://challenge01.root-me.org/realiste/ch7/" -w /usr/share/seclists/Discovery/Web-Content/raft-large-directories.txt -x php,txt,html,zip,db,bak,js -t 64\n'})}),"\n",(0,i.jsxs)(t.p,{children:["One of the discovered paths was ",(0,i.jsx)(t.code,{children:"/log/log.php"}),", which required authentication via a username and password."]}),"\n",(0,i.jsx)("div",{style:{width:"70%",margin:"0 auto"},children:(0,i.jsx)("img",{src:s(48822).A,style:{width:"100%",height:"auto"}})}),"\n",(0,i.jsxs)(t.p,{children:["Capturing this request using Burp Suite revealed a ",(0,i.jsx)(t.strong,{children:"401 Unauthorized"})," response.\r\nBased on information from ",(0,i.jsx)(t.a,{href:"https://blog.vidocsecurity.com/blog/401-and-403-bypass-how-to-do-it-right",children:"this"}),", one possible bypass method for this error is changing the HTTP request method.\r\nAfter switching from ",(0,i.jsx)(t.strong,{children:"GET"})," to ",(0,i.jsx)(t.strong,{children:"PUT"})," and resending the request, the server responded with a full list of usernames and passwords - including the credentials for ",(0,i.jsx)(t.code,{children:"administrateur"}),"."]}),"\n",(0,i.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,i.jsx)("img",{src:s(99471).A,style:{width:"100%",height:"auto"}})}),"\n",(0,i.jsxs)(t.p,{children:["However, attempting to log in using ",(0,i.jsx)(t.code,{children:"administrateur:4Dm1N_de_site"})," resulted in the message: ",(0,i.jsx)(t.strong,{children:'"Erreur : user already logged in !"'}),".\r\nThe ",(0,i.jsx)(t.code,{children:"membre"})," section confirmed that the account was still active, preventing another login session."]}),"\n",(0,i.jsxs)(t.p,{children:["At this point, the goal was to force the administrator account offline - and the ",(0,i.jsx)(t.code,{children:"contact"})," feature seemed like the best way to do it.\r\nThe page indicated that only the following BBCode tags were allowed:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"[b] [u] [i] [s] [img]\n"})}),"\n",(0,i.jsxs)(t.p,{children:["Sending a message like ",(0,i.jsx)(t.code,{children:"[b]Bonjour[/b]"})," confirmed the message formatting behavior."]}),"\n",(0,i.jsx)("div",{style:{width:"70%",margin:"0 auto"},children:(0,i.jsx)("img",{src:s(69238).A,style:{width:"100%",height:"auto"}})}),"\n",(0,i.jsx)(t.p,{children:"To disconnect the admin, I needed to replicate the same request the platform performs when a user logs out.\r\nFor normal users, logout triggers a request to:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"/realiste/ch7/hackers.php?page=deconnect\n"})}),"\n",(0,i.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,i.jsx)("img",{src:s(27684).A,style:{width:"100%",height:"auto"}})}),"\n",(0,i.jsxs)(t.p,{children:["Since the ",(0,i.jsx)(t.code,{children:"[img]"})," tag forces the server to fetch an external resource, I crafted the message payload so the admin's browser would unknowingly send the logout request on page load:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"[img]http://challenge01.root-me.org/realiste/ch7/hackers.php?page=deconnect[/img]\n"})}),"\n",(0,i.jsxs)(t.p,{children:["After submitting the payload and returning to the ",(0,i.jsx)(t.code,{children:"membre"})," section, the administrator status changed to offline - success."]}),"\n",(0,i.jsx)("div",{style:{width:"70%",margin:"0 auto"},children:(0,i.jsx)("img",{src:s(6929).A,style:{width:"100%",height:"auto"}})}),"\n",(0,i.jsxs)(t.p,{children:["Finally, using the credentials ",(0,i.jsx)(t.code,{children:"administrateur:4Dm1N_de_site"}),", I logged in, navigated to the ",(0,i.jsx)(t.code,{children:"exploit"})," section, and retrieved the flag."]}),"\n",(0,i.jsx)("div",{style:{width:"70%",margin:"0 auto"},children:(0,i.jsx)("img",{src:s(33224).A,style:{width:"100%",height:"auto"}})}),"\n",(0,i.jsx)(t.p,{children:"Mission accomplished."}),"\n",(0,i.jsx)(t.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.code,{children:"Ho5M6UPkLJMncnW"})}),"\n"]})]})}function l(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},69238(e,t,s){s.d(t,{A:()=>n});const n=s.p+"assets/images/bb-b007c27c74c41e3355f4c5502847b113.png"},10016(e,t,s){s.d(t,{A:()=>n});const n=s.p+"assets/images/contact-166d770bd30ab431e58aeba89a5ede58.png"},40418(e,t,s){s.d(t,{A:()=>n});const n=s.p+"assets/images/dash-bbeabaf10ee5de206885a340d42e8f46.png"},27684(e,t,s){s.d(t,{A:()=>n});const n=s.p+"assets/images/disconnect-6b903af59e7108c09481f7e0dc78c3c9.png"},33224(e,t,s){s.d(t,{A:()=>n});const n=s.p+"assets/images/flag-b93ccd6a1524ac44062055dee46c8448.png"},48822(e,t,s){s.d(t,{A:()=>n});const n=s.p+"assets/images/log-212ba3ad7da2c6b4fde4511a00fd15d6.png"},73710(e,t,s){s.d(t,{A:()=>n});const n=s.p+"assets/images/membre-b48e9d4d2bb80416f07e37eb2beed813.png"},6929(e,t,s){s.d(t,{A:()=>n});const n=s.p+"assets/images/offline-a85142a26e79832f8ecf068016193e76.png"},99471(e,t,s){s.d(t,{A:()=>n});const n=s.p+"assets/images/put-261f3f8250d1697a57c756d546362696.png"},28453(e,t,s){s.d(t,{R:()=>o,x:()=>a});var n=s(96540);const i={},r=n.createContext(i);function o(e){const t=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);