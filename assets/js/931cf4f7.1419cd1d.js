"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[8812],{28453:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>a});var i=n(96540);const s={},r=i.createContext(s);function c(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(r.Provider,{value:t},e.children)}},30740:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/flag-003f661c97cacfa95f45b6cdc999bff9.png"},36056:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"pico-ctf/web-exploitation/jawt-scratchpad/jawt-scratchpad","title":"JaWT Scratchpad","description":"- Description: Check the admin scratchpad","source":"@site/docs/pico-ctf/web-exploitation/jawt-scratchpad/jawt-scratchpad.mdx","sourceDirName":"pico-ctf/web-exploitation/jawt-scratchpad","slug":"/pico-ctf/web-exploitation/jawt-scratchpad/","permalink":"/my-small-blog/docs/pico-ctf/web-exploitation/jawt-scratchpad/","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Web","permalink":"/my-small-blog/docs/tags/web","description":"Includes write-ups on the topic of Web"}],"version":"current","frontMatter":{"tags":["web"]},"sidebar":"writeupsSidebar","previous":{"title":"IntroToBurp","permalink":"/my-small-blog/docs/pico-ctf/web-exploitation/introtroburp/"},"next":{"title":"Local Authority","permalink":"/my-small-blog/docs/pico-ctf/web-exploitation/local-authority"}}');var s=n(74848),r=n(28453);const c={tags:["web"]},a="JaWT Scratchpad",o={},l=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"jawt-scratchpad",children:"JaWT Scratchpad"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Description:"})," Check the admin scratchpad"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,s.jsxs)(t.p,{children:["The page loads as a simple JWT scratchpad.\r\nAfter registering with any username (except ",(0,s.jsx)(t.code,{children:"admin"}),"), every subsequent request includes a JWT token.\r\nAt this point, it becomes clear that authentication relies on the token itself rather than server-side sessions."]}),"\n",(0,s.jsx)("div",{style:{width:"70%",margin:"0 auto"},children:(0,s.jsx)("img",{src:n(81166).A,style:{width:"100%",height:"auto"}})}),"\n",(0,s.jsxs)(t.p,{children:["Checking the JWT format reveals that it's using the ",(0,s.jsx)(t.strong,{children:"HS256"})," algorithm.\r\nAfter saving the token and testing it on ",(0,s.jsx)(t.a,{href:"https://jwt.io/",children:"JWT Debugger"}),", the algorithm value is confirmed."]}),"\n",(0,s.jsxs)(t.p,{children:["Because HS256 relies on a shared secret, the next step is to brute-force the signing key.\r\nUsing ",(0,s.jsx)(t.a,{href:"https://github.com/lmammino/jwt-cracker",children:"jwt-cracker"})," with the ",(0,s.jsx)(t.code,{children:"rockyou.txt"})," wordlist reveals the correct secret key:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"> jwt-cracker jwt-cracker -t eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoidG5kdCJ9.w4-uwZtdEG3W0-W68WAmFLUNniSc3Lk46cJHNT-a0aU -d rockyou.txt\r\n...\r\nSECRET FOUND: ilovepico\r\nTime taken (sec): 32.059\r\nTotal attempts: 7440000\n"})}),"\n",(0,s.jsxs)(t.p,{children:["With the key obtained, a new forged token can be generated using ",(0,s.jsx)(t.a,{href:"https://jwt.io/",children:"JWT Debugger"}),"."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Header:"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'{\r\n  "typ": "JWT",\r\n  "alg": "HS256"\r\n}\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Payload:"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:'{\r\n  "user": "admin"\r\n}\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Signing key:"}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"ilovepico\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The final step is modifying a valid request.\r\nSending the request to ",(0,s.jsx)(t.strong,{children:"Burp Suite Repeater"})," and replacing the existing JWT with the forged admin token grants access, confirming that the system trusts tokens purely based on signature validity rather than additional authorization checks."]}),"\n",(0,s.jsx)("div",{style:{width:"80%",margin:"0 auto"},children:(0,s.jsx)("img",{src:n(30740).A,style:{width:"100%",height:"auto"}})}),"\n",(0,s.jsx)(t.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"picoCTF{jawt_was_just_what_you_thought_bbb82bd4a57564aefb32d69dafb60583}"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},81166:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/dash-48aebc2ddcd38f5bde6d81c207de0ff4.png"}}]);