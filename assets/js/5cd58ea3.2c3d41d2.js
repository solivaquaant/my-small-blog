"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[1199],{28453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>l});var t=i(96540);const s={},r=t.createContext(s);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(r.Provider,{value:n},e.children)}},82497:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"pico-ctf/forensics/sleuthkit-apprentice","title":"Sleuthkit Apprentice","description":"- Description: Download this disk image and find the flag.","source":"@site/docs/pico-ctf/forensics/sleuthkit-apprentice.mdx","sourceDirName":"pico-ctf/forensics","slug":"/pico-ctf/forensics/sleuthkit-apprentice","permalink":"/my-small-blog/docs/pico-ctf/forensics/sleuthkit-apprentice","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Forensics","permalink":"/my-small-blog/docs/tags/forensics","description":"Includes write-ups on the topic of Forensics"},{"inline":false,"label":"Linux","permalink":"/my-small-blog/docs/tags/linux","description":"Includes write-ups on the topic of Linux"}],"version":"current","frontMatter":{"tags":["forensics","linux"]},"sidebar":"writeupsSidebar","previous":{"title":"shark on wire 1","permalink":"/my-small-blog/docs/pico-ctf/forensics/shark-on-wire-1/"},"next":{"title":"Sleuthkit Intro","permalink":"/my-small-blog/docs/pico-ctf/forensics/sleuthkit-intro"}}');var s=i(74848),r=i(28453);const o={tags:["forensics","linux"]},l="Sleuthkit Apprentice",c={},a=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"sleuthkit-apprentice",children:"Sleuthkit Apprentice"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Description:"})," Download this disk image and find the flag."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,s.jsxs)(n.p,{children:["With the provided disk image, we can begin by analyzing its partition structure using ",(0,s.jsx)(n.code,{children:"mmls"}),".\r\nThis reveals 3 main partitions:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"First Linux partition (0x83): Start sector 2048"}),"\n",(0,s.jsx)(n.li,{children:"Linux Swap / Solaris partition (0x82): Start sector 206848"}),"\n",(0,s.jsx)(n.li,{children:"Second Linux partition (0x83): Start sector 360448"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"> mmls disk.flag.img \r\nDOS Partition Table\r\nOffset Sector: 0\r\nUnits are in 512-byte sectors\r\n\r\n      Slot      Start        End          Length       Description\r\n000:  Meta      0000000000   0000000000   0000000001   Primary Table (#0)\r\n001:  -------   0000000000   0000002047   0000002048   Unallocated\r\n002:  000:000   0000002048   0000206847   0000204800   Linux (0x83)\r\n003:  000:001   0000206848   0000360447   0000153600   Linux Swap / Solaris x86 (0x82)\r\n004:  000:002   0000360448   0000614399   0000253952   Linux (0x83)\n"})}),"\n",(0,s.jsx)(n.p,{children:"To proceed with exploitation, I mounted each partition individually.\r\nUpon mounting the second Linux partition, I was able to access useful data:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo mkdir /mnt/disk2\r\nsudo mount -o ro,loop,offset=$((360448*512)) disk.flag.img /mnt/disk2\r\nls /mnt/disk2\n"})}),"\n",(0,s.jsxs)(n.p,{children:["After mounting, I searched recursively for any file named ",(0,s.jsx)(n.code,{children:"flag"})," within the partition.\r\nThis led to the discovery of a file named ",(0,s.jsx)(n.code,{children:"flag.uni.txt"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'> sudo find /mnt/disk2 -type f -name "*flag*"\r\n/mnt/disk2/root/my_folder/flag.uni.txt\n'})}),"\n",(0,s.jsx)(n.p,{children:"Viewing the contents of this file revealed the flag."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"> sudo cat /mnt/disk2/root/my_folder/flag.uni.txt\r\npicoCTF{by73_5urf3r_3497ae6b}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"picoCTF{by73_5urf3r_3497ae6b}"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);