"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[898],{6578:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"pico-ctf/forensics/ph4nt0m-1ntrud3r/ph4nt0m-1ntrud3r","title":"Ph4nt0m 1ntrud3r","description":"- Description: A digital ghost has breached my defenses, and my sensitive data has been stolen! \ud83d\ude31\ud83d\udcbb Your mission is to uncover how this phantom intruder infiltrated my system and retrieve the hidden flag.","source":"@site/docs/pico-ctf/forensics/ph4nt0m-1ntrud3r/ph4nt0m-1ntrud3r.mdx","sourceDirName":"pico-ctf/forensics/ph4nt0m-1ntrud3r","slug":"/pico-ctf/forensics/ph4nt0m-1ntrud3r/","permalink":"/my-small-blog/docs/pico-ctf/forensics/ph4nt0m-1ntrud3r/","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Network","permalink":"/my-small-blog/docs/tags/network","description":"Network tag description"}],"version":"current","frontMatter":{"tags":["network"]},"sidebar":"tutorialSidebar","previous":{"title":"PcapPoisoning","permalink":"/my-small-blog/docs/pico-ctf/forensics/pcap-poisoning/"},"next":{"title":"RED","permalink":"/my-small-blog/docs/pico-ctf/forensics/red"}}');var s=t(4848),o=t(8453);const a={tags:["network"]},i="Ph4nt0m 1ntrud3r",d={},c=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function l(e){const n={blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"ph4nt0m-1ntrud3r",children:"Ph4nt0m 1ntrud3r"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Description:"})," A digital ghost has breached my defenses, and my sensitive data has been stolen! \ud83d\ude31\ud83d\udcbb Your mission is to uncover how this phantom intruder infiltrated my system and retrieve the hidden flag.\r\nTo solve this challenge, you'll need to analyze the provided PCAP file and track down the attack method. The attacker has cleverly concealed his moves in well timely manner. Dive into the network traffic, apply the right filters and show off your forensic prowess and unmask the digital intruder!"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Difficulty:"})," Easy"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,s.jsxs)(n.p,{children:["Upon examining the pcap file, we observed that all packets use the ",(0,s.jsx)(n.strong,{children:"TCP"})," protocol and contain 3 distinct payload lengths: 4, 8, and 12 bytes.",(0,s.jsx)(n.br,{}),"\n","Looking at the first packet, we found a base64-encoded string in the TCP payload: ",(0,s.jsx)(n.code,{children:"ezF0X3c0cw=="}),". Decoding this yields ",(0,s.jsx)(n.code,{children:"{1t_w4s"}),", which appears to be part of a flag."]}),"\n",(0,s.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,s.jsx)("img",{src:t(9583).A,style:{width:"100%",height:"auto"}})}),"\n",(0,s.jsx)(n.p,{children:"To extract the remaining parts, we wrote a Python script to parse the pcap file and retrieve the TCP payloads of all packets with a length of 4, 8 and 12 bytes.\r\nThese payloads were then base64-decoded."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from scapy.all import rdpcap, TCP\r\nimport base64\r\n\r\npackets = rdpcap("myNetworkTraffic.pcap")\r\ndecoded_payloads = []\r\nvalid_lengths = [4, 8, 12]\r\n\r\nfor pkt in packets:\r\n    if pkt.haslayer(TCP):\r\n        tcp_layer = pkt[TCP]\r\n        raw_payload = bytes(tcp_layer.payload)\r\n        if len(raw_payload) in valid_lengths:\r\n            try:\r\n                decoded = base64.b64decode(raw_payload).decode(\'utf-8\')\r\n                decoded_payloads.append(decoded)\r\n                print(decoded) \r\n            except Exception as e:\r\n                print("")\n'})}),"\n",(0,s.jsx)(n.p,{children:"After concatenating the decoded strings, we successfully reconstructed the complete flag."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop]\r\n\u2514\u2500$ python script.py  \r\n{1t_w4s\r\n}\r\n4b57909\r\n_34sy_t\r\nnt_th4t\r\nbh_4r_d\r\npicoCTF\n"})}),"\n",(0,s.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"picoCTF{1t_w4snt_th4t_34sy_tbh_4r_d4b57909}"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>i});var r=t(6540);const s={},o=r.createContext(s);function a(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:n},e.children)}},9583:(e,n,t)=>{t.d(n,{A:()=>r});const r=t.p+"assets/images/packet1-2dab9276e56d6acf4e3ba0cf3be9d3a6.png"}}]);