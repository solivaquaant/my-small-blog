"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[9547],{8614:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/burp-c4a44b5614e13458c0629e2bf7c54f93.png"},11030:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"hack-the-box/challenges/flag-command/flag-command","title":"Flag Command","description":"- Description: Embark on the \\"Dimensional Escape Quest\\" where you wake up in a mysterious forest maze that\'s not quite of this world.","source":"@site/docs/hack-the-box/challenges/flag-command/flag-command.mdx","sourceDirName":"hack-the-box/challenges/flag-command","slug":"/hack-the-box/challenges/flag-command/","permalink":"/my-small-blog/docs/hack-the-box/challenges/flag-command/","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Web","permalink":"/my-small-blog/docs/tags/web","description":"Includes write-ups on the topic of Web"}],"version":"current","frontMatter":{"tags":["web"]},"sidebar":"writeupsSidebar","previous":{"title":"Challenges","permalink":"/my-small-blog/docs/category/challenges-1"},"next":{"title":"ReactOOPS","permalink":"/my-small-blog/docs/hack-the-box/challenges/reactoops/"}}');var r=s(74848),i=s(28453);const a={tags:["web"]},o="Flag Command",l={},c=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"flag-command",children:"Flag Command"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),' Embark on the "Dimensional Escape Quest" where you wake up in a mysterious forest maze that\'s not quite of this world.\r\nNavigate singing squirrels, mischievous nymphs, and grumpy wizards in a whimsical labyrinth that may lead to otherworldly surprises.\r\nWill you conquer the enchanted maze or find yourself lost in a different dimension of magical challenges?\r\nThe journey unfolds in this mystical escape!']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Difficulty:"})," Very easy"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,r.jsxs)(n.p,{children:["When accessing the website, the interface appears as follows, prompting us to enter ",(0,r.jsx)(n.strong,{children:"START"})," to begin the game."]}),"\n",(0,r.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,r.jsx)("img",{src:s(38203).A,style:{width:"100%",height:"auto"}})}),"\n",(0,r.jsxs)(n.p,{children:["The game presents four options, requiring a selection.\r\nAfter choosing an option, the game continues, prompting for further selections, ultimately leading to a ",(0,r.jsx)(n.strong,{children:"GAME OVER"})," screen."]}),"\n",(0,r.jsx)("div",{style:{width:"60%",margin:"0 auto"},children:(0,r.jsx)("img",{src:s(18361).A,style:{width:"100%",height:"auto"}})}),"\n",(0,r.jsxs)(n.p,{children:["Inspecting the page source allows access to JavaScript files like ",(0,r.jsx)(n.code,{children:"commands.js"})," and ",(0,r.jsx)(n.code,{children:"game.js"}),", with the most critical being ",(0,r.jsx)(n.code,{children:"main.js"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Inside ",(0,r.jsx)(n.code,{children:"main.js"}),", a condition checks if the player's input is a valid command (within either ",(0,r.jsx)(n.code,{children:"availableOptions[currentStep]"})," or ",(0,r.jsx)(n.code,{children:"availableOptions['secret']"}),").\r\nThe ",(0,r.jsx)(n.code,{children:"availableOptions[currentStep]"})," refers to options for each game step.\r\nThe question is: what is ",(0,r.jsx)(n.code,{children:"availableOptions['secret']"}),"?"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-js",children:"if (availableOptions[currentStep].includes(currentCommand) || availableOptions['secret'].includes(currentCommand)) {\r\n        await fetch('/api/monitor', {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify({ 'command': currentCommand })\r\n        })\r\n            .then((res) => res.json())\r\n            .then(async (data) => {\r\n                console.log(data)\r\n                await displayLineInTerminal({ text: data.message });\r\n\r\n                if(data.message.includes('Game over')) {\r\n                    playerLost();\r\n                    fetchingResponse = false;\r\n                    return;\r\n                }\r\n                //highlight-start\r\n                if(data.message.includes('HTB{')) {\r\n                    playerWon();\r\n                    fetchingResponse = false;\r\n\r\n                    return;\r\n                }\r\n                //highlight-end\r\n                if (currentCommand == 'HEAD NORTH') {\r\n                    currentStep = '2';\r\n                }\r\n                else if (currentCommand == 'FOLLOW A MYSTERIOUS PATH') {\r\n                    currentStep = '3'\r\n                }\r\n                else if (currentCommand == 'SET UP CAMP') {\r\n                    currentStep = '4'\r\n                }\r\n\r\n                let lineBreak = document.createElement(\"br\");\r\n\r\n\r\n                beforeDiv.parentNode.insertBefore(lineBreak, beforeDiv);\r\n                displayLineInTerminal({ text: '<span class=\"command\">You have 4 options!</span>' })\r\n                displayLinesInTerminal({ lines: availableOptions[currentStep] })\r\n                fetchingResponse = false;\r\n            });\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Reviewing the network requests in Burp Suite reveals a request to ",(0,r.jsx)(n.code,{children:"/api/options"})," that contains command lists, including a ",(0,r.jsx)(n.code,{children:"secret"})," section."]}),"\n",(0,r.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,r.jsx)("img",{src:s(8614).A,style:{width:"100%",height:"auto"}})}),"\n",(0,r.jsxs)(n.p,{children:["Entering the secret command ",(0,r.jsx)(n.strong,{children:"Blip-blop, in a pickle with a hiccup! Shmiggity-shmack"})," into the game yields the flag."]}),"\n",(0,r.jsx)("div",{style:{width:"100%",margin:"0 auto"},children:(0,r.jsx)("img",{src:s(33833).A,style:{width:"100%",height:"auto"}})}),"\n",(0,r.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.code,{children:"HTB{D3v3l0p3r_t00l5_4r3_b35t__t0015_wh4t_d0_y0u_Th1nk??}"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},18361:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/game-2805306621ea2079e354c8a297927630.png"},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var t=s(96540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}},33833:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/flag-dee859a18086d4a110ec99e11384b657.png"},38203:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/dash-62169b8c7ab62e1862515e90c0ddfcf0.png"}}]);