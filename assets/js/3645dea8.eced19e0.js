"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[6735],{4101:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"pico-ctf/forensics/trivial-flag-transfer-protocol","title":"Trivial Flag Transfer Protocol","description":"- Description: Figure out how they moved the flag.","source":"@site/docs/pico-ctf/forensics/trivial-flag-transfer-protocol.mdx","sourceDirName":"pico-ctf/forensics","slug":"/pico-ctf/forensics/trivial-flag-transfer-protocol","permalink":"/my-small-blog/docs/pico-ctf/forensics/trivial-flag-transfer-protocol","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Network","permalink":"/my-small-blog/docs/tags/network","description":"Network tag description"},{"inline":false,"label":"Steganography","permalink":"/my-small-blog/docs/tags/steganography","description":"Steganography tag description"}],"version":"current","frontMatter":{"tags":["network","steganography"]},"sidebar":"tutorialSidebar","previous":{"title":"Secret of the Polyglot","permalink":"/my-small-blog/docs/pico-ctf/forensics/secret-of-the-polyglot/"},"next":{"title":"Verify","permalink":"/my-small-blog/docs/pico-ctf/forensics/verify"}}');var s=r(4848),i=r(8453);const o={tags:["network","steganography"]},a="Trivial Flag Transfer Protocol",l={},c=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"trivial-flag-transfer-protocol",children:"Trivial Flag Transfer Protocol"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Description:"})," Figure out how they moved the flag."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,s.jsxs)(n.p,{children:["After opening the pcap file in Wireshark, numerous packets using the TFTP protocol - a UDP-based file transfer protocol typically used in LAN environments-were observed.\r\nTo examine the transferred files, I navigated to ",(0,s.jsx)(n.strong,{children:"File \u2192 Export Objects \u2192 TFTP"})," and selected ",(0,s.jsx)(n.strong,{children:"Save All"})," to download all associated files."]}),"\n",(0,s.jsxs)(n.p,{children:["One of the exported files, ",(0,s.jsx)(n.code,{children:"instructions.txt"}),", contained a string that appeared encoded. Using ",(0,s.jsx)(n.a,{href:"https://www.dcode.fr/cipher-identifier",children:"this tool"}),", I identified the encoding as ",(0,s.jsx)(n.strong,{children:"ROT-13"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GSGCQBRFAGRAPELCGBHEGENSSVPFBJRZHFGQVFTHVFRBHESYNTGENAFSRE.SVTHERBHGNJNLGBUVQRGURSYNTNAQVJVYYPURPXONPXSBEGURCYNA\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Decoding it via ",(0,s.jsx)(n.a,{href:"https://www.dcode.fr/rot-13-cipher",children:"this"})," yielded the following message:"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:'"TFTP doesn\'t encrypt our traffic so we must disguise our flag transfer. Figure out a way to hide the flag and I will check back for the plan."'}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Another file, ",(0,s.jsx)(n.code,{children:"plan"}),", also contained a ROT-13 encoded message."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"VHFRQGURCEBTENZNAQUVQVGJVGU-QHRQVYVTRAPR.PURPXBHGGURCUBGBF\n"})}),"\n",(0,s.jsx)(n.p,{children:"Decoding it revealed:"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:'"I used the program and hid it with - duediligence. Check out the photos."'}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Besides ",(0,s.jsx)(n.code,{children:"instructions.txt"})," and ",(0,s.jsx)(n.code,{children:"plan"}),", the TFTP dump included 3 BMP image files and one ",(0,s.jsx)(n.code,{children:".deb"})," file.\r\nBased on the hint, the ",(0,s.jsx)(n.code,{children:".deb"})," file appeared to contain the tool used to hide the data."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop]\r\n\u2514\u2500$ file program.deb\r\nprogram.deb: Debian binary package (format 2.0), with control.tar.gz , data compression xz\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Extracting the ",(0,s.jsx)(n.code,{children:".deb"})," file produced ",(0,s.jsx)(n.code,{children:"control.tar.gz"})," and ",(0,s.jsx)(n.code,{children:"data.tar.xz"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop]\r\n\u2514\u2500$ ar x program.deb \n"})}),"\n",(0,s.jsxs)(n.p,{children:["From ",(0,s.jsx)(n.code,{children:"control.tar.gz"}),", I extracted ",(0,s.jsx)(n.code,{children:"md5sum"})," and ",(0,s.jsx)(n.code,{children:"control"}),", both of which mentioned ",(0,s.jsx)(n.strong,{children:"steghide"}),", a tool for hiding and extracting data from images."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop]\r\n\u2514\u2500$ tar -xvf control.tar.gz \r\n./\r\n./md5sums\r\n./control\r\n\r\n\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop]\r\n\u2514\u2500$ cat md5sums \r\n71bdab1263ab4b8d28f34afa5f0ab121  usr/bin/steghide\r\n11db80c2a5dbb9c6107853b08aeacc49  usr/share/doc/steghide/ABOUT-NLS.gz\r\n...\r\n                                                                                                                      \r\n\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop]\r\n\u2514\u2500$ tar -xvf data.tar.xz   \r\n./\r\n./usr/\r\n./usr/share/\r\n./usr/share/doc/\r\n./usr/share/doc/steghide/\r\n./usr/share/doc/steghide/ABOUT-NLS.gz\r\n...\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Similarly, ",(0,s.jsx)(n.code,{children:"data.tar.xz"})," also included references to steghide, reinforcing this clue."]}),"\n",(0,s.jsxs)(n.p,{children:["To retrieve the hidden data, I used ",(0,s.jsx)(n.strong,{children:"steghide"}),".\r\nAccording to the decoded plan message, the passphrase was likely ",(0,s.jsx)(n.strong,{children:"duediligence"}),".\r\n",(0,s.jsx)(n.code,{children:"picture1.bmp"})," and ",(0,s.jsx)(n.code,{children:"picture2.bmp"})," yielded no results."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop]\r\n\u2514\u2500$ steghide extract -sf picture1.bmp -p DUEDILIGENCE\r\nsteghide: could not extract any data with that passphrase!\r\n                                                                                                                      \r\n\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop]\r\n\u2514\u2500$ steghide extract -sf picture2.bmp -p DUEDILIGENCE\r\nsteghide: could not extract any data with that passphrase!\n"})}),"\n",(0,s.jsxs)(n.p,{children:["However, ",(0,s.jsx)(n.code,{children:"picture3.bmp"})," successfully revealed a hidden file: ",(0,s.jsx)(n.strong,{children:"flag.txt"}),", which contained the challenge flag."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop]\r\n\u2514\u2500$ steghide extract -sf picture3.bmp -p DUEDILIGENCE\r\nwrote extracted data to "flag.txt".\r\n                                                                                                                      \r\n\u250c\u2500\u2500(kali\u327fkali)-[~/Desktop]\r\n\u2514\u2500$ cat flag.txt \r\npicoCTF{h1dd3n_1n_pLa1n_51GHT_18375919}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.code,{children:"picoCTF{h1dd3n_1n_pLa1n_51GHT_18375919}"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var t=r(6540);const s={},i=t.createContext(s);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);