"use strict";(self.webpackChunkmy_own_blog=self.webpackChunkmy_own_blog||[]).push([[431],{3878:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>u,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"pico-ctf/general-skills/useless","title":"useless","description":"- Description: There\'s an interesting script in the user\'s home directory","source":"@site/docs/pico-ctf/general-skills/useless.mdx","sourceDirName":"pico-ctf/general-skills","slug":"/pico-ctf/general-skills/useless","permalink":"/my-small-blog/docs/pico-ctf/general-skills/useless","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"tags":[]},"sidebar":"tutorialSidebar","previous":{"title":"Time Machine","permalink":"/my-small-blog/docs/pico-ctf/general-skills/time-machine"},"next":{"title":"Warmed Up","permalink":"/my-small-blog/docs/pico-ctf/general-skills/warmed-up"}}');var i=s(4848),t=s(8453);const l={tags:[]},o="useless",a={},c=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"useless",children:"useless"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," There's an interesting script in the user's home directory"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Difficulty:"})," Medium"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,i.jsxs)(n.p,{children:["After gaining SSH access to the target machine, we noticed a file named ",(0,i.jsx)(n.code,{children:"useless"})," located in the user's directory."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"useless: Bourne-Again shell script, ASCII text executable\n"})}),"\n",(0,i.jsx)(n.p,{children:"Viewing the file's content, we found that it was a simple Bash script designed to perform basic arithmetic operations -\r\naddition, subtraction, multiplication, and division - based on command-line arguments."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'picoplayer@challenge:~$ cat useless \r\n#!/bin/bash\r\n# Basic mathematical operations via command-line arguments\r\n\r\nif [ $# != 3 ]\r\nthen\r\n  echo "Read the code first"\r\nelse\r\n        if [[ "$1" == "add" ]]\r\n        then \r\n          sum=$(( $2 + $3 ))\r\n          echo "The Sum is: $sum"  \r\n\r\n        elif [[ "$1" == "sub" ]]\r\n        then \r\n          sub=$(( $2 - $3 ))\r\n          echo "The Substract is: $sub" \r\n\r\n        elif [[ "$1" == "div" ]]\r\n        then \r\n          div=$(( $2 / $3 ))\r\n          echo "The quotient is: $div" \r\n\r\n        elif [[ "$1" == "mul" ]]\r\n        then\r\n          mul=$(( $2 * $3 ))\r\n          echo "The product is: $mul" \r\n\r\n        else\r\n          echo "Read the manual"\r\n         \r\n        fi\r\nfi\n'})}),"\n",(0,i.jsx)(n.p,{children:"Running the script with appropriate parameters yields the expected results of the corresponding arithmetic operation. For instance:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"picoplayer@challenge:~$ bash useless add 2 3\r\nThe Sum is: 5\r\npicoplayer@challenge:~$ bash useless mul 2 4\r\nThe product is: 8\n"})}),"\n",(0,i.jsxs)(n.p,{children:["At first glance, the script appears straightforward, with no obvious vulnerabilities or backdoors.\r\nHowever, upon closer inspection, we noticed that when the script is executed without exactly 3 arguments or with an unsupported operation,\r\nit returns a curious message: ",(0,i.jsx)(n.strong,{children:'"Read the manual"'}),".\r\nThis is a subtle but interesting hint.\r\nIn Unix-like systems, the ",(0,i.jsx)(n.code,{children:"man"})," (manual) command is commonly used to display documentation about commands, including usage, options, and examples.\r\nDevelopers often include a manual page for custom tools or scripts, especially if they want to hide information in plain sight."]}),"\n",(0,i.jsxs)(n.p,{children:["So, following the clue, we tried ",(0,i.jsx)(n.code,{children:"man useless"}),", and that's when we found the flag cleverly hidden in the manual page."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"picoplayer@challenge:~$ man useless \r\n\r\nuseless\r\n     useless, \u2014 This is a simple calculator script\r\n\r\nSYNOPSIS\r\n     useless, [add sub mul div] number1 number2\r\n\r\nDESCRIPTION\r\n     Use the useless, macro to make simple calulations like addition,subtraction, multiplication and division.\r\n\r\nExamples\r\n     ./useless add 1 2\r\n       This will add 1 and 2 and return 3\r\n\r\n     ./useless mul 2 3\r\n       This will return 6 as a product of 2 and 3\r\n\r\n     ./useless div 6 3\r\n       This will return 2 as a quotient of 6 and 3\r\n\r\n     ./useless sub 6 5\r\n       This will return 1 as a remainder of substraction of 5 from 6\r\n\r\nAuthors\r\n     This script was designed and developed by Cylab Africa\r\n\r\n     picoCTF{us3l3ss_ch4ll3ng3_3xpl0it3d_6140}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"picoCTF{us3l3ss_ch4ll3ng3_3xpl0it3d_6140}"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var r=s(6540);const i={},t=r.createContext(i);function l(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);