"use strict";(globalThis.webpackChunkmy_own_blog=globalThis.webpackChunkmy_own_blog||[]).push([[163],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>r});var i=s(96540);const t={},a=i.createContext(t);function o(e){const n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(a.Provider,{value:n},e.children)}},96141:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"hack-my-vm/hvmlabs/chapter-1/mission-0x29","title":"Mission 0x29","description":"\ud83d\udd0e Solution","source":"@site/docs/hack-my-vm/hvmlabs/chapter-1/mission-0x29.mdx","sourceDirName":"hack-my-vm/hvmlabs/chapter-1","slug":"/hack-my-vm/hvmlabs/chapter-1/mission-0x29","permalink":"/docs/hack-my-vm/hvmlabs/chapter-1/mission-0x29","draft":false,"unlisted":false,"tags":[{"inline":false,"label":"Linux","permalink":"/docs/tags/linux","description":"Includes write-ups on the topic of Linux"}],"version":"current","frontMatter":{"tags":["linux"]},"sidebar":"writeupsSidebar","previous":{"title":"Mission 0x28","permalink":"/docs/hack-my-vm/hvmlabs/chapter-1/mission-0x28"},"next":{"title":"Mission 0x30","permalink":"/docs/hack-my-vm/hvmlabs/chapter-1/mission-0x30"}}');var t=s(74848),a=s(28453);const o={tags:["linux"]},r="Mission 0x29",l={},c=[{value:"\ud83d\udd0e Solution",id:"-solution",level:2},{value:"\ud83d\udea9Flag",id:"flag",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"mission-0x29",children:"Mission 0x29"})}),"\n",(0,t.jsx)(n.h2,{id:"-solution",children:"\ud83d\udd0e Solution"}),"\n",(0,t.jsxs)(n.p,{children:["After connecting via SSH as ",(0,t.jsx)(n.em,{children:"celeste"}),", the next hint points toward MySQL interaction."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"celeste@venus:~$ cat mission.txt \n################\n# MISSION 0x29 #\n################\n\n## EN ##\nThe user celeste has access to mysql but for what?\n"})}),"\n",(0,t.jsx)(n.p,{children:"Based on this hint, the current user should be able to authenticate into MySQL.\nUsing the same username and password works:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"mysql -uceleste -pVLSNMTKwSV2o8Tn\n"})}),"\n",(0,t.jsx)(n.p,{children:"Once inside, listing the available databases reveals two:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"MariaDB [(none)]> show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| venus              |\n+--------------------+\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Since ",(0,t.jsx)(n.code,{children:"information_schema"})," is the system database, the focus shifts to the ",(0,t.jsx)(n.code,{children:"venus"})," database:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"MariaDB [(none)]> use venus;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Inside this database, there is a single table named ",(0,t.jsx)(n.code,{children:"people"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"MariaDB [venus]> show tables;\n+-----------------+\n| Tables_in_venus |\n+-----------------+\n| people          |\n+-----------------+\n"})}),"\n",(0,t.jsx)(n.p,{children:"Querying the table reveals the flag in row number 35:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"+-----------+---------------+--------------------------------+\n| id_people | uzer          | pazz                           |\n+-----------+---------------+--------------------------------+\n|        35 | haha          | 8===xKmPDsJSKpHLzkqKXyjx===D~~ |\n+-----------+---------------+--------------------------------+\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Unlike previous challenges, this mission doesn't mention any next target user in the ",(0,t.jsx)(n.code,{children:"mission.txt"}),", which strongly suggests that the next passwords may also be hidden somewhere inside the database."]}),"\n",(0,t.jsx)(n.p,{children:"Looking back at patterns from previous stages, all valid passwords discovered so far were exactly 15 characters long.\nWith that assumption, a filtered SQL query returns possible credentials for upcoming tasks:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"MariaDB [venus]> SELECT * FROM people WHERE length(pazz) = 15;\n+-----------+----------+-----------------+\n| id_people | uzer     | pazz            |\n+-----------+----------+-----------------+\n|        16 | sfdfdsml | ixpeqdsfsdfdsfW |\n|        44 | yuio     | ixpgbvcbvcbeqdW |\n|        54 | crom     | ixpefdbvvcbrqdW |\n|        58 | bael     | ixpesdvsdvsdqdW |\n|        74 | nina     | ixpeqdWuvC5N9kG |\n|        77 | dsar     | ixpeF43F3F34qdW |\n|        78 | yop      | ixpeqdWCSDFDSFD |\n|        79 | loco     | ixpeF43F34F3qdW |\n+-----------+----------+-----------------+\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Testing these entries showed that most of them didn't exist on the system - except for one: ",(0,t.jsx)(n.strong,{children:"nina"}),".\nSo the next credential pair is clear:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"User: nina"}),"\n",(0,t.jsx)(n.li,{children:"Password: ixpeqdWuvC5N9kG\nMission 0x30 continues with nina."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"flag",children:"\ud83d\udea9Flag"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.code,{children:"8===xKmPDsJSKpHLzkqKXyjx===D~~"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);